<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon Jan 31 16:15:42 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>OPENSSL(1) BSD General Commands Manual OPENSSL(1)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>openssl</b> &mdash; OpenSSL
command line tool</p>

<p style="margin-top: 1em"><b>SYNOPSIS</b></p>

<p style="margin-left:17%;"><b>openssl</b> <i>command</i>
[<i>command_opts</i>] [<i>command_args</i>]</p>

<p style="margin-left:17%; margin-top: 1em"><b>openssl
list-standard-commands</b> |
<b>list-message-digest-commands</b> |
<b>list-cipher-commands</b> | <b>list-cipher-algorithms</b>
| <b>list-message-digest-algorithms</b> |
<b>list-public-key-algorithms</b></p>

<p style="margin-left:17%; margin-top: 1em"><b>openssl
no-</b><i>command</i></p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;"><b>OpenSSL</b> is a cryptography
toolkit implementing the Transport Layer Security (TLS v1)
network protocol, as well as related cryptography
standards.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>openssl</b> program is a command line tool for using the
various cryptography functions of <b>openssl</b>&rsquo;s
crypto library from the shell.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-commands <b>list-standard-commands</b>,
<b>list-message-digest-commands</b>, and
<b>list-cipher-commands</b> output a list (one entry per
line) of the names of all standard commands, message digest
commands, or cipher commands, respectively, that are
available in the present <b>openssl</b> utility.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-commands <b>list-cipher-algorithms</b> and
<b>list-message-digest-algorithms</b> list all cipher and
message digest names, one entry per line. Aliases are listed
as:</p>

<p style="margin-left:14%; margin-top: 1em">from =&gt;
to</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-command <b>list-public-key-algorithms</b> lists all
supported public key algorithms.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-command <b>no-</b><i>command</i> tests whether a
command of the specified name is available. If
<i>command</i> does not exist, it returns 0 and prints
<b>no-</b><i>command</i>; otherwise it returns 1 and prints
<i>command</i>. In both cases, the output goes to stdout and
nothing is printed to stderr. Additional command line
arguments are always ignored. Since for each cipher there is
a command of the same name, this provides an easy way for
shell scripts to test for the availability of ciphers in the
<b>openssl</b> program.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>:
<b>no-</b><i>command</i> is not able to detect
pseudo-commands such as <b>quit</b>,
<b>list-</b><i>...</i><b>-commands</b>, or
<b>no-</b><i>command</i> itself.</p>

<p style="margin-top: 1em"><b>ASN1PARSE</b></p>

<p style="margin-left:6%;"><b>openssl asn1parse</b>
[<b>-i</b>] [<b>-dlimit</b> <i>number</i>] [<b>-dump</b>]
[<b>-genconf</b> <i>file</i>] [<b>-genstr</b> <i>str</i>]
[<b>-in</b> <i>file</i>] [<b>-inform der</b> | <b>pem</b> |
<b>txt</b>] [<b>-length</b> <i>number</i>] [<b>-noout</b>]
[<b>-offset</b> <i>number</i>] [<b>-oid</b> <i>file</i>]
[<b>-out</b> <i>file</i>] [<b>-strparse</b>
<i>offset</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>asn1parse</b> command is a diagnostic utility that can
parse ASN.1 structures. It can also be used to extract data
from ASN.1 formatted data.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-dlimit</b> <i>number</i></p>

<p style="margin-left:17%;">Dump the first <i>number</i>
bytes of unknown data in hex form.</p>

<p style="margin-top: 1em"><b>-dump</b></p>

<p style="margin-left:17%; margin-top: 1em">Dump unknown
data in hex form.</p>

<p style="margin-top: 1em"><b>-genconf</b> <i>file</i>,
<b>-genstr</b> <i>str</i></p>

<p style="margin-left:17%;">Generate encoded data based on
string <i>str</i>, file <i>file</i>, or both, using the
format described in ASN1_generate_nconf(3). If only
<i>file</i> is present then the string is obtained from the
default section using the name &ldquo;asn1&rdquo;. The
encoded data is passed through the ASN.1 parser and printed
out as though it came from a file; the contents can thus be
examined and written to a file using the <b>-out</b>
option.</p>

<p style="margin-top: 1em"><b>-i</b></p>

<p style="margin-left:17%; margin-top: 1em">Indent the
output according to the &quot;depth&quot; of the
structures.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> | <b>pem</b>
| <b>txt</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-length</b> <i>number</i></p>

<p style="margin-left:17%;">Number of bytes to parse; the
default is until end of file.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the parsed version of the input file.</p>

<p style="margin-top: 1em"><b>-offset</b> <i>number</i></p>

<p style="margin-left:17%;">Starting offset to begin
parsing; the default is start of file.</p>

<p style="margin-top: 1em"><b>-oid</b> <i>file</i></p>

<p style="margin-left:17%;">A file containing additional
object identifiers (OIDs). If an OID (object identifier) is
not part of <b>openssl</b>&rsquo;s internal table it will be
represented in numerical form (for example 1.2.3.4).</p>

<p style="margin-left:17%; margin-top: 1em">Each line
consists of three columns: the first column is the OID in
numerical format and should be followed by whitespace. The
second column is the &quot;short name&quot;, which is a
single word followed by whitespace. The final column is the
rest of the line and is the &quot;long name&quot;.
<b>asn1parse</b> displays the long name.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The DER-encoded output file;
the default is no encoded output (useful when combined with
<b>-strparse</b>).</p>

<p style="margin-top: 1em"><b>-strparse</b>
<i>offset</i></p>

<p style="margin-left:17%;">Parse the content octets of the
ASN.1 object starting at <i>offset</i>. This option can be
used multiple times to &quot;drill down&quot; into a nested
structure.</p>

<p style="margin-top: 1em"><b>CA</b></p>

<p style="margin-left:6%;"><b>openssl ca</b>
[<b>-batch</b>] [<b>-cert</b> <i>file</i>] [<b>-config</b>
<i>file</i>] [<b>-create_serial</b>]
[<b>-crl_CA_compromise</b> <i>time</i>]
[<b>-crl_compromise</b> <i>time</i>] [<b>-crl_hold</b>
<i>instruction</i>] [<b>-crl_reason</b> <i>reason</i>]
[<b>-crldays</b> <i>days</i>] [<b>-crlexts</b>
<i>section</i>] [<b>-crlhours</b> <i>hours</i>]
[<b>-days</b> <i>arg</i>] [<b>-enddate</b> <i>date</i>]
[<b>-extensions</b> <i>section</i>] [<b>-extfile</b>
<i>section</i>] [<b>-gencrl</b>] [<b>-in</b> <i>file</i>]
[<b>-infiles</b>] [<b>-key</b> <i>password</i>]
[<b>-keyfile</b> <i>arg</i>] [<b>-keyform pem</b> |
<b>der</b>] [<b>-md</b> <i>arg</i>] [<b>-msie_hack</b>]
[<b>-multivalue-rdn</b>] [<b>-name</b> <i>section</i>]
[<b>-noemailDN</b>] [<b>-notext</b>] [<b>-out</b>
<i>file</i>] [<b>-outdir</b> <i>dir</i>] [<b>-passin</b>
<i>arg</i>] [<b>-policy</b> <i>arg</i>] [<b>-preserveDN</b>]
[<b>-revoke</b> <i>file</i>] [<b>-selfsign</b>]
[<b>-spkac</b> <i>file</i>] [<b>-ss_cert</b> <i>file</i>]
[<b>-startdate</b> <i>date</i>] [<b>-status</b>
<i>serial</i>] [<b>-subj</b> <i>arg</i>] [<b>-updatedb</b>]
[<b>-utf8</b>] [<b>-verbose</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ca</b>
command is a minimal certificate authority (CA) application.
It can be used to sign certificate requests in a variety of
forms and generate certificate revocation lists (CRLs). It
also maintains a text database of issued certificates and
their status.</p>

<p style="margin-left:6%; margin-top: 1em">The options
relevant to CAs are as follows:</p>

<p style="margin-top: 1em"><b>-batch</b></p>

<p style="margin-left:14%;">Batch mode. In this mode no
questions will be asked and all certificates will be
certified automatically.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:14%;">The CA certificate file.</p>

<p style="margin-top: 1em"><b>-config</b> <i>file</i></p>

<p style="margin-left:14%;">Specify an alternative
configuration file.</p>

<p style="margin-top: 1em"><b>-create_serial</b></p>

<p style="margin-left:14%;">If reading the serial from the
text file as specified in the configuration fails, create a
new random serial to be used as the next serial number.</p>

<p style="margin-top: 1em"><b>-days</b> <i>arg</i></p>

<p style="margin-left:14%;">The number of days to certify
the certificate for.</p>

<p style="margin-top: 1em"><b>-enddate</b> <i>date</i></p>

<p style="margin-left:14%;">Set the expiry date. The format
of the date is [YY]YYMMDDHHMMSSZ, with all four year digits
required for dates from 2050 onwards.</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i></p>

<p style="margin-left:14%;">The section of the
configuration file containing certificate extensions to be
added when a certificate is issued (defaults to
<b>x509_extensions</b> unless the <b>-extfile</b> option is
used). If no extension section is present, a V1 certificate
is created. If the extension section is present (even if it
is empty), then a V3 certificate is created. See the
x509v3.cnf(5) manual page for details of the extension
section format.</p>

<p style="margin-top: 1em"><b>-extfile</b> <i>file</i></p>

<p style="margin-left:14%;">An additional configuration
<i>file</i> to read certificate extensions from (using the
default section unless the <b>-extensions</b> option is also
used).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">An input <i>file</i> containing
a single certificate request to be signed by the CA.</p>

<p style="margin-top: 1em"><b>-infiles</b></p>

<p style="margin-left:14%;">If present, this should be the
last option; all subsequent arguments are assumed to be the
names of files containing certificate requests.</p>

<p style="margin-top: 1em"><b>-key</b> <i>password</i></p>

<p style="margin-left:14%;">The <i>password</i> used to
encrypt the private key. Since on some systems the command
line arguments are visible, this option should be used with
caution.</p>

<p style="margin-top: 1em"><b>-keyfile</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to sign
requests with.</p>

<p style="margin-top: 1em"><b>-keyform pem</b> |
<b>der</b></p>

<p style="margin-left:14%;">Private key file format. The
default is <b>pem</b>.</p>

<p style="margin-top: 1em"><b>-md</b> <i>alg</i></p>

<p style="margin-left:14%;">The message digest to use.
Possible values include <i>md5</i> and <i>sha1</i>. This
option also applies to CRLs.</p>

<p style="margin-top: 1em"><b>-msie_hack</b></p>

<p style="margin-left:14%;">This is a legacy option to make
<b>ca</b> work with very old versions of the IE certificate
enrollment control &quot;certenr3&quot;. It used
UniversalStrings for almost everything. Since the old
control has various security bugs, its use is strongly
discouraged. The newer control &quot;Xenroll&quot; does not
need this option.</p>

<p style="margin-top: 1em"><b>-multivalue-rdn</b></p>

<p style="margin-left:14%;">This option causes the
<b>-subj</b> argument to be interpreted with full support
for multivalued RDNs, for example
&quot;/DC=org/DC=OpenSSL/DC=users/UID=123456+CN=John
Doe&quot;. If <b>-multivalue-rdn</b> is not used, the UID
value is set to &quot;123456+CN=John Doe&quot;.</p>

<p style="margin-top: 1em"><b>-name</b> <i>section</i></p>

<p style="margin-left:14%;">Specifies the configuration
file <i>section</i> to use (overrides <b>default_ca</b> in
the <b>ca</b> section).</p>

<p style="margin-top: 1em"><b>-noemailDN</b></p>

<p style="margin-left:14%;">The DN of a certificate can
contain the EMAIL field if present in the request DN,
however it is good policy just having the email set into the
<b>altName</b> extension of the certificate. When this
option is set, the EMAIL field is removed from the
certificate&rsquo;s subject and set only in the, eventually
present, extensions. The <i>email_in_dn</i> keyword can be
used in the configuration file to enable this behaviour.</p>

<p style="margin-top: 1em"><b>-notext</b></p>

<p style="margin-left:14%;">Don&rsquo;t output the text
form of a certificate to the output file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to output
certificates to. The default is standard output. The
certificate details will also be printed out to this file in
PEM format, except that <b>-spkac</b> outputs DER
format.</p>

<p style="margin-top: 1em"><b>-outdir</b>
<i>directory</i></p>

<p style="margin-left:14%;">The <i>directory</i> to output
certificates to. The certificate will be written to a file
consisting of the serial number in hex with &quot;.pem&quot;
appended.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-policy</b> <i>arg</i></p>

<p style="margin-left:14%;">Define the CA
&quot;policy&quot; to use. The policy section in the
configuration file consists of a set of variables
corresponding to certificate DN fields. The values may be
one of &quot;match&quot; (the value must match the same
field in the CA certificate), &quot;supplied&quot; (the
value must be present), or &quot;optional&quot; (the value
may be present). Any fields not mentioned in the policy
section are silently deleted, unless the <b>-preserveDN</b>
option is set, but this can be regarded more of a quirk than
intended behaviour.</p>

<p style="margin-top: 1em"><b>-preserveDN</b></p>

<p style="margin-left:14%;">Normally, the DN order of a
certificate is the same as the order of the fields in the
relevant policy section. When this option is set, the order
is the same as the request. This is largely for
compatibility with the older IE enrollment control which
would only accept certificates if their DNs matched the
order of the request. This is not needed for Xenroll.</p>

<p style="margin-top: 1em"><b>-selfsign</b></p>

<p style="margin-left:14%;">Indicates the issued
certificates are to be signed with the key the certificate
requests were signed with, given with <b>-keyfile</b>.
Certificate requests signed with a different key are
ignored. If <b>-gencrl</b>, <b>-spkac</b>, or
<b>-ss_cert</b> are given, <b>-selfsign</b> is ignored.</p>

<p style="margin-left:14%; margin-top: 1em">A consequence
of using <b>-selfsign</b> is that the self-signed
certificate appears among the entries in the certificate
database (see the configuration option <b>database</b>) and
uses the same serial number counter as all other
certificates signed with the self-signed certificate.</p>

<p style="margin-top: 1em"><b>-spkac</b> <i>file</i></p>

<p style="margin-left:14%;">A file containing a single
Netscape signed public key and challenge, and additional
field values to be signed by the CA. This will usually come
from the KEYGEN tag in an HTML form to create a new private
key. It is, however, possible to create SPKACs using the
<b>spkac</b> utility.</p>

<p style="margin-left:14%; margin-top: 1em">The file should
contain the variable SPKAC set to the value of the SPKAC and
also the required DN components as name value pairs. If
it&rsquo;s necessary to include the same component twice,
then it can be preceded by a number and a
&rsquo;.&rsquo;.</p>

<p style="margin-top: 1em"><b>-ss_cert</b> <i>file</i></p>

<p style="margin-left:14%;">A single self-signed
certificate to be signed by the CA.</p>

<p style="margin-top: 1em"><b>-startdate</b>
<i>date</i></p>

<p style="margin-left:14%;">Set the start date. The format
of the date is [YY]YYMMDDHHMMSSZ, with all four year digits
required for dates from 2050 onwards.</p>

<p style="margin-top: 1em"><b>-subj</b> <i>arg</i></p>

<p style="margin-left:14%;">Supersedes the subject name
given in the request. The <i>arg</i> must be formatted as
/<i>type0</i>=<i>value0</i>/<i>type1</i>=<i>value1</i>/<i>type2</i>=<i>...</i>;
characters may be escaped by &rsquo;\&rsquo; (backslash), no
spaces are skipped.</p>

<p style="margin-top: 1em"><b>-utf8</b></p>

<p style="margin-left:14%;">Interpret field values read
from a terminal or obtained from a configuration file as
UTF-8 strings. By default, they are interpreted as
ASCII.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:14%;">Print extra details about the
operations being performed.</p>

<p style="margin-left:6%; margin-top: 1em">The options
relevant to CRLs are as follows:</p>

<p style="margin-top: 1em"><b>-crl_CA_compromise</b>
<i>time</i></p>

<p style="margin-left:14%;">This is the same as
<b>-crl_compromise</b>, except the revocation reason is set
to CACompromise.</p>

<p style="margin-top: 1em"><b>-crl_compromise</b>
<i>time</i></p>

<p style="margin-left:14%;">Set the revocation reason to
keyCompromise and the compromise time to <i>time</i>.
<i>time</i> should be in GeneralizedTime format, i.e.
YYYYMMDDHHMMSSZ.</p>

<p style="margin-top: 1em"><b>-crl_hold</b>
<i>instruction</i></p>

<p style="margin-left:14%;">Set the CRL revocation reason
code to certificateHold and the hold instruction to
<i>instruction</i> which must be an OID. Although any OID
can be used, only holdInstructionNone (the use of which is
discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.</p>

<p style="margin-top: 1em"><b>-crl_reason</b>
<i>reason</i></p>

<p style="margin-left:14%;">Revocation reason, where
<i>reason</i> is one of: unspecified, keyCompromise,
CACompromise, affiliationChanged, superseded,
cessationOfOperation, certificateHold or removeFromCRL. The
matching of <i>reason</i> is case insensitive. Setting any
revocation reason will make the CRL v2. In practice,
removeFromCRL is not particularly useful because it is only
used in delta CRLs which are not currently implemented.</p>

<p style="margin-top: 1em"><b>-crldays</b> <i>num</i></p>

<p style="margin-left:14%;">The number of days before the
next CRL is due. This is the days from now to place in the
CRL <b>nextUpdate</b> field.</p>

<p style="margin-top: 1em"><b>-crlexts</b>
<i>section</i></p>

<p style="margin-left:14%;">The <i>section</i> of the
configuration file containing CRL extensions to include. If
no CRL extension section is present then a V1 CRL is
created; if the CRL extension section is present (even if it
is empty) then a V2 CRL is created. The CRL extensions
specified are CRL extensions and not CRL entry extensions.
It should be noted that some software can&rsquo;t handle V2
CRLs. See the x509v3.cnf(5) manual page for details of the
extension section format.</p>

<p style="margin-top: 1em"><b>-crlhours</b> <i>num</i></p>

<p style="margin-left:14%;">The number of hours before the
next CRL is due.</p>

<p style="margin-top: 1em"><b>-gencrl</b></p>

<p style="margin-left:14%;">Generate a CRL based on
information in the index file.</p>

<p style="margin-top: 1em"><b>-revoke</b> <i>file</i></p>

<p style="margin-left:14%;">A <i>file</i> containing a
certificate to revoke.</p>

<p style="margin-top: 1em"><b>-status</b> <i>serial</i></p>

<p style="margin-left:14%;">Show the status of the
certificate with serial number <i>serial</i>.</p>

<p style="margin-top: 1em"><b>-updatedb</b></p>

<p style="margin-left:14%;">Update the database index to
purge expired certificates.</p>

<p style="margin-left:6%; margin-top: 1em">Many of the
options can be set in the <b>ca</b> section of the
configuration file (or in the default section of the
configuration file), specified using <b>default_ca</b> or
<b>-name</b>. The options <b>preserve</b> and
<b>msie_hack</b> are read directly from the <b>ca</b>
section.</p>

<p style="margin-left:6%; margin-top: 1em">Many of the
configuration file options are identical to command line
options. Where the option is present in the configuration
file and the command line, the command line value is used.
Where an option is described as mandatory, then it must be
present in the configuration file or the command line
equivalent (if any) used.</p>

<p style="margin-top: 1em"><b>certificate</b></p>

<p style="margin-left:14%;">The same as <b>-cert</b>. It
gives the file containing the CA certificate. Mandatory.</p>

<p style="margin-top: 1em"><b>copy_extensions</b></p>

<p style="margin-left:14%;">Determines how extensions in
certificate requests should be handled. If set to
<b>none</b> or this option is not present, then extensions
are ignored and not copied to the certificate. If set to
<b>copy</b>, then any extensions present in the request that
are not already present are copied to the certificate. If
set to <b>copyall</b>, then all extensions in the request
are copied to the certificate: if the extension is already
present in the certificate it is deleted first.</p>

<p style="margin-left:14%; margin-top: 1em">The
<b>copy_extensions</b> option should be used with caution.
If care is not taken, it can be a security risk. For
example, if a certificate request contains a
<b>basicConstraints</b> extension with CA:TRUE and the
<b>copy_extensions</b> value is set to <b>copyall</b> and
the user does not spot this when the certificate is
displayed, then this will hand the requester a valid CA
certificate.</p>

<p style="margin-left:14%; margin-top: 1em">This situation
can be avoided by setting <b>copy_extensions</b> to
<b>copy</b> and including <b>basicConstraints</b> with
CA:FALSE in the configuration file. Then if the request
contains a <b>basicConstraints</b> extension, it will be
ignored.</p>

<p style="margin-left:14%; margin-top: 1em">The main use of
this option is to allow a certificate request to supply
values for certain extensions such as
<b>subjectAltName</b>.</p>

<p style="margin-top: 1em"><b>crl_extensions</b></p>

<p style="margin-left:14%;">The same as
<b>-crlexts</b>.</p>

<p style="margin-top: 1em"><b>crlnumber</b></p>

<p style="margin-left:14%;">A text file containing the next
CRL number to use in hex. The CRL number will be inserted in
the CRLs only if this file exists. If this file is present,
it must contain a valid CRL number.</p>

<p style="margin-top: 1em"><b>database</b></p>

<p style="margin-left:14%;">The text database file to use.
Mandatory. This file must be present, though initially it
will be empty.</p>

<p style="margin-top: 1em"><b>default_crl_hours</b>,
<b>default_crl_days</b></p>

<p style="margin-left:14%;">The same as the
<b>-crlhours</b> and <b>-crldays</b> options. These will
only be used if neither command line option is present. At
least one of these must be present to generate a CRL.</p>

<p style="margin-top: 1em"><b>default_days</b></p>

<p style="margin-left:14%;">The same as the <b>-days</b>
option. The number of days to certify a certificate for.</p>

<p style="margin-top: 1em"><b>default_enddate</b></p>

<p style="margin-left:14%;">The same as the <b>-enddate</b>
option. Either this option or <b>default_days</b> (or the
command line equivalents) must be present.</p>

<p style="margin-top: 1em"><b>default_md</b></p>

<p style="margin-left:14%;">The same as the <b>-md</b>
option. The message digest to use. Mandatory.</p>

<p style="margin-top: 1em"><b>default_startdate</b></p>

<p style="margin-left:14%;">The same as the
<b>-startdate</b> option. The start date to certify a
certificate for. If not set, the current time is used.</p>

<p style="margin-top: 1em"><b>email_in_dn</b></p>

<p style="margin-left:14%;">The same as <b>-noemailDN</b>.
If the EMAIL field is to be removed from the DN of the
certificate, simply set this to &quot;no&quot;. If not
present, the default is to allow for the EMAIL field in the
certificate&rsquo;s DN.</p>

<p style="margin-top: 1em"><b>msie_hack</b></p>

<p style="margin-left:14%;">The same as
<b>-msie_hack</b>.</p>

<p style="margin-top: 1em"><b>name_opt</b>,
<b>cert_opt</b></p>

<p style="margin-left:14%;">These options allow the format
used to display the certificate details when asking the user
to confirm signing. All the options supported by the
<b>x509</b> utilities&rsquo; <b>-nameopt</b> and
<b>-certopt</b> switches can be used here, except that
<b>no_signame</b> and <b>no_sigdump</b> are permanently set
and cannot be disabled (this is because the certificate
signature cannot be displayed because the certificate has
not been signed at this point).</p>

<p style="margin-left:14%; margin-top: 1em">For
convenience, the value <b>ca_default</b> is accepted by both
to produce a reasonable output.</p>

<p style="margin-left:14%; margin-top: 1em">If neither
option is present, the format used in earlier versions of
<b>openssl</b> is used. Use of the old format is strongly
discouraged because it only displays fields mentioned in the
<b>policy</b> section, mishandles multicharacter string
types and does not display extensions.</p>

<p style="margin-top: 1em"><b>new_certs_dir</b></p>

<p style="margin-left:14%;">The same as the <b>-outdir</b>
command line option. It specifies the directory where new
certificates will be placed. Mandatory.</p>

<p style="margin-top: 1em"><b>oid_file</b></p>

<p style="margin-left:14%;">This specifies a file
containing additional object identifiers. Each line of the
file should consist of the numerical form of the object
identifier followed by whitespace, then the short name
followed by whitespace and finally the long name.</p>

<p style="margin-top: 1em"><b>oid_section</b></p>

<p style="margin-left:14%;">This specifies a section in the
configuration file containing extra object identifiers. Each
line should consist of the short name of the object
identifier followed by &rsquo;=&rsquo; and the numerical
form. The short and long names are the same when this option
is used.</p>

<p style="margin-top: 1em"><b>policy</b></p>

<p style="margin-left:14%;">The same as <b>-policy</b>.
Mandatory.</p>

<p style="margin-top: 1em"><b>preserve</b></p>

<p style="margin-left:14%;">The same as
<b>-preserveDN</b>.</p>

<p style="margin-top: 1em"><b>private_key</b></p>

<p style="margin-left:14%;">Same as the <b>-keyfile</b>
option. The file containing the CA private key.
Mandatory.</p>

<p style="margin-top: 1em"><b>serial</b></p>

<p style="margin-left:14%;">A text file containing the next
serial number to use in hex. Mandatory. This file must be
present and contain a valid serial number.</p>

<p style="margin-top: 1em"><b>unique_subject</b></p>

<p style="margin-left:14%;">If the value <b>yes</b> is
given, the valid certificate entries in the database must
have unique subjects. If the value <b>no</b> is given,
several valid certificate entries may have the exact same
subject. The default value is <b>yes</b>.</p>

<p style="margin-top: 1em"><b>x509_extensions</b></p>

<p style="margin-left:14%;">The same as
<b>-extensions</b>.</p>

<p style="margin-top: 1em"><b>CIPHERS</b></p>

<p style="margin-left:6%;"><b>openssl ciphers</b>
[<b>-hVv</b>] [<i>control</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>ciphers</b> command converts the <i>control</i> string
from the format documented in SSL_CTX_set_cipher_list(3)
into an ordered SSL cipher suite preference list. If no
<i>control</i> string is specified, the <b>DEFAULT</b> list
is printed.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-h</b>, <b>-?</b></p>

<p style="margin-left:17%; margin-top: 1em">Print a brief
usage message.</p>

<p style="margin-top: 1em"><b>-V</b></p>

<p style="margin-left:17%; margin-top: 1em">Verbose. List
ciphers with cipher suite code in hex format, cipher name,
and a complete description of protocol version, key
exchange, authentication, encryption, and mac
algorithms.</p>

<p style="margin-top: 1em"><b>-v</b></p>

<p style="margin-left:17%; margin-top: 1em">Like <b>-V</b>,
but without cipher suite codes.</p>

<p style="margin-top: 1em"><b>CRL</b></p>

<p style="margin-left:6%;"><b>openssl crl</b>
[<b>-CAfile</b> <i>file</i>] [<b>-CApath</b> <i>dir</i>]
[<b>-fingerprint</b>] [<b>-hash</b>] [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-issuer</b>] [<b>-lastupdate</b>] [<b>-nextupdate</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>crl</b>
command processes CRL files in DER or PEM format.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature on a CRL
by looking up the issuing certificate in <i>file</i>.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">Verify the signature on a CRL
by looking up the issuing certificate in <i>dir</i>. This
directory must be a standard certificate directory, i.e. a
hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><b>-fingerprint</b></p>

<p style="margin-left:17%;">Print the CRL fingerprint.</p>

<p style="margin-top: 1em"><b>-hash</b></p>

<p style="margin-left:17%; margin-top: 1em">Output a hash
of the issuer name. This can be used to look up CRLs in a
directory by issuer name.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-issuer</b></p>

<p style="margin-left:17%;">Output the issuer name.</p>

<p style="margin-top: 1em"><b>-lastupdate</b></p>

<p style="margin-left:17%;">Output the <b>lastUpdate</b>
field.</p>

<p style="margin-top: 1em"><b>-nextupdate</b></p>

<p style="margin-left:17%;">Output the <b>nextUpdate</b>
field.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the CRL.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the CRL
in plain text.</p>

<p style="margin-top: 1em"><b>CRL2PKCS7</b></p>

<p style="margin-left:6%;"><b>openssl crl2pkcs7</b>
[<b>-certfile</b> <i>file</i>] [<b>-in</b> <i>file</i>]
[<b>-inform der</b> | <b>pem</b>] [<b>-nocrl</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> |
<b>pem</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>crl2pkcs7</b> command takes an optional CRL and one or
more certificates and converts them into a PKCS#7 degenerate
&quot;certificates only&quot; structure.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:17%;">Add the certificates in PEM
<i>file</i> to the PKCS#7 structure. This option can be used
more than once to read certificates from multiple files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Read the CRL from <i>file</i>,
or standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-nocrl</b></p>

<p style="margin-left:17%; margin-top: 1em">Normally, a CRL
is included in the output file. With this option, no CRL is
included in the output file and a CRL is not read from the
input file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Write the PKCS#7 structure to
<i>file</i>, or standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>DGST</b></p>

<p style="margin-left:6%;"><b>openssl dgst</b> [<b>-cd</b>]
[<b>-binary</b>] [<b>-</b><i>digest</i>] [<b>-hex</b>]
[<b>-hmac</b> <i>key</i>] [<b>-keyform pem</b>] [<b>-mac</b>
<i>algorithm</i>] [<b>-macopt</b> <i>nm</i>:<i>v</i>]
[<b>-out</b> <i>file</i>] [<b>-passin</b> <i>arg</i>]
[<b>-prverify</b> <i>file</i>] [<b>-sign</b> <i>file</i>]
[<b>-signature</b> <i>file</i>] [<b>-sigopt</b>
<i>nm</i>:<i>v</i>] [<b>-verify</b> <i>file</i>]
[<i>file&nbsp;...</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The digest
functions output the message digest of a supplied
<i>file</i> or <i>files</i> in hexadecimal form. They can
also be used for digital signing and verification.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-binary</b></p>

<p style="margin-left:17%;">Output the digest or signature
in binary form.</p>

<p style="margin-top: 1em"><b>-c</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
digest in two-digit groups separated by colons.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">Print BIO
debugging information.</p>

<p style="margin-top: 1em"><b>-</b><i>digest</i></p>

<p style="margin-left:17%;">Use the specified message
<i>digest</i>. The default is MD5. The available digests can
be displayed using <b>openssl
list-message-digest-commands</b>. The following are
equivalent: <b>openssl dgst -md5</b> and <b>openssl
md5</b>.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Digest is to be
output as a hex dump. This is the default case for a
&quot;normal&quot; digest as opposed to a digital
signature.</p>

<p style="margin-top: 1em"><b>-hmac</b> <i>key</i></p>

<p style="margin-left:17%;">Create a hashed MAC using
<i>key</i>.</p>

<p style="margin-top: 1em"><b>-keyform pem</b></p>

<p style="margin-left:17%;">Specifies the key format to
sign the digest with.</p>

<p style="margin-top: 1em"><b>-mac</b> <i>algorithm</i></p>

<p style="margin-left:17%;">Create a keyed Message
Authentication Code (MAC). The most popular MAC algorithm is
HMAC (hash-based MAC), but there are other MAC algorithms
which are not based on hash. MAC keys and other options
should be set via the <b>-macopt</b> parameter.</p>

<p style="margin-top: 1em"><b>-macopt</b>
<i>nm</i>:<i>v</i></p>

<p style="margin-left:17%;">Passes options to the MAC
algorithm, specified by <b>-mac</b>. The following options
are supported by HMAC:</p>

<p style="margin-top: 1em"><b>key</b>:<i>string</i></p>

<p style="margin-left:27%;">Specifies the MAC key as an
alphanumeric string (use if the key contain printable
characters only). String length must conform to any
restrictions of the MAC algorithm.</p>

<p style="margin-top: 1em"><b>hexkey</b>:<i>string</i></p>

<p style="margin-left:27%;">Specifies the MAC key in
hexadecimal form (two hex digits per byte). Key length must
conform to any restrictions of the MAC algorithm.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-prverify</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature using the
private key in <i>file</i>. The output is either
&quot;Verification OK&quot; or &quot;Verification
Failure&quot;.</p>

<p style="margin-top: 1em"><b>-sign</b> <i>file</i></p>

<p style="margin-left:17%;">Digitally sign the digest using
the private key in <i>file</i>.</p>

<p style="margin-top: 1em"><b>-signature</b>
<i>file</i></p>

<p style="margin-left:17%;">The actual signature to
verify.</p>

<p style="margin-top: 1em"><b>-sigopt</b>
<i>nm</i>:<i>v</i></p>

<p style="margin-left:17%;">Pass options to the signature
algorithm during sign or verify operations. The names and
values of these options are algorithm-specific.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature using the
public key in <i>file</i>. The output is either
&quot;Verification OK&quot; or &quot;Verification
Failure&quot;.</p>

<p style="margin-top: 1em"><i>file&nbsp;...</i></p>

<p style="margin-left:17%;">File or files to digest. If no
files are specified then standard input is used.</p>

<p style="margin-top: 1em"><b>DHPARAM</b></p>

<p style="margin-left:6%;"><b>openssl dhparam</b>
[<b>-2</b> | <b>-5</b>] [<b>-C</b>] [<b>-check</b>]
[<b>-dsaparam</b>] [<b>-in</b> <i>file</i>] [<b>-inform
der</b> | <b>pem</b>] [<b>-noout</b>] [<b>-out</b>
<i>file</i>] [<b>-outform der</b> | <b>pem</b>]
[<b>-text</b>] [<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>dhparam</b> command is used to manipulate DH parameter
files. Only the older PKCS#3 DH is supported, not the newer
X9.42 DH.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-2</b>, <b>-5</b></p>

<p style="margin-left:17%; margin-top: 1em">The generator
to use; 2 is the default. If present, the input file is
ignored and parameters are generated instead.</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">Convert the
parameters into C code. The parameters can then be loaded by
calling the get_dh<i>numbits</i> function.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">Check the DH
parameters.</p>

<p style="margin-top: 1em"><b>-dsaparam</b></p>

<p style="margin-left:17%;">Read or create DSA parameters,
converted to DH format on output. Otherwise,
&quot;strong&quot; primes (such that (p-1)/2 is also prime)
will be used for DH parameter generation.</p>

<p style="margin-left:17%; margin-top: 1em">DH parameter
generation with the <b>-dsaparam</b> option is much faster,
and the recommended exponent length is shorter, which makes
DH key exchange more efficient. Beware that with such
DSA-style DH parameters, a fresh DH key should be created
for each use to avoid small-subgroup attacks that may be
possible otherwise.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the DH
parameters in plain text.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">Generate a parameter set of
size <i>numbits</i>. It must be the last option. If not
present, a value of 2048 is used. If this value is present,
the input file is ignored and parameters are generated
instead.</p>

<p style="margin-top: 1em"><b>DSA</b></p>

<p style="margin-left:6%;"><b>openssl dsa</b> [</p>

<p><b>-aes128</b> | <b>-aes192</b> | <b>-aes256</b> |
<b>-des</b> | <b>-des3</b> ] [<b>-in</b> <i>file</i>]
[<b>-inform der</b> | <b>pem</b>] [<b>-modulus</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-passin</b> <i>arg</i>]
[<b>-passout</b> <i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>dsa</b>
command processes DSA keys. They can be converted between
various forms and their components printed out.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>:
This command uses the traditional <b>SSLeay</b> compatible
format for private key encryption: newer applications should
use the more secure PKCS#8 format using the <b>pkcs8</b>
command.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">Encrypt the private key with
the AES, DES, or the triple DES ciphers, respectively,
before outputting it. A pass phrase is prompted for. If none
of these options are specified, the key is written in plain
text. This means that using the <b>dsa</b> utility to read
an encrypted key with no encryption option can be used to
remove the pass phrase from a key, or by setting the
encryption options it can be used to add or change the pass
phrase. These options can only be used with PEM format
output files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. If the key is encrypted, a
pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">Print the value of the public
key component of the key.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified. If any encryption options
are set then a pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read in a
public key, not a private key.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">Output a public key, not a
private key. Automatically set if the input is a public
key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
public/private key in plain text.</p>

<p style="margin-top: 1em"><b>DSAPARAM</b></p>

<p style="margin-left:6%;"><b>openssl dsaparam</b>
[<b>-C</b>] [<b>-genkey</b>] [<b>-in</b> <i>file</i>]
[<b>-inform der</b> | <b>pem</b>] [<b>-noout</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> | <b>pem</b>]
[<b>-text</b>] [<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>dsaparam</b> command is used to manipulate or generate
DSA parameter files.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">Convert the
parameters into C code. The parameters can then be loaded by
calling the get_dsa<i>XXX</i> function.</p>

<p style="margin-top: 1em"><b>-genkey</b></p>

<p style="margin-left:17%;">Generate a DSA key either using
the specified or generated parameters.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. If the <i>numbits</i>
parameter is included, then this option is ignored.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the DSA
parameters in plain text.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">Generate a parameter set of
size <i>numbits</i>. If this option is included, the input
file is ignored.</p>

<p style="margin-top: 1em"><b>EC</b></p>

<p style="margin-left:6%;"><b>openssl ec</b>
[<b>-conv_form</b> <i>arg</i>] [<b>-des</b>] [<b>-des3</b>]
[<b>-in</b> <i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-param_enc</b> <i>arg</i>]
[<b>-param_out</b>] [<b>-passin</b> <i>arg</i>]
[<b>-passout</b> <i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ec</b>
command processes EC keys. They can be converted between
various forms and their components printed out.
<b>openssl</b> uses the private key format specified in
&ldquo;SEC 1: Elliptic Curve Cryptography&rdquo;
(<b>http://www.secg.org/</b>). To convert an EC private key
into the PKCS#8 private key format use the <b>pkcs8</b>
command.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-conv_form</b> <i>arg</i></p>

<p style="margin-left:17%;">Specify how the points on the
elliptic curve are converted into octet strings. Possible
values are: <b>compressed</b> (the default),
<b>uncompressed</b>, and <b>hybrid</b>. For more information
regarding the point conversion forms see the X9.62 standard.
Note: Due to patent issues the <b>compressed</b> option is
disabled by default for binary curves and can be enabled by
defining the preprocessor macro OPENSSL_EC_BIN_PT_COMP at
compile time.</p>

<p style="margin-top: 1em"><b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">Encrypt the private key with
DES, triple DES, or any other cipher supported by
<b>openssl</b>. A pass phrase is prompted for. If none of
these options is specified the key is written in plain text.
This means that using the <b>ec</b> utility to read in an
encrypted key with no encryption option can be used to
remove the pass phrase from a key, or by setting the
encryption options it can be used to add or change the pass
phrase. These options can only be used with PEM format
output files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read a key
from, or standard input if not specified. If the key is
encrypted a pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output filename to write
to, or standard output if not specified. If any encryption
options are set then a pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-param_enc</b> <i>arg</i></p>

<p style="margin-left:17%;">Specify how the elliptic curve
parameters are encoded. Possible value are:
<b>named_curve</b>, i.e. the EC parameters are specified by
an OID; or <b>explicit</b>, where the EC parameters are
explicitly given (see RFC 3279 for the definition of the EC
parameter structures). The default value is
<b>named_curve</b>. Note: the <b>implicitlyCA</b>
alternative, as specified in RFC 3279, is currently not
implemented.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read in a
public key, not a private key.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">Output a public key, not a
private key. Automatically set if the input is a public
key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
public/private key in plain text.</p>

<p style="margin-top: 1em"><b>ECPARAM</b></p>

<p style="margin-left:6%;"><b>openssl ecparam</b>
[<b>-C</b>] [<b>-check</b>] [<b>-conv_form</b> <i>arg</i>]
[<b>-genkey</b>] [<b>-in</b> <i>file</i>] [<b>-inform
der</b> | <b>pem</b>] [<b>-list_curves</b>] [<b>-name</b>
<i>arg</i>] [<b>-no_seed</b>] [<b>-noout</b>] [<b>-out</b>
<i>file</i>] [<b>-outform der</b> | <b>pem</b>]
[<b>-param_enc</b> <i>arg</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>ecparam</b> command is used to manipulate or generate EC
parameter files. <b>openssl</b> is not able to generate new
groups so <b>ecparam</b> can only create EC parameters from
known (named) curves.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">Convert the EC
parameters into C code. The parameters can then be loaded by
calling the get_ec_group_<i>XXX</i> function.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">Validate the
elliptic curve parameters.</p>

<p style="margin-top: 1em"><b>-conv_form</b> <i>arg</i></p>

<p style="margin-left:17%;">Specify how the points on the
elliptic curve are converted into octet strings. Possible
values are: <b>compressed</b> (the default),
<b>uncompressed</b>, and <b>hybrid</b>. For more information
regarding the point conversion forms see the X9.62 standard.
Note: Due to patent issues the <b>compressed</b> option is
disabled by default for binary curves and can be enabled by
defining the preprocessor macro OPENSSL_EC_BIN_PT_COMP at
compile time.</p>

<p style="margin-top: 1em"><b>-genkey</b></p>

<p style="margin-left:17%;">Generate an EC private key
using the specified parameters.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-list_curves</b></p>

<p style="margin-left:17%;">Print a list of all currently
implemented EC parameter names and exit.</p>

<p style="margin-top: 1em"><b>-name</b> <i>arg</i></p>

<p style="margin-left:17%;">Use the EC parameters with the
specified &quot;short&quot; name.</p>

<p style="margin-top: 1em"><b>-no_seed</b></p>

<p style="margin-left:17%;">Do not include the seed for the
parameter generation in the ECParameters structure (see RFC
3279).</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-param_enc</b> <i>arg</i></p>

<p style="margin-left:17%;">Specify how the elliptic curve
parameters are encoded. Possible value are:
<b>named_curve</b>, i.e. the EC parameters are specified by
an OID, or <b>explicit</b>, where the EC parameters are
explicitly given (see RFC 3279 for the definition of the EC
parameter structures). The default value is
<b>named_curve</b>. Note: the <b>implicitlyCA</b>
alternative, as specified in RFC 3279, is currently not
implemented.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the EC
parameters in plain text.</p>

<p style="margin-top: 1em"><b>ENC</b></p>

<p style="margin-left:6%;"><b>openssl enc -ciphername</b>
[<b>-AadePp</b>] [<b>-base64</b>] [<b>-bufsize</b>
<i>number</i>] [<b>-debug</b>] [<b>-in</b> <i>file</i>]
[<b>-iv</b> <i>IV</i>] [<b>-K</b> <i>key</i>] [<b>-k</b>
<i>password</i>] [<b>-kfile</b> <i>file</i>] [<b>-md</b>
<i>digest</i>] [<b>-none</b>] [<b>-nopad</b>]
[<b>-nosalt</b>] [<b>-out</b> <i>file</i>] [<b>-pass</b>
<i>arg</i>] [<b>-S</b> <i>salt</i>] [<b>-salt</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The symmetric
cipher commands allow data to be encrypted or decrypted
using various block and stream ciphers using keys based on
passwords or explicitly provided. Base64 encoding or
decoding can also be performed either by itself or in
addition to the encryption or decryption. The program can be
called either as <b>openssl</b> <i>ciphername</i> or
<b>openssl enc -</b><i>ciphername</i>.</p>

<p style="margin-left:6%; margin-top: 1em">Some of the
ciphers do not have large keys and others have security
implications if not used correctly. All the block ciphers
normally use PKCS#5 padding, also known as standard block
padding. If padding is disabled, the input data must be a
multiple of the cipher block length.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-A</b></p>

<p style="margin-left:17%; margin-top: 1em">If the
<b>-a</b> option is set, then base64 process the data on one
line.</p>

<p style="margin-top: 1em"><b>-a</b>, <b>-base64</b></p>

<p style="margin-left:17%;">Base64 process the data. This
means that if encryption is taking place, the data is
base64-encoded after encryption. If decryption is set, the
input data is base64-decoded before being decrypted.</p>

<p style="margin-top: 1em"><b>-bufsize</b>
<i>number</i></p>

<p style="margin-left:17%;">Set the buffer size for
I/O.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">Decrypt the
input data.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Debug the BIOs
used for I/O.</p>

<p style="margin-top: 1em"><b>-e</b></p>

<p style="margin-left:17%; margin-top: 1em">Encrypt the
input data. This is the default.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-iv</b> <i>IV</i></p>

<p style="margin-left:17%; margin-top: 1em">The actual
<i>IV</i> (initialisation vector) to use: this must be
represented as a string comprised only of hex digits. When
only the <i>key</i> is specified using the <b>-K</b> option,
the IV must explicitly be defined. When a password is being
specified using one of the other options, the IV is
generated from this password.</p>

<p style="margin-top: 1em"><b>-K</b> <i>key</i></p>

<p style="margin-left:17%; margin-top: 1em">The actual
<i>key</i> to use: this must be represented as a string
comprised only of hex digits. If only the key is specified,
the IV must also be specified using the <b>-iv</b> option.
When both a <i>key</i> and a <i>password</i> are specified,
the <i>key</i> given with the <b>-K</b> option will be used
and the IV generated from the password will be taken. It
probably does not make much sense to specify both <i>key</i>
and <i>password</i>.</p>

<p style="margin-top: 1em"><b>-k</b> <i>password</i></p>

<p style="margin-left:17%;">The <i>password</i> to derive
the key from. Superseded by the <b>-pass</b> option.</p>

<p style="margin-top: 1em"><b>-kfile</b> <i>file</i></p>

<p style="margin-left:17%;">Read the password to derive the
key from the first line of <i>file</i>. Superseded by the
<b>-pass</b> option.</p>

<p style="margin-top: 1em"><b>-md</b> <i>digest</i></p>

<p style="margin-left:17%;">Use <i>digest</i> to create a
key from a pass phrase. <i>digest</i> may be one of
<b>md5</b> or <b>sha1</b>.</p>

<p style="margin-top: 1em"><b>-none</b></p>

<p style="margin-left:17%; margin-top: 1em">Use NULL cipher
(no encryption or decryption of input).</p>

<p style="margin-top: 1em"><b>-nopad</b></p>

<p style="margin-left:17%; margin-top: 1em">Disable
standard block padding.</p>

<p style="margin-top: 1em"><b>-nosalt</b></p>

<p style="margin-left:17%;">Don&rsquo;t use a salt in the
key derivation routines. This option should never be used
since it makes it possible to perform efficient dictionary
attacks on the password and to attack stream cipher
encrypted data.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-P</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
salt, key, and IV used, then immediately exit; don&rsquo;t
do any encryption or decryption.</p>

<p style="margin-top: 1em"><b>-p</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
salt, key, and IV used.</p>

<p style="margin-top: 1em"><b>-pass</b> <i>arg</i></p>

<p style="margin-left:17%;">The password source.</p>

<p style="margin-top: 1em"><b>-S</b> <i>salt</i></p>

<p style="margin-left:17%;">The actual <i>salt</i> to use:
this must be represented as a string comprised only of hex
digits.</p>

<p style="margin-top: 1em"><b>-salt</b></p>

<p style="margin-left:17%; margin-top: 1em">Use a salt in
the key derivation routines (the default). When the salt is
being used the first eight bytes of the encrypted data are
reserved for the salt: it is randomly generated when
encrypting a file and read from the encrypted file when it
is decrypted.</p>

<p style="margin-top: 1em"><b>ERRSTR</b></p>

<p style="margin-left:6%;"><b>openssl errstr</b>
[<b>-stats</b>] <i>errno ...</i></p>

<p style="margin-left:6%; margin-top: 1em">The
<b>errstr</b> command performs error number to error string
conversion, generating a human-readable string representing
the error code <i>errno</i>. The string is obtained through
the ERR_error_string_n(3) function and has the following
format:</p>

<p style="margin-left:14%; margin-top: 1em">error:[error
code]:[library name]:[function name]:[reason string]</p>

<p style="margin-left:6%; margin-top: 1em">[error code] is
an 8-digit hexadecimal number. The remaining fields [library
name], [function name], and [reason string] are all ASCII
text.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-stats</b></p>

<p style="margin-left:17%; margin-top: 1em">Print debugging
statistics about various aspects of the hash table.</p>

<p style="margin-top: 1em"><b>GENDSA</b></p>

<p style="margin-left:6%;"><b>openssl gendsa</b> [</p>

<p><b>-aes128</b> | <b>-aes192</b> | <b>-aes256</b> |
<b>-des</b> | <b>-des3</b> ] [<b>-out</b> <i>file</i>]
[<i>paramfile</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>gendsa</b> command generates a DSA private key from a DSA
parameter file (typically generated by the <b>openssl
dsaparam</b> command). DSA key generation is little more
than random number generation so it is much quicker than,
for example, RSA key generation.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">Encrypt the private key with
the AES, DES, or the triple DES ciphers, respectively,
before outputting it. A pass phrase is prompted for. If none
of these options are specified, no encryption is used.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><i>paramfile</i></p>

<p style="margin-left:17%;">Specify the DSA parameter file
to use. The parameters in this file determine the size of
the private key.</p>

<p style="margin-top: 1em"><b>GENPKEY</b></p>

<p style="margin-left:6%;"><b>openssl genpkey</b>
[<b>-algorithm</b> <i>alg</i>] [<i>cipher</i>]
[<b>-genparam</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-paramfile</b> <i>file</i>]
[<b>-pass</b> <i>arg</i>] [<b>-pkeyopt</b>
<i>opt</i>:<i>value</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>genpkey</b> command generates private keys. The use of
this program is encouraged over the algorithm specific
utilities because additional algorithm options can be
used.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-algorithm</b> <i>alg</i></p>

<p style="margin-left:17%;">The public key algorithm to
use, such as RSA, DSA, or DH. This option must precede any
<b>-pkeyopt</b> options. The options <b>-paramfile</b> and
<b>-algorithm</b> are mutually exclusive.</p>

<p style="margin-top: 1em"><i>cipher</i></p>

<p style="margin-left:17%; margin-top: 1em">Encrypt the
private key with the supplied cipher. Any algorithm name
accepted by EVP_get_cipherbyname(3) is acceptable.</p>

<p style="margin-top: 1em"><b>-genparam</b></p>

<p style="margin-left:17%;">Generate a set of parameters
instead of a private key. This option must precede any
<b>-algorithm</b>, <b>-paramfile</b>, or <b>-pkeyopt</b>
options.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-paramfile</b>
<i>file</i></p>

<p style="margin-left:17%;">Some public key algorithms
generate a private key based on a set of parameters, which
can be supplied using this option. If this option is used
the public key algorithm used is determined by the
parameters. This option must precede any <b>-pkeyopt</b>
options. The options <b>-paramfile</b> and <b>-algorithm</b>
are mutually exclusive.</p>

<p style="margin-top: 1em"><b>-pass</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pkeyopt</b>
<i>opt</i>:<i>value</i></p>

<p style="margin-left:17%;">Set the public key algorithm
option <i>opt</i> to <i>value</i>, as follows:</p>


<p style="margin-top: 1em">rsa_keygen_bits:<i>numbits</i></p>

<p style="margin-left:35%;">(RSA) The number of bits in the
generated key. The default is 2048.</p>


<p style="margin-top: 1em">rsa_keygen_pubexp:<i>value</i></p>

<p style="margin-left:35%;">(RSA) The RSA public exponent
value. This can be a large decimal or hexadecimal value if
preceded by 0x. The default is 65537.</p>


<p style="margin-top: 1em">dsa_paramgen_bits:<i>numbits</i></p>

<p style="margin-left:35%;">(DSA) The number of bits in the
generated parameters. The default is 1024.</p>


<p style="margin-top: 1em">dh_paramgen_prime_len:<i>numbits</i></p>

<p style="margin-left:35%;">(DH) The number of bits in the
prime parameter <i>p</i>.</p>


<p style="margin-top: 1em">dh_paramgen_generator:<i>value</i></p>

<p style="margin-left:35%;">(DH) The value to use for the
generator <i>g</i>.</p>


<p style="margin-top: 1em">ec_paramgen_curve:<i>curve</i></p>

<p style="margin-left:35%;">(EC) The EC curve to use.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
private/public key in plain text.</p>

<p style="margin-top: 1em"><b>GENRSA</b></p>

<p style="margin-left:6%;"><b>openssl genrsa</b> [<b>-3</b>
| <b>-f4</b>] [<b>-aes128</b> | <b>-aes192</b> |
<b>-aes256</b> | <b>-des</b> | <b>-des3</b>] [<b>-out</b>
<i>file</i>] [<b>-passout</b> <i>arg</i>]
[<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>genrsa</b> command generates an RSA private key, which
essentially involves the generation of two prime numbers.
When generating the key, various symbols will be output to
indicate the progress of the generation. A &rsquo;.&rsquo;
represents each number which has passed an initial sieve
test; &rsquo;+&rsquo; means a number has passed a single
round of the Miller-Rabin primality test. A newline means
that the number has passed all the prime tests (the actual
number depends on the key size).</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-3</b> | <b>-f4</b></p>

<p style="margin-left:17%;">The public exponent to use,
either 3 or 65537. The default is 65537.</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">Encrypt the private key with
the AES, DES, or the triple DES ciphers, respectively,
before outputting it. If none of these options are
specified, no encryption is used. If encryption is used, a
pass phrase is prompted for, if it is not supplied via the
<b>-passout</b> option.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">The size of the private key to
generate in bits. This must be the last option specified.
The default is 2048.</p>

<p style="margin-top: 1em"><b>NSEQ</b></p>

<p style="margin-left:6%;"><b>openssl nseq</b> [<b>-in</b>
<i>file</i>] [<b>-out</b> <i>file</i>] [<b>-toseq</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>nseq</b>
command takes a file containing a Netscape certificate
sequence (an alternative to the standard PKCS#7 format) and
prints out the certificates contained in it, or takes a file
of certificates and converts it into a Netscape certificate
sequence.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-toseq</b></p>

<p style="margin-left:17%; margin-top: 1em">Normally, a
Netscape certificate sequence will be input and the output
is the certificates contained in it. With the <b>-toseq</b>
option the situation is reversed: a Netscape certificate
sequence is created from a file of certificates.</p>

<p style="margin-top: 1em"><b>OCSP</b></p>

<p style="margin-left:6%;"><b>openssl ocsp</b> [<b>-CA</b>
<i>file</i>] [<b>-CAfile</b> <i>file</i>] [<b>-CApath</b>
<i>directory</i>] [<b>-cert</b> <i>file</i>] [<b>-dgst</b>
<i>alg</i>] [<b>-host</b> <i>hostname</i>:<i>port</i>]
[<b>-index</b> <i>indexfile</i>] [<b>-issuer</b>
<i>file</i>] [<b>-ndays</b> <i>days</i>] [<b>-nmin</b>
<i>minutes</i>] [<b>-no_cert_checks</b>]
[<b>-no_cert_verify</b>] [<b>-no_certs</b>]
[<b>-no_chain</b>] [<b>-no_intern</b>] [<b>-no_nonce</b>]
[<b>-no_signature_verify</b>] [<b>-nonce</b>]
[<b>-noverify</b>] [<b>-nrequest</b> <i>number</i>]
[<b>-out</b> <i>file</i>] [<b>-path</b> <i>path</i>]
[<b>-port</b> <i>portnum</i>] [<b>-req_text</b>]
[<b>-reqin</b> <i>file</i>] [<b>-reqout</b> <i>file</i>]
[<b>-resp_key_id</b>] [<b>-resp_no_certs</b>]
[<b>-resp_text</b>] [<b>-respin</b> <i>file</i>]
[<b>-respout</b> <i>file</i>] [<b>-rkey</b> <i>file</i>]
[<b>-rother</b> <i>file</i>] [<b>-rsigner</b> <i>file</i>]
[<b>-serial</b> <i>number</i>] [<b>-sign_other</b>
<i>file</i>] [<b>-signer</b> <i>file</i>] [<b>-signkey</b>
<i>file</i>] [<b>-status_age</b> <i>age</i>] [<b>-text</b>]
[<b>-trust_other</b>] [<b>-url</b> <i>responder_url</i>]
[<b>-VAfile</b> <i>file</i>] [<b>-validity_period</b>
<i>nsec</i>] [<b>-verify_other</b> <i>file</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The Online
Certificate Status Protocol (OCSP) enables applications to
determine the (revocation) state of an identified
certificate (RFC 2560).</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ocsp</b>
command performs many common OCSP tasks. It can be used to
print out requests and responses, create requests and send
queries to an OCSP responder, and behave like a mini OCSP
server itself.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i>,
<b>-CApath</b> <i>directory</i></p>

<p style="margin-left:17%;">A file or path containing
trusted CA certificates, used to verify the signature on the
OCSP response.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">Add the certificate <i>file</i>
to the request. The issuer certificate is taken from the
previous <b>-issuer</b> option, or an error occurs if no
issuer certificate is specified.</p>

<p style="margin-top: 1em"><b>-dgst</b> <i>alg</i></p>

<p style="margin-left:17%;">Use the digest algorithm
<i>alg</i> for certificate identification in the OCSP
request. By default SHA-1 is used.</p>

<p style="margin-top: 1em"><b>-host</b>
<i>hostname</i>:<i>port</i>, <b>-path</b> <i>path</i></p>

<p style="margin-left:17%;">Send the OCSP request to
<i>hostname</i> on <i>port</i>. <b>-path</b> specifies the
HTTP path name to use, or <i>/</i> by default.</p>

<p style="margin-top: 1em"><b>-issuer</b> <i>file</i></p>

<p style="margin-left:17%;">The current issuer certificate,
in PEM format. Can be used multiple times and must come
before any <b>-cert</b> options.</p>

<p style="margin-top: 1em"><b>-no_cert_checks</b></p>

<p style="margin-left:17%;">Don&rsquo;t perform any
additional checks on the OCSP response signer&rsquo;s
certificate. That is, do not make any checks to see if the
signer&rsquo;s certificate is authorised to provide the
necessary status information: as a result this option should
only be used for testing purposes.</p>

<p style="margin-top: 1em"><b>-no_cert_verify</b></p>

<p style="margin-left:17%;">Don&rsquo;t verify the OCSP
response signer&rsquo;s certificate at all. Since this
option allows the OCSP response to be signed by any
certificate, it should only be used for testing
purposes.</p>

<p style="margin-top: 1em"><b>-no_certs</b></p>

<p style="margin-left:17%;">Don&rsquo;t include any
certificates in the signed request.</p>

<p style="margin-top: 1em"><b>-no_chain</b></p>

<p style="margin-left:17%;">Do not use certificates in the
response as additional untrusted CA certificates.</p>

<p style="margin-top: 1em"><b>-no_intern</b></p>

<p style="margin-left:17%;">Ignore certificates contained
in the OCSP response when searching for the signer&rsquo;s
certificate. The signer&rsquo;s certificate must be
specified with either the <b>-verify_other</b> or
<b>-VAfile</b> options.</p>

<p style="margin-top: 1em"><b>-no_signature_verify</b></p>

<p style="margin-left:17%;">Don&rsquo;t check the signature
on the OCSP response. Since this option tolerates invalid
signatures on OCSP responses, it will normally only be used
for testing purposes.</p>

<p style="margin-top: 1em"><b>-nonce</b>,
<b>-no_nonce</b></p>

<p style="margin-left:17%;">Add an OCSP nonce extension to
a request, or disable an OCSP nonce addition. Normally, if
an OCSP request is input using the <b>-respin</b> option no
nonce is added: using the <b>-nonce</b> option will force
the addition of a nonce. If an OCSP request is being created
(using the <b>-cert</b> and <b>-serial</b> options) a nonce
is automatically added; specifying <b>-no_nonce</b>
overrides this.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:17%;">Don&rsquo;t attempt to verify
the OCSP response signature or the nonce values. This is
normally only be used for debugging since it disables all
verification of the responder&rsquo;s certificate.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specify the output file to
write to, or standard output if not specified.</p>

<p style="margin-top: 1em"><b>-req_text</b>,
<b>-resp_text</b>, <b>-text</b></p>

<p style="margin-left:17%;">Print out the text form of the
OCSP request, response, or both, respectively.</p>

<p style="margin-top: 1em"><b>-reqin</b> <i>file</i>,
<b>-respin</b> <i>file</i></p>

<p style="margin-left:17%;">Read an OCSP request or
response file from <i>file</i>. These options are ignored if
an OCSP request or response creation is implied by other
options (for example with the <b>-serial</b>, <b>-cert</b>,
and <b>-host</b> options).</p>

<p style="margin-top: 1em"><b>-reqout</b> <i>file</i>,
<b>-respout</b> <i>file</i></p>

<p style="margin-left:17%;">Write out the DER-encoded
certificate request or response to <i>file</i>.</p>

<p style="margin-top: 1em"><b>-serial</b> <i>num</i></p>

<p style="margin-left:17%;">Same as the <b>-cert</b> option
except the certificate with serial number <i>num</i> is
added to the request. The serial number is interpreted as a
decimal integer unless preceded by &rsquo;0x&rsquo;.
Negative integers can also be specified by preceding the
value with a minus sign.</p>

<p style="margin-top: 1em"><b>-sign_other</b>
<i>file</i></p>

<p style="margin-left:17%;">Additional certificates to
include in the signed request.</p>

<p style="margin-top: 1em"><b>-signer</b> <i>file</i>,
<b>-signkey</b> <i>file</i></p>

<p style="margin-left:17%;">Sign the OCSP request using the
certificate specified in the <b>-signer</b> option and the
private key specified by the <b>-signkey</b> option. If the
<b>-signkey</b> option is not present, then the private key
is read from the same file as the certificate. If neither
option is specified, the OCSP request is not signed.</p>

<p style="margin-top: 1em"><b>-trust_other</b></p>

<p style="margin-left:17%;">The certificates specified by
the <b>-verify_other</b> option should be explicitly trusted
and no additional checks will be performed on them. This is
useful when the complete responder certificate chain is not
available or trusting a root CA is not appropriate.</p>

<p style="margin-top: 1em"><b>-url</b>
<i>responder_url</i></p>

<p style="margin-left:17%;">Specify the responder URL. Both
HTTP and HTTPS (SSL/TLS) URLs can be specified.</p>

<p style="margin-top: 1em"><b>-VAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A file containing explicitly
trusted responder certificates. Equivalent to the
<b>-verify_other</b> and <b>-trust_other</b> options.</p>

<p style="margin-top: 1em"><b>-validity_period</b>
<i>nsec</i>, <b>-status_age</b> <i>age</i></p>

<p style="margin-left:17%;">The range of times, in seconds,
which will be tolerated in an OCSP response. Each
certificate status response includes a notBefore time and an
optional notAfter time. The current time should fall between
these two values, but the interval between the two times may
be only a few seconds. In practice the OCSP responder and
clients&rsquo; clocks may not be precisely synchronised and
so such a check may fail. To avoid this the
<b>-validity_period</b> option can be used to specify an
acceptable error range in seconds, the default value being 5
minutes.</p>

<p style="margin-left:17%; margin-top: 1em">If the notAfter
time is omitted from a response, it means that new status
information is immediately available. In this case the age
of the notBefore field is checked to see it is not older
than <i>age</i> seconds old. By default, this additional
check is not performed.</p>

<p style="margin-top: 1em"><b>-verify_other</b>
<i>file</i></p>

<p style="margin-left:17%;">A file containing additional
certificates to search when attempting to locate the OCSP
response signing certificate. Some responders omit the
actual signer&rsquo;s certificate from the response, so this
can be used to supply the necessary certificate.</p>

<p style="margin-left:6%; margin-top: 1em">The options for
the OCSP server are as follows:</p>

<p style="margin-top: 1em"><b>-CA</b> <i>file</i></p>

<p style="margin-left:14%;">CA certificate corresponding to
the revocation information in <i>indexfile</i>.</p>

<p style="margin-top: 1em"><b>-index</b>
<i>indexfile</i></p>

<p style="margin-left:14%;"><i>indexfile</i> is a text
index file in ca format containing certificate revocation
information.</p>

<p style="margin-left:14%; margin-top: 1em">If this option
is specified, <b>ocsp</b> is in responder mode, otherwise it
is in client mode. The requests the responder processes can
be either specified on the command line (using the
<b>-issuer</b> and <b>-serial</b> options), supplied in a
file (using the <b>-respin</b> option), or via external OCSP
clients (if <i>port</i> or <i>url</i> is specified).</p>

<p style="margin-left:14%; margin-top: 1em">If this option
is present, then the <b>-CA</b> and <b>-rsigner</b> options
must also be present.</p>

<p style="margin-top: 1em"><b>-nmin</b> <i>minutes</i>,
<b>-ndays</b> <i>days</i></p>

<p style="margin-left:14%;">Number of <i>minutes</i> or
<i>days</i> when fresh revocation information is available:
used in the nextUpdate field. If neither option is present,
the nextUpdate field is omitted, meaning fresh revocation
information is immediately available.</p>

<p style="margin-top: 1em"><b>-nrequest</b>
<i>number</i></p>

<p style="margin-left:14%;">Exit after receiving
<i>number</i> requests (the default is unlimited).</p>

<p style="margin-top: 1em"><b>-port</b> <i>portnum</i></p>

<p style="margin-left:14%;">Port to listen for OCSP
requests on. May also be specified using the <b>-url</b>
option.</p>

<p style="margin-top: 1em"><b>-resp_key_id</b></p>

<p style="margin-left:14%;">Identify the signer certificate
using the key ID; the default is to use the subject
name.</p>

<p style="margin-top: 1em"><b>-resp_no_certs</b></p>

<p style="margin-left:14%;">Don&rsquo;t include any
certificates in the OCSP response.</p>

<p style="margin-top: 1em"><b>-rkey</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to sign OCSP
responses with; if not present, the file specified in the
<b>-rsigner</b> option is used.</p>

<p style="margin-top: 1em"><b>-rother</b> <i>file</i></p>

<p style="margin-left:14%;">Additional certificates to
include in the OCSP response.</p>

<p style="margin-top: 1em"><b>-rsigner</b> <i>file</i></p>

<p style="margin-left:14%;">The certificate to sign OCSP
responses with.</p>

<p style="margin-left:6%; margin-top: 1em">Initially the
OCSP responder certificate is located and the signature on
the OCSP request checked using the responder
certificate&rsquo;s public key. Then a normal certificate
verify is performed on the OCSP responder certificate
building up a certificate chain in the process. The
locations of the trusted certificates used to build the
chain can be specified by the <b>-CAfile</b> and
<b>-CApath</b> options or they will be looked for in the
standard <b>openssl</b> certificates directory.</p>

<p style="margin-left:6%; margin-top: 1em">If the initial
verify fails, the OCSP verify process halts with an error.
Otherwise the issuing CA certificate in the request is
compared to the OCSP responder certificate: if there is a
match then the OCSP verify succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">Otherwise the
OCSP responder certificate&rsquo;s CA is checked against the
issuing CA certificate in the request. If there is a match
and the OCSPSigning extended key usage is present in the
OCSP responder certificate, then the OCSP verify
succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">Otherwise the
root CA of the OCSP responder&rsquo;s CA is checked to see
if it is trusted for OCSP signing. If it is, the OCSP verify
succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">If none of these
checks is successful, the OCSP verify fails. What this
effectively means is that if the OCSP responder certificate
is authorised directly by the CA it is issuing revocation
information about (and it is correctly configured), then
verification will succeed.</p>

<p style="margin-left:6%; margin-top: 1em">If the OCSP
responder is a global responder, which can give details
about multiple CAs and has its own separate certificate
chain, then its root CA can be trusted for OCSP signing.
Alternatively, the responder certificate itself can be
explicitly trusted with the <b>-VAfile</b> option.</p>

<p style="margin-top: 1em"><b>PASSWD</b></p>

<p style="margin-left:6%;"><b>openssl passwd</b> [<b>-1</b>
| <b>-apr1</b> | <b>-crypt</b>] [<b>-in</b> <i>file</i>]
[<b>-noverify</b>] [<b>-quiet</b>] [<b>-reverse</b>]
[<b>-salt</b> <i>string</i>] [<b>-stdin</b>] [<b>-table</b>]
[<i>password</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>passwd</b> command computes the hash of a password.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-1</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the MD5
based BSD password algorithm &quot;1&quot;.</p>

<p style="margin-top: 1em"><b>-apr1</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the
&quot;apr1&quot; algorithm (</p>

<p>Apache variant of the BSD algorithm ).</p>

<p style="margin-top: 1em"><b>-crypt</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the
&quot;crypt&quot; algorithm (the default).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Read passwords from
<i>file</i>.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:17%;">Don&rsquo;t verify when reading
a password from the terminal.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output warnings when passwords given on the command line are
truncated.</p>

<p style="margin-top: 1em"><b>-reverse</b></p>

<p style="margin-left:17%;">Switch table columns. This only
makes sense in conjunction with the <b>-table</b>
option.</p>

<p style="margin-top: 1em"><b>-salt</b> <i>string</i></p>

<p style="margin-left:17%;">Use the salt specified by
<i>string</i>. When reading a password from the terminal,
this implies <b>-noverify</b>.</p>

<p style="margin-top: 1em"><b>-stdin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read passwords
from standard input.</p>

<p style="margin-top: 1em"><b>-table</b></p>

<p style="margin-left:17%; margin-top: 1em">In the output
list, prepend the cleartext password and a TAB character to
each password hash.</p>

<p style="margin-top: 1em"><b>PKCS7</b></p>

<p style="margin-left:6%;"><b>openssl pkcs7</b> [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-print_certs</b>]
[<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkcs7</b>
command processes PKCS#7 files in DER or PEM format. The
PKCS#7 routines only understand PKCS#7 v 1.5 as specified in
RFC 2315.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output the encoded version of the PKCS#7 structure (or
certificates if <b>-print_certs</b> is set).</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-print_certs</b></p>

<p style="margin-left:17%;">Print any certificates or CRLs
contained in the file, preceded by their subject and issuer
names in a one-line format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print
certificate details in full rather than just subject and
issuer names.</p>

<p style="margin-top: 1em"><b>PKCS8</b></p>

<p style="margin-left:6%;"><b>openssl pkcs8</b> [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-nocrypt</b>] [<b>-noiter</b>] [<b>-out</b> <i>file</i>]
[<b>-outform der</b> | <b>pem</b>] [<b>-passin</b>
<i>arg</i>] [<b>-passout</b> <i>arg</i>] [<b>-topk8</b>]
[<b>-v1</b> <i>alg</i>] [<b>-v2</b> <i>alg</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkcs8</b>
command processes private keys (both encrypted and
unencrypted) in PKCS#8 format with a variety of PKCS#5 (v1.5
and v2.0) and PKCS#12 algorithms. The default encryption is
only 56 bits; keys encrypted using PKCS#5 v2.0 algorithms
and high iteration counts are more secure.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. If the key is encrypted, a
pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-nocrypt</b></p>

<p style="margin-left:17%;">Generate an unencrypted
PrivateKeyInfo structure. This option does not encrypt
private keys at all and should only be used when absolutely
necessary.</p>

<p style="margin-top: 1em"><b>-noiter</b></p>

<p style="margin-left:17%;">Use an iteration count of 1.
See the <i>PKCS12</i> section below for a detailed
explanation of this option.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if none is specified. If any encryption
options are set, a pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-topk8</b></p>

<p style="margin-left:17%; margin-top: 1em">Read a
traditional format private key and write a PKCS#8 format
key.</p>

<p style="margin-top: 1em"><b>-v1</b> <i>alg</i></p>

<p style="margin-left:17%;">Specify a PKCS#5 v1.5 or
PKCS#12 algorithm to use.</p>

<p style="margin-top: 1em">PBE-MD5-DES</p>

<p style="margin-left:24%;">56-bit DES.</p>

<p>PBE-SHA1-RC2-64 | PBE-MD5-RC2-64 | PBE-SHA1-DES</p>

<p style="margin-left:24%;">64-bit RC2 or 56-bit DES.</p>

<p>PBE-SHA1-RC4-128 | PBE-SHA1-RC4-40 | PBE-SHA1-3DES <br>
PBE-SHA1-2DES | PBE-SHA1-RC2-128 | PBE-SHA1-RC2-40</p>

<p style="margin-left:24%;">PKCS#12 password-based
encryption algorithm, which allow strong encryption
algorithms like triple DES or 128-bit RC2.</p>

<p style="margin-top: 1em"><b>-v2</b> <i>alg</i></p>

<p style="margin-left:17%;">Use PKCS#5 v2.0 algorithms.
Supports algorithms such as 168-bit triple DES or 128-bit
RC2, however not many implementations support PKCS#5 v2.0
yet (if using private keys with <b>openssl</b> this
doesn&rsquo;t matter).</p>

<p style="margin-left:17%; margin-top: 1em"><i>alg</i> is
the encryption algorithm to use; valid values include des,
des3, and rc2. It is recommended that des3 is used.</p>

<p style="margin-top: 1em"><b>PKCS12</b></p>

<p style="margin-left:6%;"><b>openssl pkcs12</b>
[<b>-aes128</b> | <b>-aes192</b> | <b>-aes256</b> |
<b>-des</b> | <b>-des3</b>] [<b>-cacerts</b>]
[<b>-CAfile</b> <i>file</i>] [<b>-caname</b> <i>name</i>]
[<b>-CApath</b> <i>directory</i>] [<b>-certfile</b>
<i>file</i>] [<b>-certpbe</b> <i>alg</i>] [<b>-chain</b>]
[<b>-clcerts</b>] [<b>-CSP</b> <i>name</i>]
[<b>-descert</b>] [<b>-export</b>] [<b>-in</b> <i>file</i>]
[<b>-info</b>] [<b>-inkey</b> <i>file</i>] [<b>-keyex</b>]
[<b>-keypbe</b> <i>alg</i>] [<b>-keysig</b>] [<b>-macalg</b>
<i>alg</i>] [<b>-maciter</b>] [<b>-name</b> <i>name</i>]
[<b>-nocerts</b>] [<b>-nodes</b>] [<b>-noiter</b>]
[<b>-nokeys</b>] [<b>-nomac</b>] [<b>-nomaciter</b>]
[<b>-nomacver</b>] [<b>-noout</b>] [<b>-out</b> <i>file</i>]
[<b>-passin</b> <i>arg</i>] [<b>-passout</b> <i>arg</i>]
[<b>-twopass</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>pkcs12</b> command allows PKCS#12 files (sometimes
referred to as PFX files) to be created and parsed. By
default, a PKCS#12 file is parsed; a PKCS#12 file can be
created by using the <b>-export</b> option.</p>

<p style="margin-left:6%; margin-top: 1em">The options for
parsing a PKCS12 file are as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:14%;">Encrypt private keys using AES,
DES, or triple DES, respectively. The default is triple
DES.</p>

<p style="margin-top: 1em"><b>-cacerts</b></p>

<p style="margin-left:14%;">Only output CA certificates
(not client certificates).</p>

<p style="margin-top: 1em"><b>-clcerts</b></p>

<p style="margin-left:14%;">Only output client certificates
(not CA certificates).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-info</b></p>

<p style="margin-left:14%;">Output additional information
about the PKCS#12 file structure, algorithms used, and
iteration counts.</p>

<p style="margin-top: 1em"><b>-nocerts</b></p>

<p style="margin-left:14%;">Do not output certificates.</p>

<p style="margin-top: 1em"><b>-nodes</b></p>

<p style="margin-left:14%;">Do not encrypt private
keys.</p>

<p style="margin-top: 1em"><b>-nokeys</b></p>

<p style="margin-left:14%;">Do not output private keys.</p>

<p style="margin-top: 1em"><b>-nomacver</b></p>

<p style="margin-left:14%;">Do not attempt to verify the
integrity MAC before reading the file.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:14%;">Do not output the keys and
certificates to the output file version of the PKCS#12
file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:14%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-twopass</b></p>

<p style="margin-left:14%;">Prompt for separate integrity
and encryption passwords: most software always assumes these
are the same so this option will render such PKCS#12 files
unreadable.</p>

<p style="margin-left:6%; margin-top: 1em">The options for
PKCS12 file creation are as follows:</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:14%;">CA storage as a file.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:14%;">CA storage as a directory. The
directory must be a standard certificate directory: that is,
a hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><b>-caname</b> <i>name</i></p>

<p style="margin-left:14%;">Specify the &quot;friendly
name&quot; for other certificates. May be used multiple
times to specify names for all certificates in the order
they appear.</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:14%;">A file to read additional
certificates from.</p>

<p style="margin-top: 1em"><b>-certpbe</b> <i>alg</i>,
<b>-keypbe</b> <i>alg</i></p>

<p style="margin-left:14%;">Specify the algorithm used to
encrypt the private key and certificates to be selected. Any
PKCS#5 v1.5 or PKCS#12 PBE algorithm name can be used. If a
cipher name (as output by the <b>list-cipher-algorithms</b>
command) is specified then it is used with PKCS#5 v2.0. For
interoperability reasons it is advisable to only use PKCS#12
algorithms.</p>

<p style="margin-top: 1em"><b>-chain</b></p>

<p style="margin-left:14%;">Include the entire certificate
chain of the user certificate. The standard CA store is used
for this search. If the search fails, it is considered a
fatal error.</p>

<p style="margin-top: 1em"><b>-CSP</b> <i>name</i></p>

<p style="margin-left:14%;">Write <i>name</i> as a
Microsoft CSP name.</p>

<p style="margin-top: 1em"><b>-descert</b></p>

<p style="margin-left:14%;">Encrypt the certificate using
triple DES; this may render the PKCS#12 file unreadable by
some &quot;export grade&quot; software. By default, the
private key is encrypted using triple DES and the
certificate using 40-bit RC2.</p>

<p style="margin-top: 1em"><b>-export</b></p>

<p style="margin-left:14%;">Create a PKCS#12 file (rather
than parsing one).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The input file to read from, or
standard input if not specified. The order doesn&rsquo;t
matter but one private key and its corresponding certificate
should be present. If additional certificates are present,
they will also be included in the PKCS#12 file.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:14%;">File to read a private key
from. If not present, a private key must be present in the
input file.</p>

<p style="margin-top: 1em"><b>-keyex</b> |
<b>-keysig</b></p>

<p style="margin-left:14%;">Specify whether the private key
is to be used for key exchange or just signing. Normally,
&quot;export grade&quot; software will only allow 512-bit
RSA keys to be used for encryption purposes, but arbitrary
length keys for signing. The <b>-keysig</b> option marks the
key for signing only. Signing only keys can be used for
S/MIME signing, authenticode (ActiveX control signing) and
SSL client authentication.</p>

<p style="margin-top: 1em"><b>-macalg</b> <i>alg</i></p>

<p style="margin-left:14%;">Specify the MAC digest
algorithm. The default is SHA1.</p>

<p style="margin-top: 1em"><b>-maciter</b></p>

<p style="margin-left:14%;">Included for compatibility
only: it used to be needed to use MAC iterations counts but
they are now used by default.</p>

<p style="margin-top: 1em"><b>-name</b> <i>name</i></p>

<p style="margin-left:14%;">Specify the &quot;friendly
name&quot; for the certificate and private key. This name is
typically displayed in list boxes by software importing the
file.</p>

<p style="margin-top: 1em"><b>-nomac</b></p>

<p style="margin-left:14%;">Don&rsquo;t attempt to provide
the MAC integrity.</p>

<p style="margin-top: 1em"><b>-nomaciter</b>,
<b>-noiter</b></p>

<p style="margin-left:14%;">Affect the iteration counts on
the MAC and key algorithms.</p>

<p style="margin-left:14%; margin-top: 1em">To discourage
attacks by using large dictionaries of common passwords, the
algorithm that derives keys from passwords can have an
iteration count applied to it: this causes a certain part of
the algorithm to be repeated and slows it down. The MAC is
used to check the file integrity but since it will normally
have the same password as the keys and certificates it could
also be attacked. By default, both MAC and encryption
iteration counts are set to 2048; using these options the
MAC and encryption iteration counts can be set to 1. Since
this reduces the file security you should not use these
options unless you really have to. Most software supports
both MAC and key iteration counts.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:14%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>PKEY</b></p>

<p style="margin-left:6%;"><b>openssl pkey</b>
[<i>cipher</i>] [<b>-in</b> <i>file</i>] [<b>-inform der</b>
| <b>pem</b>] [<b>-noout</b>] [<b>-out</b> <i>file</i>]
[<b>-outform der</b> | <b>pem</b>] [<b>-passin</b>
<i>arg</i>] [<b>-passout</b> <i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>] [<b>-text_pub</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkey</b>
command processes public or private keys. They can be
converted between various forms and their components printed
out.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><i>cipher</i></p>

<p style="margin-left:17%; margin-top: 1em">Encrypt the
private key with the specified cipher. Any algorithm name
accepted by EVP_get_cipherbyname(3) is acceptable, such as
<b>des3</b>.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. If the key is encrypted a
pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified. If any encryption options
are set then a pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read in a
public key, not a private key.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">Output a public key, not a
private key. Automatically set if the input is a public
key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
public/private key in plain text.</p>

<p style="margin-top: 1em"><b>-text_pub</b></p>

<p style="margin-left:17%;">Print out only public key
components even if a private key is being processed.</p>

<p style="margin-top: 1em"><b>PKEYPARAM</b></p>

<p style="margin-left:6%;"><b>openssl pkeyparam</b>
[<b>-in</b> <i>file</i>] [<b>-noout</b>] [<b>-out</b>
<i>file</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>pkeyparam</b> command processes public or private keys.
The key type is determined by the PEM headers.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
parameters in plain text.</p>

<p style="margin-top: 1em"><b>PKEYUTL</b></p>

<p style="margin-left:6%;"><b>openssl pkeyutl</b>
[<b>-asn1parse</b>] [<b>-certin</b>] [<b>-decrypt</b>]
[<b>-derive</b>] [<b>-encrypt</b>] [<b>-hexdump</b>]
[<b>-in</b> <i>file</i>] [<b>-inkey</b> <i>file</i>]
[<b>-keyform der</b> | <b>pem</b>] [<b>-out</b> <i>file</i>]
[<b>-passin</b> <i>arg</i>] [<b>-peerform der</b> |
<b>pem</b>] [<b>-peerkey</b> <i>file</i>] [<b>-pkeyopt</b>
<i>opt</i>:<i>value</i>] [<b>-pubin</b>] [<b>-rev</b>]
[<b>-sigfile</b> <i>file</i>] [<b>-sign</b>]
[<b>-verify</b>] [<b>-verifyrecover</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>pkeyutl</b> command can be used to perform public key
operations using any supported algorithm.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1parse</b></p>

<p style="margin-left:17%;">ASN.1 parse the output data.
This is useful when combined with the <b>-verifyrecover</b>
option when an ASN.1 structure is signed.</p>

<p style="margin-top: 1em"><b>-certin</b></p>

<p style="margin-left:17%;">The input is a certificate
containing a public key.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:17%;">Decrypt the input data using a
private key.</p>

<p style="margin-top: 1em"><b>-derive</b></p>

<p style="margin-left:17%;">Derive a shared secret using
the peer key.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:17%;">Encrypt the input data using a
public key.</p>

<p style="margin-top: 1em"><b>-hexdump</b></p>

<p style="margin-left:17%;">Hex dump the output data.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:17%;">The input key file. By default
it should be a private key.</p>

<p style="margin-top: 1em"><b>-keyform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The key format.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-peerform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The peer key format.</p>

<p style="margin-top: 1em"><b>-peerkey</b> <i>file</i></p>

<p style="margin-left:17%;">The peer key file, used by key
derivation (agreement) operations.</p>

<p style="margin-top: 1em"><b>-pkeyopt</b>
<i>opt</i>:<i>value</i></p>

<p style="margin-left:17%;">Set the public key algorithm
option <i>opt</i> to <i>value</i>. Unless otherwise
mentioned, all algorithms support the format
<i>digest</i>:<i>alg</i>, which specifies the digest to use
for sign, verify, and verifyrecover operations. The value
<i>alg</i> should represent a digest name as used in the
EVP_get_digestbyname(3) function.</p>

<p style="margin-left:17%; margin-top: 1em">The RSA
algorithm supports the encrypt, decrypt, sign, verify, and
verifyrecover operations in general. Some padding modes only
support some of these operations however.</p>


<p style="margin-top: 1em">rsa_padding_mode:<i>mode</i></p>

<p style="margin-left:27%;">This sets the RSA padding mode.
Acceptable values for <i>mode</i> are <b>pkcs1</b> for
PKCS#1 padding; <b>none</b> for no padding; <b>oaep</b> for
OAEP mode; <b>x931</b> for X9.31 mode; and <b>pss</b> for
PSS.</p>

<p style="margin-left:27%; margin-top: 1em">In PKCS#1
padding if the message digest is not set then the supplied
data is signed or verified directly instead of using a
DigestInfo structure. If a digest is set then a DigestInfo
structure is used and its length must correspond to the
digest type. For oeap mode only encryption and decryption is
supported. For x931 if the digest type is set it is used to
format the block data; otherwise the first byte is used to
specify the X9.31 digest ID. Sign, verify, and verifyrecover
can be performed in this mode. For pss mode only sign and
verify are supported and the digest type must be
specified.</p>

<p style="margin-top: 1em">rsa_pss_saltlen:<i>len</i></p>

<p style="margin-left:27%;">For pss mode only this option
specifies the salt length. Two special values are supported:
-1 sets the salt length to the digest length. When signing
-2 sets the salt length to the maximum permissible value.
When verifying -2 causes the salt length to be automatically
determined based on the PSS block structure.</p>

<p style="margin-left:17%; margin-top: 1em">The DSA
algorithm supports the sign and verify operations. Currently
there are no additional options other than <i>digest</i>.
Only the SHA1 digest can be used and this digest is assumed
by default.</p>

<p style="margin-left:17%; margin-top: 1em">The DH
algorithm supports the derive operation and no additional
options.</p>

<p style="margin-left:17%; margin-top: 1em">The EC
algorithm supports the sign, verify, and derive operations.
The sign and verify operations use ECDSA and derive uses
ECDH. Currently there are no additional options other than
<i>digest</i>. Only the SHA1 digest can be used and this
digest is assumed by default.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">The input file
is a public key.</p>

<p style="margin-top: 1em"><b>-rev</b></p>

<p style="margin-left:17%; margin-top: 1em">Reverse the
order of the input buffer.</p>

<p style="margin-top: 1em"><b>-sigfile</b> <i>file</i></p>

<p style="margin-left:17%;">Signature file (verify
operation only).</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:17%; margin-top: 1em">Sign the input
data and output the signed result. This requires a private
key.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the input data against
the signature file and indicate if the verification
succeeded or failed.</p>

<p style="margin-top: 1em"><b>-verifyrecover</b></p>

<p style="margin-left:17%;">Verify the input data and
output the recovered data.</p>

<p style="margin-top: 1em"><b>PRIME</b></p>

<p style="margin-left:6%;"><b>openssl prime</b>
[<b>-bits</b> <i>n</i>] [<b>-checks</b> <i>n</i>]
[<b>-generate</b>] [<b>-hex</b>] [<b>-safe</b>] <i>p</i></p>

<p style="margin-left:6%; margin-top: 1em">The <b>prime</b>
command is used to generate prime numbers, or to check
numbers for primality. Results are probabilistic: they have
an exceedingly high likelihood of being correct, but are not
guaranteed.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-bits</b> <i>n</i></p>

<p style="margin-left:17%;">Specify the number of bits in
the generated prime number. Must be used in conjunction with
<b>-generate</b>.</p>

<p style="margin-top: 1em"><b>-checks</b> <i>n</i></p>

<p style="margin-left:17%;">Perform a Miller-Rabin
probabilistic primality test with <i>n</i> iterations. The
default is 20.</p>

<p style="margin-top: 1em"><b>-generate</b></p>

<p style="margin-left:17%;">Generate a pseudo-random prime
number. Must be used in conjunction with <b>-bits</b>.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Output in hex
format.</p>

<p style="margin-top: 1em"><b>-safe</b></p>

<p style="margin-left:17%; margin-top: 1em">Generate only
&quot;safe&quot; prime numbers (i.e. a prime p so that
(p-1)/2 is also prime).</p>

<p style="margin-top: 1em"><i>p</i></p>

<p style="margin-left:17%; margin-top: 1em">Test if number
<i>p</i> is prime.</p>

<p style="margin-top: 1em"><b>RAND</b></p>

<p style="margin-left:6%;"><b>openssl rand</b>
[<b>-base64</b>] [<b>-hex</b>] [<b>-out</b> <i>file</i>]
<i>num</i></p>

<p style="margin-left:6%; margin-top: 1em">The <b>rand</b>
command outputs <i>num</i> pseudo-random bytes.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-base64</b></p>

<p style="margin-left:17%;">Perform base64 encoding on the
output.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Specify
hexadecimal output.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>REQ</b></p>

<p style="margin-left:6%;"><b>openssl req</b>
[<b>-asn1-kludge</b>] [<b>-batch</b>] [<b>-config</b>
<i>file</i>] [<b>-days</b> <i>n</i>] [<b>-extensions</b>
<i>section</i>] [<b>-in</b> <i>file</i>] [<b>-inform der</b>
| <b>pem</b>] [<b>-key</b> <i>keyfile</i>] [<b>-keyform
der</b> | <b>pem</b>] [<b>-keyout</b> <i>file</i>]
[<b>-md4</b> | <b>-md5</b> | <b>-sha1</b>] [<b>-modulus</b>]
[<b>-nameopt</b> <i>option</i>] [<b>-new</b>]
[<b>-newhdr</b>] [<b>-newkey</b> <i>arg</i>]
[<b>-no-asn1-kludge</b>] [<b>-nodes</b>] [<b>-noout</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> | <b>pem</b>]
[<b>-passin</b> <i>arg</i>] [<b>-passout</b> <i>arg</i>]
[<b>-pubkey</b>] [<b>-reqexts</b> <i>section</i>]
[<b>-reqopt</b> <i>option</i>] [<b>-set_serial</b> <i>n</i>]
[<b>-subj</b> <i>arg</i>] [<b>-subject</b>] [<b>-text</b>]
[<b>-utf8</b>] [<b>-verbose</b>] [<b>-verify</b>]
[<b>-x509</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>req</b>
command primarily creates and processes certificate requests
in PKCS#10 format. It can additionally create self-signed
certificates, for use as root CAs, for example.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1-kludge</b></p>

<p style="margin-left:17%;">Produce requests in an invalid
format for certain picky CAs. Very few CAs still require the
use of this option.</p>

<p style="margin-top: 1em"><b>-batch</b></p>


<p style="margin-left:17%; margin-top: 1em">Non-interactive
mode.</p>

<p style="margin-top: 1em"><b>-config</b> <i>file</i></p>

<p style="margin-left:17%;">Specify an alternative
configuration file.</p>

<p style="margin-top: 1em"><b>-days</b> <i>n</i></p>

<p style="margin-left:17%;">Specify the number of days to
certify the certificate for. The default is 30 days. Used
with the <b>-x509</b> option.</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i>, <b>-reqexts</b> <i>section</i></p>

<p style="margin-left:17%;">Specify alternative sections to
include certificate extensions (with <b>-x509</b>) or
certificate request extensions, allowing several different
sections to be used in the same configuration file.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read a
request from, or standard input if not specified. A request
is only read if the creation options <b>-new</b> and
<b>-newkey</b> are not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The file to read the private
key from. It also accepts PKCS#8 format private keys for PEM
format files.</p>

<p style="margin-top: 1em"><b>-keyform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The format of the private key
file specified in the <b>-key</b> argument. The default is
<b>pem</b>.</p>

<p style="margin-top: 1em"><b>-keyout</b> <i>file</i></p>

<p style="margin-left:17%;">The file to write the newly
created private key to. If this option is not specified, the
filename present in the configuration file is used.</p>

<p style="margin-top: 1em"><b>-md5</b> | <b>-sha1</b> |
<b>-sha256</b></p>

<p style="margin-left:17%;">The message digest to sign the
request with. This overrides the digest algorithm specified
in the configuration file.</p>

<p style="margin-left:17%; margin-top: 1em">Some public key
algorithms may override this choice. For instance, DSA
signatures always use SHA1.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">Print the value of the modulus
of the public key contained in the request.</p>

<p style="margin-top: 1em"><b>-nameopt</b> <i>option</i>,
<b>-reqopt</b> <i>option</i></p>

<p style="margin-left:17%;">Determine how the subject or
issuer names are displayed. <i>option</i> can be a single
option or multiple options separated by commas.
Alternatively, these options may be used more than once to
set multiple options. See the <i>X509</i> section below for
details.</p>

<p style="margin-top: 1em"><b>-new</b></p>

<p style="margin-left:17%; margin-top: 1em">Generate a new
certificate request. The user is prompted for the relevant
field values. The actual fields prompted for and their
maximum and minimum sizes are specified in the configuration
file and any requested extensions.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<b>-key</b> option is not used, it will generate a new RSA
private key using information specified in the configuration
file.</p>

<p style="margin-top: 1em"><b>-newhdr</b></p>

<p style="margin-left:17%;">Add the word NEW to the PEM
file header and footer lines on the outputed request. Some
software and CAs need this.</p>

<p style="margin-top: 1em"><b>-newkey</b> <i>arg</i></p>

<p style="margin-left:17%;">Create a new certificate
request and a new private key. The argument takes one of
several forms.</p>


<p style="margin-left:17%; margin-top: 1em">rsa:<i>nbits</i>
generates an RSA key <i>nbits</i> in size. If <i>nbits</i>
is omitted the default key size is used.</p>


<p style="margin-left:17%; margin-top: 1em">dsa:<i>file</i>
generates a DSA key using the parameters in <i>file</i>.</p>


<p style="margin-left:17%; margin-top: 1em">param:<i>file</i>
generates a key using the parameters or certificate in
<i>file</i>.</p>

<p style="margin-left:17%; margin-top: 1em">All other
algorithms support the form <i>algorithm</i>:<i>file</i>,
where file may be an algorithm parameter file, created by
the <b>genpkey -genparam</b> command or an X.509 certificate
for a key with appropriate algorithm. <i>file</i> can be
omitted, in which case any parameters can be specified via
the <b>-pkeyopt</b> option.</p>

<p style="margin-top: 1em"><b>-no-asn1-kludge</b></p>

<p style="margin-left:17%;">Reverse the effect of
<b>-asn1-kludge</b>.</p>

<p style="margin-top: 1em"><b>-nodes</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not encrypt
the private key.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the request.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not spceified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:17%;">Output the public key.</p>

<p style="margin-top: 1em"><b>-reqopt</b> <i>option</i></p>

<p style="margin-left:17%;">Customise the output format
used with <b>-text</b>. The <i>option</i> argument can be a
single option or multiple options separated by commas. See
also the discussion of <b>-certopt</b> in the <b>x509</b>
command.</p>

<p style="margin-top: 1em"><b>-set_serial</b> <i>n</i></p>

<p style="margin-left:17%;">Serial number to use when
outputting a self-signed certificate. This may be specified
as a decimal value or a hex value if preceded by
&rsquo;0x&rsquo;. It is possible to use negative serial
numbers but this is not recommended.</p>

<p style="margin-top: 1em"><b>-subj</b> <i>arg</i></p>

<p style="margin-left:17%;">Replaces the subject field of
an input request with the specified data and output the
modified request. <i>arg</i> must be formatted as
/type0=value0/type1=value1/type2=...; characters may be
escaped by &rsquo;\&rsquo; (backslash); no spaces are
skipped.</p>

<p style="margin-top: 1em"><b>-subject</b></p>

<p style="margin-left:17%;">Print the request subject (or
certificate subject if <b>-x509</b> is specified).</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
certificate request in plain text.</p>

<p style="margin-top: 1em"><b>-utf8</b></p>

<p style="margin-left:17%; margin-top: 1em">Interpret field
values as UTF8 strings, not ASCII.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:17%;">Print extra details about the
operations being performed.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the signature on the
request.</p>

<p style="margin-top: 1em"><b>-x509</b></p>

<p style="margin-left:17%; margin-top: 1em">Output a
self-signed certificate instead of a certificate request.
This is typically used to generate a test certificate or a
self-signed root CA. The extensions added to the certificate
(if any) are specified in the configuration file. Unless
specified using the <b>-set_serial</b> option, 0 is used for
the serial number.</p>

<p style="margin-left:6%; margin-top: 1em">The
configuration options are specified in the &quot;req&quot;
section of the configuration file. The options available are
as follows:</p>

<p style="margin-top: 1em"><b>attributes</b></p>

<p style="margin-left:14%;">The section containing any
request attributes: its format is the same as
<b>distinguished_name</b>. Typically these may contain the
challengePassword or unstructuredName types. They are
currently ignored by the <b>openssl</b> request signing
utilities, but some CAs might want them.</p>

<p style="margin-top: 1em"><b>default_bits</b></p>

<p style="margin-left:14%;">The default key size, in bits.
The default is 2048. It is used if the <b>-new</b> option is
used and can be overridden by using the <b>-newkey</b>
option.</p>

<p style="margin-top: 1em"><b>default_keyfile</b></p>

<p style="margin-left:14%;">The default file to write a
private key to, or standard output if not specified. It can
be overridden by the <b>-keyout</b> option.</p>

<p style="margin-top: 1em"><b>default_md</b></p>

<p style="margin-left:14%;">The digest algorithm to use.
Possible values include <b>md5</b>, <b>sha1</b> and
<b>sha256</b> (the default). It can be overridden on the
command line.</p>

<p style="margin-top: 1em"><b>distinguished_name</b></p>

<p style="margin-left:14%;">The section containing the
distinguished name fields to prompt for when generating a
certificate or certificate request. The format is described
below.</p>

<p style="margin-top: 1em"><b>encrypt_key</b></p>

<p style="margin-left:14%;">If set to &quot;no&quot; and a
private key is generated, it is not encrypted. It is
equivalent to the <b>-nodes</b> option. For compatibility,
<b>encrypt_rsa_key</b> is an equivalent option.</p>

<p style="margin-top: 1em"><b>input_password</b> |
<b>output_password</b></p>

<p style="margin-left:14%;">The passwords for the input
private key file (if present) and the output private key
file (if one will be created). The command line options
<b>-passin</b> and <b>-passout</b> override the
configuration file values.</p>

<p style="margin-top: 1em"><b>oid_file</b></p>

<p style="margin-left:14%;">A file containing additional
OBJECT IDENTIFIERS. Each line of the file should consist of
the numerical form of the object identifier, followed by
whitespace, then the short name followed by whitespace and
finally the long name.</p>

<p style="margin-top: 1em"><b>oid_section</b></p>

<p style="margin-left:14%;">Specify a section in the
configuration file containing extra object identifiers. Each
line should consist of the short name of the object
identifier followed by &rsquo;=&rsquo; and the numerical
form. The short and long names are the same when this option
is used.</p>

<p style="margin-top: 1em"><b>prompt</b></p>

<p style="margin-left:14%;">If set to &quot;no&quot;, it
disables prompting of certificate fields and just takes
values from the config file directly. It also changes the
expected format of the <b>distinguished_name</b> and
<b>attributes</b> sections.</p>

<p style="margin-top: 1em"><b>req_extensions</b></p>

<p style="margin-left:14%;">The configuration file section
containing a list of extensions to add to the certificate
request. It can be overridden by the <b>-reqexts</b>
option.</p>

<p style="margin-top: 1em"><b>string_mask</b></p>

<p style="margin-left:14%;">Limit the string types for
encoding certain fields. The following values may be used,
limiting strings to the indicated types:</p>

<p style="margin-top: 1em"><b>utf8only</b></p>

<p style="margin-left:31%; margin-top: 1em">UTF8String.
This is the default, as recommended by PKIX in RFC 2459.</p>

<p style="margin-top: 1em"><b>default</b></p>


<p style="margin-left:31%; margin-top: 1em">PrintableString,
IA5String, T61String, BMPString, UTF8String.</p>

<p style="margin-top: 1em"><b>pkix</b></p>


<p style="margin-left:31%; margin-top: 1em">PrintableString,
IA5String, BMPString, UTF8String. Inspired by the PKIX
recommendation in RFC 2459 for certificates generated before
2004, but differs by also permitting IA5String.</p>

<p style="margin-top: 1em"><b>nombstr</b></p>


<p style="margin-left:31%; margin-top: 1em">PrintableString,
IA5String, T61String, UniversalString. A workaround for some
ancient software that had problems with the variable-sized
BMPString and UTF8String types.</p>

<p style="margin-top: 1em"><b>MASK</b>:<i>number</i></p>

<p style="margin-left:31%; margin-top: 1em">An explicit
bitmask of permitted types, where <i>number</i> is a C-style
hex, decimal, or octal number that&rsquo;s a bit-wise OR of
B_ASN1_* values from &lt;<i>openssl/asn1.h</i>&gt;.</p>

<p style="margin-top: 1em"><b>utf8</b></p>

<p style="margin-left:14%; margin-top: 1em">If set to
&quot;yes&quot;, field values are interpreted as UTF8
strings.</p>

<p style="margin-top: 1em"><b>x509_extensions</b></p>

<p style="margin-left:14%;">The configuration file section
containing a list of extensions to add to a certificate
generated when the <b>-x509</b> switch is used. It can be
overridden by the <b>-extensions</b> command line
switch.</p>

<p style="margin-left:6%; margin-top: 1em">There are two
separate formats for the distinguished name and attribute
sections. If the <b>-prompt</b> option is set to
&quot;no&quot;, then these sections just consist of field
names and values. If the <b>-prompt</b> option is absent or
not set to &quot;no&quot;, then the file contains field
prompting information of the form:</p>


<p style="margin-left:14%; margin-top: 1em">fieldName=&quot;prompt&quot;
<br>
fieldName_default=&quot;default field value&quot; <br>
fieldName_min= 2 <br>
fieldName_max= 4</p>


<p style="margin-left:6%; margin-top: 1em">&quot;fieldName&quot;
is the field name being used, for example <b>commonName</b>
(or CN). The &quot;prompt&quot; string is used to ask the
user to enter the relevant details. If the user enters
nothing, the default value is used; if no default value is
present, the field is omitted. A field can still be omitted
if a default value is present, if the user just enters the
&rsquo;.&rsquo; character.</p>

<p style="margin-left:6%; margin-top: 1em">The number of
characters entered must be between the fieldName_min and
fieldName_max limits: there may be additional restrictions
based on the field being used (for example
<b>countryName</b> can only ever be two characters long and
must fit in a <b>PrintableString</b>).</p>

<p style="margin-left:6%; margin-top: 1em">Some fields
(such as <b>organizationName</b>) can be used more than once
in a DN. This presents a problem because configuration files
will not recognize the same name occurring twice. To avoid
this problem, if the <b>fieldName</b> contains some
characters followed by a full stop, they will be ignored.
So, for example, a second <b>organizationName</b> can be
input by calling it &quot;1.organizationName&quot;.</p>

<p style="margin-left:6%; margin-top: 1em">The actual
permitted field names are any object identifier short or
long names. These are compiled into <b>openssl</b> and
include the usual values such as <b>commonName</b>,
<b>countryName</b>, <b>localityName</b>,
<b>organizationName</b>, <b>organizationalUnitName</b>,
<b>stateOrProvinceName</b>. Additionally,
<b>emailAddress</b> is included as well as <b>name</b>,
<b>surname</b>, <b>givenName</b>, <b>initials</b> and
<b>dnQualifier</b>.</p>

<p style="margin-left:6%; margin-top: 1em">Additional
object identifiers can be defined with the <b>oid_file</b>
or <b>oid_section</b> options in the configuration file. Any
additional fields will be treated as though they were a
<b>DirectoryString</b>.</p>

<p style="margin-top: 1em"><b>RSA</b></p>

<p style="margin-left:6%;"><b>openssl rsa</b>
[<b>-aes128</b> | <b>-aes192</b> | <b>-aes256</b> |
<b>-des</b> | <b>-des3</b>] [<b>-check</b>] [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>net</b> | <b>pem</b>]
[<b>-modulus</b>] [<b>-noout</b>] [<b>-out</b> <i>file</i>]
[<b>-outform der</b> | <b>net</b> | <b>pem</b>]
[<b>-passin</b> <i>arg</i>] [<b>-passout</b> <i>arg</i>]
[<b>-pubin</b>] [<b>-pubout</b>] [<b>-sgckey</b>]
[<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>rsa</b>
command processes RSA keys. They can be converted between
various forms and their components printed out. <b>rsa</b>
uses the traditional <b>SSLeay</b> compatible format for
private key encryption: newer applications should use the
more secure PKCS#8 format using the <b>pkcs8</b>
utility.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">Encrypt the private key with
the AES, DES, or the triple DES ciphers, respectively,
before outputting it. A pass phrase is prompted for. If none
of these options are specified, the key is written in plain
text. This means that using the <b>rsa</b> utility to read
in an encrypted key with no encryption option can be used to
remove the pass phrase from a key, or by setting the
encryption options it can be used to add or change the pass
phrase. These options can only be used with PEM format
output files.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">Check the
consistency of an RSA private key.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. If the key is encrypted, a
pass phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform der</b> | <b>net</b>
| <b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">Print the value of the modulus
of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> | <b>net</b>
| <b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read in a
public key, not a private key.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">Output a public key, not a
private key. Automatically set if the input is a public
key.</p>

<p style="margin-top: 1em"><b>-sgckey</b></p>

<p style="margin-left:17%;">Use the modified NET algorithm
used with some versions of Microsoft IIS and SGC keys.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
public/private key components in plain text.</p>

<p style="margin-top: 1em"><b>RSAUTL</b></p>

<p style="margin-left:6%;"><b>openssl rsautl</b>
[<b>-asn1parse</b>] [<b>-certin</b>] [<b>-decrypt</b>]
[<b>-encrypt</b>] [<b>-hexdump</b>] [<b>-in</b> <i>file</i>]
[<b>-inkey</b> <i>file</i>] [<b>-keyform der</b> |
<b>pem</b>] [<b>-oaep</b> | <b>-pkcs</b> | <b>-raw</b>]
[<b>-out</b> <i>file</i>] [<b>-pubin</b>] [<b>-sign</b>]
[<b>-verify</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>rsautl</b> command can be used to sign, verify, encrypt
and decrypt data using the RSA algorithm.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1parse</b></p>

<p style="margin-left:17%;">Asn1parse the output data; this
is useful when combined with the <b>-verify</b> option.</p>

<p style="margin-top: 1em"><b>-certin</b></p>

<p style="margin-left:17%;">The input is a certificate
containing an RSA public key.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:17%;">Decrypt the input data using an
RSA private key.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:17%;">Encrypt the input data using an
RSA public key.</p>

<p style="margin-top: 1em"><b>-hexdump</b></p>

<p style="margin-left:17%;">Hex dump the output data.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:17%;">The input key file; by default
an RSA private key.</p>

<p style="margin-top: 1em"><b>-keyform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The private key format. The
default is <b>pem</b>.</p>

<p style="margin-top: 1em"><b>-oaep</b> | <b>-pkcs</b> |
<b>-raw</b></p>

<p style="margin-left:17%;">The padding to use: PKCS#1
OAEP, PKCS#1 v1.5 (the default), or no padding,
respectively. For signatures, only <b>-pkcs</b> and
<b>-raw</b> can be used.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">The input file
is an RSA public key.</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:17%; margin-top: 1em">Sign the input
data and output the signed result. This requires an RSA
private key.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the input data and
output the recovered data.</p>

<p style="margin-top: 1em"><b>S_CLIENT</b></p>

<p style="margin-left:6%;"><b>openssl s_client</b>
[<b>-4</b> | <b>-6</b>] [<b>-bugs</b>] [<b>-CAfile</b>
<i>file</i>] [<b>-CApath</b> <i>directory</i>] [<b>-cert</b>
<i>file</i>] [<b>-check_ss_sig</b>] [<b>-cipher</b>
<i>cipherlist</i>] [<b>-connect</b>
<i>host</i>[:<i>port</i>]] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-crlf</b>] [<b>-debug</b>]
[<b>-extended_crl</b>] [<b>-groups</b>] [<b>-ign_eof</b>]
[<b>-ignore_critical</b>] [<b>-issuer_checks</b>]
[<b>-key</b> <i>keyfile</i>] [<b>-msg</b>] [<b>-nbio</b>]
[<b>-nbio_test</b>] [<b>-no_ticket</b>] [<b>-no_tls1</b>]
[<b>-no_tls1_1</b>] [<b>-no_tls1_2</b>] [<b>-pause</b>]
[<b>-policy_check</b>] [<b>-prexit</b>] [<b>-proxy</b>
<i>host</i>:<i>port</i>] [<b>-psk</b> <i>key</i>]
[<b>-psk_identity</b> <i>identity</i>] [<b>-quiet</b>]
[<b>-reconnect</b>] [<b>-servername</b> <i>name</i>]
[<b>-showcerts</b>] [<b>-starttls</b> <i>protocol</i>]
[<b>-state</b>] [<b>-tls1</b>] [<b>-tls1_1</b>]
[<b>-tls1_2</b>] [<b>-tlsextdebug</b>] [<b>-verify</b>
<i>depth</i>] [<b>-x509_strict</b>] [<b>-xmpphost</b>
<i>host</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_client</b> command implements a generic SSL/TLS client
which connects to a remote host using SSL/TLS.</p>

<p style="margin-left:6%; margin-top: 1em">If a connection
is established with an SSL server, any data received from
the server is displayed and any key presses will be sent to
the server. When used interactively (which means neither
<b>-quiet</b> nor <b>-ign_eof</b> have been given), the
session will be renegotiated if the line begins with an
<b>R</b>; if the line begins with a <b>Q</b> or if end of
file is reached, the connection will be closed down.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-4</b></p>

<p style="margin-left:17%; margin-top: 1em">Attempt
connections using IPv4 only.</p>

<p style="margin-top: 1em"><b>-6</b></p>

<p style="margin-left:17%; margin-top: 1em">Attempt
connections using IPv6 only.</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">Enable various
workarounds for buggy implementations.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> containing
trusted certificates to use during server authentication and
to use when attempting to build the client certificate
chain.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The <i>directory</i> to use for
server certificate verification. This directory must be in
&quot;hash format&quot;; see <b>-verify</b> for more
information. These are also used when building the client
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use, if one
is requested by the server. The default is not to use a
certificate.</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b>,
<b>-crl_check</b>, <b>-crl_check_all</b>,
<b>-extended_crl</b>, <b>-ignore_critical</b>,
<b>-issuer_checks</b>, <b>-policy_check</b>,
<b>-x509_strict</b></p>

<p style="margin-left:17%;">Set various certificate chain
validation options. See the <b>verify</b> command for
details.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">Modify the cipher list sent by
the client. Although the server determines which cipher
suite is used, it should take the first supported cipher in
the list sent by the client. See the <b>ciphers</b> command
for more information.</p>

<p style="margin-top: 1em"><b>-connect</b>
<i>host</i>[:<i>port</i>]</p>

<p style="margin-left:17%;">The <i>host</i> and <i>port</i>
to connect to. If not specified, an attempt is made to
connect to the local host on port 4433. Alternatively, the
host and port pair may be separated using a forward-slash
character, which is useful for numeric IPv6 addresses.</p>

<p style="margin-top: 1em"><b>-crlf</b></p>

<p style="margin-left:17%; margin-top: 1em">Translate a
line feed from the terminal into CR+LF, as required by some
servers.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Print extensive
debugging information, including a hex dump of all
traffic.</p>

<p style="margin-top: 1em"><b>-groups</b>
<i>ecgroups</i></p>

<p style="margin-left:17%;">Specify a colon-separated list
of permitted EC curve groups.</p>

<p style="margin-top: 1em"><b>-ign_eof</b></p>

<p style="margin-left:17%;">Inhibit shutting down the
connection when end of file is reached in the input.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used.</p>

<p style="margin-top: 1em"><b>-msg</b></p>

<p style="margin-left:17%; margin-top: 1em">Show all
protocol messages with hex dump.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turn on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-nbio_test</b></p>

<p style="margin-left:17%;">Test non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-no_tls1</b> |
<b>-no_tls1_1</b> | <b>-no_tls1_2</b></p>

<p style="margin-left:17%;">Disable the use of TLS1.0, 1.1,
and 1.2, respectively.</p>

<p style="margin-top: 1em"><b>-no_ticket</b></p>

<p style="margin-left:17%;">Disable RFC 4507 session ticket
support.</p>

<p style="margin-top: 1em"><b>-pause</b></p>

<p style="margin-left:17%; margin-top: 1em">Pause 1 second
between each read and write call.</p>

<p style="margin-top: 1em"><b>-prexit</b></p>

<p style="margin-left:17%;">Print session information when
the program exits. This will always attempt to print out
information even if the connection fails. Normally,
information will only be printed out once if the connection
succeeds. This option is useful because the cipher in use
may be renegotiated or the connection may fail because a
client certificate is required or is requested only after an
attempt is made to access a certain URL. Note that the
output produced by this option is not always accurate
because a connection might never have been established.</p>

<p style="margin-top: 1em"><b>-proxy</b>
<i>host</i>:<i>port</i></p>

<p style="margin-left:17%;">Use the HTTP proxy at
<i>host</i> and <i>port</i>. The connection to the proxy is
done in cleartext and the <b>-connect</b> argument is given
to the proxy. If not specified, localhost is used as final
destination. After that, switch the connection through the
proxy to the destination to TLS.</p>

<p style="margin-top: 1em"><b>-psk</b> <i>key</i></p>

<p style="margin-left:17%;">Use the PSK key <i>key</i> when
using a PSK cipher suite. The key is given as a hexadecimal
number without the leading 0x, for example -psk
1a2b3c4d.</p>

<p style="margin-top: 1em"><b>-psk_identity</b>
<i>identity</i></p>

<p style="margin-left:17%;">Use the PSK <i>identity</i>
when using a PSK cipher suite.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Inhibit
printing of session and certificate information. This
implicitly turns on <b>-ign_eof</b> as well.</p>

<p style="margin-top: 1em"><b>-reconnect</b></p>

<p style="margin-left:17%;">Reconnect to the same server 5
times using the same session ID; this can be used as a test
that session caching is working.</p>

<p style="margin-top: 1em"><b>-servername</b>
<i>name</i></p>

<p style="margin-left:17%;">Include the TLS Server Name
Indication (SNI) extension in the ClientHello message, using
the specified server <i>name</i>.</p>

<p style="margin-top: 1em"><b>-showcerts</b></p>

<p style="margin-left:17%;">Display the whole server
certificate chain: normally only the server certificate
itself is displayed.</p>

<p style="margin-top: 1em"><b>-starttls</b>
<i>protocol</i></p>

<p style="margin-left:17%;">Send the protocol-specific
messages to switch to TLS for communication. <i>protocol</i>
is a keyword for the intended protocol. Currently, the
supported keywords are &quot;ftp&quot;, &quot;imap&quot;,
&quot;smtp&quot;, &quot;pop3&quot;, and
&quot;xmpp&quot;.</p>

<p style="margin-top: 1em"><b>-state</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the SSL
session states.</p>

<p style="margin-top: 1em"><b>-tls1</b> | <b>-tls1_1</b> |
<b>-tls1_2</b></p>

<p style="margin-left:17%;">Permit only TLS1.0, 1.1, or
1.2, respectively.</p>

<p style="margin-top: 1em"><b>-tlsextdebug</b></p>

<p style="margin-left:17%;">Print a hex dump of any TLS
extensions received from the server.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">Turn on server certificate
verification, with a maximum length of <i>depth</i>.
Currently the verify operation continues after errors so all
the problems with a certificate chain can be seen. As a side
effect the connection will never fail due to a server
certificate verify failure.</p>

<p style="margin-top: 1em"><b>-xmpphost</b>
<i>hostname</i></p>

<p style="margin-left:17%;">When used with <b>-starttls</b>
<i>xmpp</i>, specify the host for the &quot;to&quot;
attribute of the stream element. If this option is not
specified then the host specified with <b>-connect</b> will
be used.</p>

<p style="margin-top: 1em"><b>S_SERVER</b></p>

<p style="margin-left:6%;"><b>openssl s_server</b>
[<b>-accept</b> <i>port</i>] [<b>-bugs</b>] [<b>-CAfile</b>
<i>file</i>] [<b>-CApath</b> <i>directory</i>] [<b>-cert</b>
<i>file</i>] [<b>-cipher</b> <i>cipherlist</i>]
[<b>-context</b> <i>id</i>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-crlf</b>] [<b>-dcert</b>
<i>file</i>] [<b>-debug</b>] [<b>-dhparam</b> <i>file</i>]
[<b>-dkey</b> <i>file</i>] [<b>-hack</b>] [<b>-HTTP</b>]
[<b>-id_prefix</b> <i>arg</i>] [<b>-key</b> <i>keyfile</i>]
[<b>-msg</b>] [<b>-nbio</b>] [<b>-nbio_test</b>]
[<b>-no_dhe</b>] [<b>-no_tls1</b>] [<b>-no_tls1_1</b>]
[<b>-no_tls1_2</b>] [<b>-no_tmp_rsa</b>] [<b>-nocert</b>]
[<b>-psk</b> <i>key</i>] [<b>-psk_hint</b> <i>hint</i>]
[<b>-quiet</b>] [<b>-serverpref</b>] [<b>-state</b>]
[<b>-tls1</b>] [<b>-tls1_1</b>] [<b>-tls1_2</b>]
[<b>-Verify</b> <i>depth</i>] [<b>-verify</b> <i>depth</i>]
[<b>-WWW</b>] [<b>-www</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_server</b> command implements a generic SSL/TLS server
which listens for connections on a given port using
SSL/TLS.</p>

<p style="margin-left:6%; margin-top: 1em">If a connection
request is established with a client and neither the
<b>-www</b> nor the <b>-WWW</b> option has been used, then
any data received from the client is displayed and any key
presses are sent to the client. Certain single letter
commands perform special operations:</p>

<p style="margin-top: 1em"><b>P</b></p>

<p style="margin-left:14%; margin-top: 1em">Send plain
text, which should cause the client to disconnect.</p>

<p><b>Q</b></p>

<p style="margin-left:14%; margin-top: 1em">End the current
SSL connection and exit.</p>

<p><b>q</b></p>

<p style="margin-left:14%; margin-top: 1em">End the current
SSL connection, but still accept new connections.</p>

<p><b>R</b></p>

<p style="margin-left:14%; margin-top: 1em">Renegotiate the
SSL session and request a client certificate.</p>

<p><b>r</b></p>

<p style="margin-left:14%; margin-top: 1em">Renegotiate the
SSL session.</p>

<p><b>S</b></p>

<p style="margin-left:14%; margin-top: 1em">Print out some
session cache status information.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-accept</b> <i>port</i></p>

<p style="margin-left:17%;">Listen on TCP <i>port</i> for
connections. The default is port 4433.</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">Enable various
workarounds for buggy implementations.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> containing
trusted certificates to use during client authentication and
to use when attempting to build the server certificate
chain. The list is also used in the list of acceptable
client CAs passed to the client when a certificate is
requested.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The <i>directory</i> to use for
client certificate verification. This directory must be in
&quot;hash format&quot;; see <b>-verify</b> for more
information. These are also used when building the server
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use: most
server&rsquo;s cipher suites require the use of a
certificate and some require a certificate with a certain
public key type. For example, the DSS cipher suites require
a certificate containing a DSS (DSA) key. If not specified,
the file <i>server.pem</i> will be used.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">Modify the cipher list used by
the server. This allows the cipher list used by the server
to be modified. When the client sends a list of supported
ciphers, the first client cipher also included in the server
list is used. Because the client specifies the preference
order, the order of the server cipherlist is irrelevant. See
the <b>ciphers</b> command for more information.</p>

<p style="margin-top: 1em"><b>-context</b> <i>id</i></p>

<p style="margin-left:17%;">Set the SSL context ID. It can
be given any string value.</p>

<p style="margin-top: 1em"><b>-crl_check</b>,
<b>-crl_check_all</b></p>

<p style="margin-left:17%;">Check the peer certificate has
not been revoked by its CA. The CRLs are appended to the
certificate file. <b>-crl_check_all</b> checks all CRLs of
all CAs in the chain.</p>

<p style="margin-top: 1em"><b>-crlf</b></p>

<p style="margin-left:17%; margin-top: 1em">Translate a
line feed from the terminal into CR+LF.</p>

<p style="margin-top: 1em"><b>-dcert</b> <i>file</i>,
<b>-dkey</b> <i>file</i></p>

<p style="margin-left:17%;">Specify an additional
certificate and private key; these behave in the same manner
as the <b>-cert</b> and <b>-key</b> options except there is
no default if they are not specified (no additional
certificate or key is used). By using RSA and DSS
certificates and keys, a server can support clients which
only support RSA or DSS cipher suites by using an
appropriate certificate.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Print extensive
debugging information, including a hex dump of all
traffic.</p>

<p style="margin-top: 1em"><b>-dhparam</b> <i>file</i></p>

<p style="margin-left:17%;">The DH parameter file to use.
The ephemeral DH cipher suites generate keys using a set of
DH parameters. If not specified, an attempt is made to load
the parameters from the server certificate file. If this
fails, a static set of parameters hard coded into the
<b>s_server</b> program will be used.</p>

<p style="margin-top: 1em"><b>-hack</b></p>

<p style="margin-left:17%; margin-top: 1em">Enables a
further workaround for some early Netscape SSL code.</p>

<p style="margin-top: 1em"><b>-HTTP</b></p>

<p style="margin-left:17%; margin-top: 1em">Emulate a
simple web server. Pages are resolved relative to the
current directory. For example if the URL
<i>https://myhost/page.html</i> is requested, the file
<i>./page.html</i> will be loaded. The files loaded are
assumed to contain a complete and correct HTTP response
(lines that are part of the HTTP response line and headers
must end with CRLF).</p>

<p style="margin-top: 1em"><b>-id_prefix</b> <i>arg</i></p>

<p style="margin-left:17%;">Generate SSL/TLS session IDs
prefixed by <i>arg</i>. This is mostly useful for testing
any SSL/TLS code that wish to deal with multiple servers,
when each of which might be generating a unique range of
session IDs.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used.</p>

<p style="margin-top: 1em"><b>-msg</b></p>

<p style="margin-left:17%; margin-top: 1em">Show all
protocol messages with hex dump.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turn on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-nbio_test</b></p>

<p style="margin-left:17%;">Test non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-no_dhe</b></p>

<p style="margin-left:17%;">Disable ephemeral DH cipher
suites.</p>

<p style="margin-top: 1em"><b>-no_tls1</b> |
<b>-no_tls1_1</b> | <b>-no_tls1_2</b></p>

<p style="margin-left:17%;">Disable the use of TLS1.0, 1.1,
and 1.2, respectively.</p>

<p style="margin-top: 1em"><b>-no_tmp_rsa</b></p>

<p style="margin-left:17%;">Disable temporary RSA key
generation.</p>

<p style="margin-top: 1em"><b>-nocert</b></p>

<p style="margin-left:17%;">Do not use a certificate. This
restricts the cipher suites available to the anonymous ones
(currently just anonymous DH).</p>

<p style="margin-top: 1em"><b>-psk</b> <i>key</i></p>

<p style="margin-left:17%;">Use the PSK key <i>key</i> when
using a PSK cipher suite. The key is given as a hexadecimal
number without the leading 0x, for example -psk
1a2b3c4d.</p>

<p style="margin-top: 1em"><b>-psk_hint</b> <i>hint</i></p>

<p style="margin-left:17%;">Use the PSK identity hint
<i>hint</i> when using a PSK cipher suite.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Inhibit
printing of session and certificate information.</p>

<p style="margin-top: 1em"><b>-serverpref</b></p>

<p style="margin-left:17%;">Use server&rsquo;s cipher
preferences.</p>

<p style="margin-top: 1em"><b>-state</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the SSL
session states.</p>

<p style="margin-top: 1em"><b>-tls1</b> | <b>-tls1_1</b> |
<b>-tls1_2</b></p>

<p style="margin-left:17%;">Permit only TLS1.0, 1.1, or
1.2, respectively.</p>

<p style="margin-top: 1em"><b>-WWW</b></p>

<p style="margin-left:17%; margin-top: 1em">Emulate a
simple web server. Pages are resolved relative to the
current directory. For example if the URL
<i>https://myhost/page.html</i> is requested, the file
<i>./page.html</i> will be loaded.</p>

<p style="margin-top: 1em"><b>-www</b></p>

<p style="margin-left:17%; margin-top: 1em">Send a status
message to the client when it connects, including
information about the ciphers used and various session
parameters. The output is in HTML format so this option will
normally be used with a web browser.</p>

<p style="margin-top: 1em"><b>-Verify</b> <i>depth</i>,
<b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">Request a certificate chain
from the client, with a maximum length of <i>depth</i>. With
<b>-Verify</b>, the client must supply a certificate or an
error occurs; with <b>-verify</b>, a certificate is
requested but the client does not have to send one.</p>

<p style="margin-top: 1em"><b>S_TIME</b></p>

<p style="margin-left:6%;"><b>openssl s_time</b>
[<b>-bugs</b>] [<b>-CAfile</b> <i>file</i>] [<b>-CApath</b>
<i>directory</i>] [<b>-cert</b> <i>file</i>] [<b>-cipher</b>
<i>cipherlist</i>] [<b>-connect</b>
<i>host</i>[:<i>port</i>]] [<b>-key</b> <i>keyfile</i>]
[<b>-nbio</b>] [<b>-new</b>] [<b>-no_shutdown</b>]
[<b>-reuse</b>] [<b>-time</b> <i>seconds</i>]
[<b>-verify</b> <i>depth</i>] [<b>-www</b> <i>page</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_time</b> command implements a generic SSL/TLS client
which connects to a remote host using SSL/TLS. It can
request a page from the server and includes the time to
transfer the payload data in its timing measurements. It
measures the number of connections within a given timeframe,
the amount of data transferred (if any), and calculates the
average time spent for one connection.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">Enable various
workarounds for buggy implementations.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> containing
trusted certificates to use during server authentication and
to use when attempting to build the client certificate
chain.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The directory to use for server
certificate verification. This directory must be in
&quot;hash format&quot;; see <b>verify</b> for more
information. These are also used when building the client
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use, if one
is requested by the server. The default is not to use a
certificate.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">Modify the cipher list sent by
the client. Although the server determines which cipher
suite is used, it should take the first supported cipher in
the list sent by the client. See the <b>ciphers</b> command
for more information.</p>

<p style="margin-top: 1em"><b>-connect</b>
<i>host</i>[:<i>port</i>]</p>

<p style="margin-left:17%;">The host and port to connect
to.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turn on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-new</b></p>

<p style="margin-left:17%; margin-top: 1em">Perform the
timing test using a new session ID for each connection. If
neither <b>-new</b> nor <b>-reuse</b> are specified, they
are both on by default and executed in sequence.</p>

<p style="margin-top: 1em"><b>-no_shutdown</b></p>

<p style="margin-left:17%;">Shut down the connection
without sending a &quot;close notify&quot; shutdown alert to
the server.</p>

<p style="margin-top: 1em"><b>-reuse</b></p>

<p style="margin-left:17%; margin-top: 1em">Perform the
timing test using the same session ID for each connection.
If neither <b>-new</b> nor <b>-reuse</b> are specified, they
are both on by default and executed in sequence.</p>

<p style="margin-top: 1em"><b>-time</b> <i>seconds</i></p>

<p style="margin-left:17%;">Limit <b>s_time</b> benchmarks
to the number of <i>seconds</i>. The default is 30
seconds.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">Turn on server certificate
verification, with a maximum length of <i>depth</i>.
Currently the verify operation continues after errors, so
all the problems with a certificate chain can be seen. As a
side effect, the connection will never fail due to a server
certificate verify failure.</p>

<p style="margin-top: 1em"><b>-www</b> <i>page</i></p>

<p style="margin-left:17%;">The page to GET from the
server. A value of &rsquo;/&rsquo; gets the index.htm[l]
page. If this parameter is not specified, <b>s_time</b> will
only perform the handshake to establish SSL connections but
not transfer any payload data.</p>

<p style="margin-top: 1em"><b>SESS_ID</b></p>

<p style="margin-left:6%;"><b>openssl sess_id</b>
[<b>-cert</b>] [<b>-context</b> <i>ID</i>] [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>sess_id</b> program processes the encoded version of the
SSL session structure and optionally prints out SSL session
details (for example the SSL session master key) in
human-readable format.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-cert</b></p>

<p style="margin-left:17%; margin-top: 1em">If a
certificate is present in the session, it will be output
using this option; if the <b>-text</b> option is also
present, then it will be printed out in text form.</p>

<p style="margin-top: 1em"><b>-context</b> <i>ID</i></p>

<p style="margin-left:17%;">Set the session <i>ID</i>. The
ID can be any string of characters.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format. <b>der</b>
uses an ASN.1 DER-encoded format containing session details.
The precise format can vary from one version to the next.
<b>pem</b> is the default format: it consists of the DER
format base64-encoded with additional header and footer
lines.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the session.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print the
various public or private key components in plain text, in
addition to the encoded version.</p>

<p style="margin-left:6%; margin-top: 1em">The output of
<b>sess_id</b> is composed as follows:</p>

<p style="margin-top: 1em">Protocol</p>

<p style="margin-left:37%; margin-top: 1em">The protocol in
use.</p>

<p>Cipher</p>

<p style="margin-left:37%; margin-top: 1em">The actual raw
SSL or TLS cipher code.</p>

<p>Session-ID</p>

<p style="margin-left:37%; margin-top: 1em">The SSL session
ID, in hex format.</p>

<p>Session-ID-ctx</p>

<p style="margin-left:37%; margin-top: 1em">The session ID
context, in hex format.</p>

<p>Master-Key</p>

<p style="margin-left:37%; margin-top: 1em">The SSL session
master key.</p>

<p>Key-Arg</p>

<p style="margin-left:37%; margin-top: 1em">The key
argument; this is only used in SSL v2.</p>

<p>Start Time</p>

<p style="margin-left:37%; margin-top: 1em">The session
start time. UNIX format.</p>

<p>Timeout</p>

<p style="margin-left:37%; margin-top: 1em">The timeout, in
seconds.</p>

<p>Verify return code</p>

<p style="margin-left:37%; margin-top: 1em">The return code
when a certificate is verified.</p>

<p style="margin-left:6%; margin-top: 1em">Since the SSL
session output contains the master key, it is possible to
read the contents of an encrypted session using this
information. Therefore appropriate security precautions
should be taken if the information is being output by a
&quot;real&quot; application. This is, however, strongly
discouraged and should only be used for debugging
purposes.</p>

<p style="margin-top: 1em"><b>SMIME</b></p>

<p style="margin-left:6%;"><b>openssl smime</b> [</p>

<p><b>-aes128</b> | <b>-aes192</b> | <b>-aes256</b> |
<b>-des</b> | <b>-des3</b> | <b>-rc2-40</b> | <b>-rc2-64</b>
| <b>-rc2-128</b> ] [<b>-binary</b>] [<b>-CAfile</b>
<i>file</i>] [<b>-CApath</b> <i>directory</i>]
[<b>-certfile</b> <i>file</i>] [<b>-check_ss_sig</b>]
[<b>-content</b> <i>file</i>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-decrypt</b>] [<b>-encrypt</b>]
[<b>-extended_crl</b>] [<b>-from</b> <i>addr</i>]
[<b>-ignore_critical</b>] [<b>-in</b> <i>file</i>]
[<b>-indef</b>] [<b>-inform der</b> | <b>pem</b> |
<b>smime</b>] [<b>-inkey</b> <i>file</i>]
[<b>-issuer_checks</b>] [<b>-keyform pem</b>] [<b>-md</b>
<i>digest</i>] [<b>-noattr</b>] [<b>-nocerts</b>]
[<b>-nochain</b>] [<b>-nodetach</b>] [<b>-noindef</b>]
[<b>-nointern</b>] [<b>-nosigs</b>] [<b>-noverify</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> | <b>pem</b>
| <b>smime</b>] [<b>-passin</b> <i>arg</i>] [<b>-pk7out</b>]
[<b>-policy_check</b>] [<b>-recip</b> <i>file</i>]
[<b>-resign</b>] [<b>-sign</b>] [<b>-signer</b> <i>file</i>]
[<b>-stream</b>] [<b>-subject</b> <i>s</i>] [<b>-text</b>]
[<b>-to</b> <i>addr</i>] [<b>-verify</b>]
[<b>-x509_strict</b>] [<i>cert.pem ...</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>smime</b>
command handles S/MIME mail. It can encrypt, decrypt, sign,
and verify S/MIME messages.</p>

<p style="margin-left:6%; margin-top: 1em">The MIME message
must be sent without any blank lines between the headers and
the output. Some mail programs will automatically add a
blank line. Piping the mail directly to an MTA is one way to
achieve the correct format.</p>

<p style="margin-left:6%; margin-top: 1em">The supplied
message to be signed or encrypted must include the necessary
MIME headers or many S/MIME clients won&rsquo;t display it
properly (if at all). Use the <b>-text</b> option to
automatically add plain text headers.</p>

<p style="margin-left:6%; margin-top: 1em">A &quot;signed
and encrypted&quot; message is one where a signed message is
then encrypted. This can be produced by encrypting an
already signed message.</p>

<p style="margin-left:6%; margin-top: 1em">There are a
number of operations that can be performed, as follows:</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:14%;">Decrypt mail using the supplied
certificate and private key. The input file is an encrypted
mail message in MIME format. The decrypted mail is written
to the output file.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:14%;">Encrypt mail for the given
recipient certificates. The input is the message to be
encrypted. The output file is the encrypted mail, in MIME
format.</p>

<p style="margin-top: 1em"><b>-pk7out</b></p>

<p style="margin-left:14%;">Take an input message and write
out a PEM-encoded PKCS#7 structure.</p>

<p style="margin-top: 1em"><b>-resign</b></p>

<p style="margin-left:14%;">Resign a message: take an
existing message and one or more new signers.</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:14%;">Sign mail using the supplied
certificate and private key. The input file is the message
to be signed. The signed message, in MIME format, is written
to the output file.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:14%;">Verify signed mail. The input
is a signed mail message and the output is the signed data.
Both clear text and opaque signing is supported.</p>

<p style="margin-left:6%; margin-top: 1em">The remaining
options are as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b> |
<b>-rc2-40</b> | <b>-rc2-64</b> | <b>-rc2-128</b></p>

<p style="margin-left:14%;">The encryption algorithm to
use. 128-, 192-, or 256-bit AES, DES (56 bits), triple DES
(168 bits), or 40-, 64-, or 128-bit RC2, respectively; if
not specified, 40-bit RC2 is used. Only used with
<b>-encrypt</b>.</p>

<p style="margin-top: 1em"><b>-binary</b></p>

<p style="margin-left:14%;">Normally, the input message is
converted to &quot;canonical&quot; format which uses CR/LF
as end of line, as required by the S/MIME specification.
When this option is present no translation occurs. This is
useful when handling binary data which may not be in MIME
format.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:14%;">A <i>file</i> containing
trusted CA certificates; only used with <b>-verify</b>.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:14%;">A <i>directory</i> containing
trusted CA certificates; only used with <b>-verify</b>. This
directory must be a standard certificate directory: that is,
a hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><i>cert.pem ...</i></p>

<p style="margin-left:14%;">One or more certificates of
message recipients: used when encrypting a message.</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:14%;">Allows additional certificates
to be specified. When signing, these will be included with
the message. When verifying, these will be searched for the
signers&rsquo; certificates. The certificates should be in
PEM format.</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b>,
<b>-crl_check</b>, <b>-crl_check_all</b>,
<b>-extended_crl</b>, <b>-ignore_critical</b>,
<b>-issuer_checks</b>, <b>-policy_check</b>,
<b>-x509_strict</b></p>

<p style="margin-left:14%;">Set various certificate chain
validation options. See the <b>verify</b> command for
details.</p>

<p style="margin-top: 1em"><b>-content</b> <i>file</i></p>

<p style="margin-left:14%;">A file containing the detached
content. This is only useful with the <b>-verify</b> option,
and only usable if the PKCS#7 structure is using the
detached signature form where the content is not included.
This option will override any content if the input format is
S/MIME and it uses the multipart/signed MIME content
type.</p>

<p style="margin-top: 1em"><b>-from</b> <i>addr</i>,
<b>-subject</b> <i>s</i>, <b>-to</b> <i>addr</i></p>

<p style="margin-left:14%;">The relevant mail headers.
These are included outside the signed portion of a message
so they may be included manually. When signing, many S/MIME
mail clients check that the signer&rsquo;s certificate email
address matches the From: address.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The input file to read
from.</p>

<p style="margin-top: 1em"><b>-indef</b></p>

<p style="margin-left:14%;">Enable streaming I/O for
encoding operations. This permits single pass processing of
data without the need to hold the entire contents in memory,
potentially supporting very large files. Streaming is
automatically set for S/MIME signing with detached data if
the output format is SMIME; it is currently off by default
for all other operations.</p>

<p style="margin-top: 1em"><b>-inform der</b> | <b>pem</b>
| <b>smime</b></p>

<p style="margin-left:14%;">The input format.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to use when
signing or decrypting, which must match the corresponding
certificate. If this option is not specified, the private
key must be included in the certificate file specified with
the <b>-recip</b> or <b>-signer</b> file. When signing, this
option can be used multiple times to specify successive
keys.</p>

<p style="margin-top: 1em"><b>-keyform pem</b></p>

<p style="margin-left:14%;">Input private key format.</p>

<p style="margin-top: 1em"><b>-md</b> <i>digest</i></p>

<p style="margin-left:14%;">The digest algorithm to use
when signing or resigning. If not present then the default
digest algorithm for the signing key is used (usually
SHA1).</p>

<p style="margin-top: 1em"><b>-noattr</b></p>

<p style="margin-left:14%;">Do not include attributes.</p>

<p style="margin-top: 1em"><b>-nocerts</b></p>

<p style="margin-left:14%;">Do not include the
signer&rsquo;s certificate. This will reduce the size of the
signed message but the verifier must have a copy of the
signer&rsquo;s certificate available locally (passed using
the <b>-certfile</b> option, for example).</p>

<p style="margin-top: 1em"><b>-nochain</b></p>

<p style="margin-left:14%;">Do not do chain verification of
signers&rsquo; certificates: that is, don&rsquo;t use the
certificates in the signed message as untrusted CAs.</p>

<p style="margin-top: 1em"><b>-nodetach</b></p>

<p style="margin-left:14%;">When signing a message use
opaque signing: this form is more resistant to translation
by mail relays but it cannot be read by mail agents that do
not support S/MIME. Without this option cleartext signing
with the MIME type multipart/signed is used.</p>

<p style="margin-top: 1em"><b>-noindef</b></p>

<p style="margin-left:14%;">Disable streaming I/O where it
would produce an encoding of indefinite length (currently
has no effect).</p>

<p style="margin-top: 1em"><b>-nointern</b></p>

<p style="margin-left:14%;">Only use certificates specified
in the <b>-certfile</b>. The supplied certificates can still
be used as untrusted CAs.</p>

<p style="margin-top: 1em"><b>-nosigs</b></p>

<p style="margin-left:14%;">Do not try to verify the
signatures on the message.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:14%;">Do not verify the
signer&rsquo;s certificate of a signed message.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to write
to.</p>

<p style="margin-top: 1em"><b>-outform der</b> | <b>pem</b>
| <b>smime</b></p>

<p style="margin-left:14%;">The output format. The default
is smime, which writes an S/MIME format message. <b>pem</b>
and <b>der</b> change this to write PEM and DER format
PKCS#7 structures instead. This currently only affects the
output format of the PKCS#7 structure; if no PKCS#7
structure is being output (for example with <b>-verify</b>
or <b>-decrypt</b>) this option has no effect.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-recip</b> <i>file</i></p>

<p style="margin-left:14%;">The recipients certificate when
decrypting a message. This certificate must match one of the
recipients of the message or an error occurs.</p>

<p style="margin-top: 1em"><b>-signer</b> <i>file</i></p>

<p style="margin-left:14%;">A signing certificate when
signing or resigning a message; this option can be used
multiple times if more than one signer is required. If a
message is being verified, the signer&rsquo;s certificates
will be written to this file if the verification was
successful.</p>

<p style="margin-top: 1em"><b>-stream</b></p>

<p style="margin-left:14%;">The same as <b>-indef</b>.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:14%;">Add plain text (text/plain)
MIME headers to the supplied message if encrypting or
signing. If decrypting or verifying, it strips off text
headers: if the decrypted or verified message is not of MIME
type text/plain then an error occurs.</p>

<p style="margin-left:6%; margin-top: 1em">The exit codes
for <b>smime</b> are as follows:</p>

<p style="margin-top: 1em">0</p>

<p style="margin-left:18%; margin-top: 1em">The operation
was completely successful.</p>

<p>1</p>

<p style="margin-left:18%; margin-top: 1em">An error
occurred parsing the command options.</p>

<p>2</p>

<p style="margin-left:18%; margin-top: 1em">One of the
input files could not be read.</p>

<p>3</p>

<p style="margin-left:18%; margin-top: 1em">An error
occurred creating the file or when reading the message.</p>

<p>4</p>

<p style="margin-left:18%; margin-top: 1em">An error
occurred decrypting or verifying the message.</p>

<p>5</p>

<p style="margin-left:18%; margin-top: 1em">An error
occurred writing certificates.</p>

<p style="margin-top: 1em"><b>SPEED</b></p>

<p style="margin-left:6%;"><b>openssl speed</b>
[<i>algorithm</i>] [<b>-decrypt</b>] [<b>-elapsed</b>]
[<b>-evp</b> <i>algorithm</i>] [<b>-mr</b>] [<b>-multi</b>
<i>number</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>speed</b>
command is used to test the performance of cryptographic
algorithms.</p>

<p style="margin-top: 1em"><i>algorithm</i></p>

<p style="margin-left:14%;">Perform the test using
<i>algorithm</i>. The default is to test all algorithms.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:14%;">Time decryption instead of
encryption; must be used with <b>-evp</b>.</p>

<p style="margin-top: 1em"><b>-elapsed</b></p>

<p style="margin-left:14%;">Measure time in real time
instead of CPU user time.</p>

<p style="margin-top: 1em"><b>-evp</b> <i>algorithm</i></p>

<p style="margin-left:14%;">Perform the test using one of
the algorithms accepted by EVP_get_cipherbyname(3).</p>

<p style="margin-top: 1em"><b>-mr</b></p>

<p style="margin-left:14%; margin-top: 1em">Produce machine
readable output.</p>

<p style="margin-top: 1em"><b>-multi</b> <i>number</i></p>

<p style="margin-left:14%;">Run <i>number</i> benchmarks in
parallel.</p>

<p style="margin-top: 1em"><b>SPKAC</b></p>

<p style="margin-left:6%;"><b>openssl spkac</b>
[<b>-challenge</b> <i>string</i>] [<b>-in</b> <i>file</i>]
[<b>-key</b> <i>keyfile</i>] [<b>-noout</b>] [<b>-out</b>
<i>file</i>] [<b>-passin</b> <i>arg</i>] [<b>-pubkey</b>]
[<b>-spkac</b> <i>spkacname</i>] [<b>-spksect</b>
<i>section</i>] [<b>-verify</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>spkac</b>
command processes signed public key and challenge (SPKAC)
files. It can print out their contents, verify the
signature, and produce its own SPKACs from a supplied
private key.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-challenge</b>
<i>string</i></p>

<p style="margin-left:17%;">The challenge string, if an
SPKAC is being created.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified. Ignored if the <b>-key</b>
option is used.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">Create an SPKAC file using the
private key in <i>keyfile</i>. The <b>-in</b>,
<b>-noout</b>, <b>-spksect</b>, and <b>-verify</b> options
are ignored, if present.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the text version of the SPKAC.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:17%;">Output the public key of an
SPKAC.</p>

<p style="margin-top: 1em"><b>-spkac</b>
<i>spkacname</i></p>

<p style="margin-left:17%;">An alternative name for the
variable containing the SPKAC. The default is
&quot;SPKAC&quot;. This option affects both generated and
input SPKAC files.</p>

<p style="margin-top: 1em"><b>-spksect</b>
<i>section</i></p>

<p style="margin-left:17%;">An alternative name for the
<i>section</i> containing the SPKAC.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the digital signature on
the supplied SPKAC.</p>

<p style="margin-top: 1em"><b>TS</b></p>

<p style="margin-left:6%;"><b>openssl ts -query</b>
[<b>-md4</b> | <b>-md5</b> | <b>-ripemd160</b> |
<b>-sha1</b>] [<b>-cert</b>] [<b>-config</b>
<i>configfile</i>] [<b>-data</b> <i>file_to_hash</i>]
[<b>-digest</b> <i>digest_bytes</i>] [<b>-in</b>
<i>request.tsq</i>] [<b>-no_nonce</b>] [<b>-out</b>
<i>request.tsq</i>] [<b>-policy</b> <i>object_id</i>]
[<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em"><b>openssl ts
-reply</b> [<b>-chain</b> <i>certs_file.pem</i>]
[<b>-config</b> <i>configfile</i>] [<b>-in</b>
<i>response.tsr</i>] [<b>-inkey</b> <i>private.pem</i>]
[<b>-out</b> <i>response.tsr</i>] [<b>-passin</b>
<i>arg</i>] [<b>-policy</b> <i>object_id</i>]
[<b>-queryfile</b> <i>request.tsq</i>] [<b>-section</b>
<i>tsa_section</i>] [<b>-signer</b> <i>tsa_cert.pem</i>]
[<b>-text</b>] [<b>-token_in</b>] [<b>-token_out</b>]</p>

<p style="margin-left:6%; margin-top: 1em"><b>openssl ts
-verify</b> [<b>-CAfile</b> <i>trusted_certs.pem</i>]
[<b>-CApath</b> <i>trusted_cert_path</i>] [<b>-data</b>
<i>file_to_hash</i>] [<b>-digest</b> <i>digest_bytes</i>]
[<b>-in</b> <i>response.tsr</i>] [<b>-queryfile</b>
<i>request.tsq</i>] [<b>-token_in</b>] [<b>-untrusted</b>
<i>cert_file.pem</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ts</b>
command is a basic Time Stamping Authority (TSA) client and
server application as specified in RFC 3161 (Time-Stamp
Protocol, TSP). A TSA can be part of a PKI deployment and
its role is to provide long term proof of the existence of
specific data. Here is a brief description of the
protocol:</p>

<p style="margin-top: 1em">1.</p>

<p style="margin-left:13%;">The TSA client computes a
one-way hash value for a data file and sends the hash to the
TSA.</p>

<p style="margin-top: 1em">2.</p>

<p style="margin-left:13%;">The TSA attaches the current
date and time to the received hash value, signs them and
sends the time stamp token back to the client. By creating
this token the TSA certifies the existence of the original
data file at the time of response generation.</p>

<p style="margin-top: 1em">3.</p>

<p style="margin-left:13%;">The TSA client receives the
time stamp token and verifies the signature on it. It also
checks if the token contains the same hash value that it had
sent to the TSA.</p>

<p style="margin-left:6%; margin-top: 1em">There is one
DER-encoded protocol data unit defined for transporting a
time stamp request to the TSA and one for sending the time
stamp response back to the client. The <b>ts</b> command has
three main functions: creating a time stamp request based on
a data file; creating a time stamp response based on a
request; and verifying if a response corresponds to a
particular request or a data file.</p>

<p style="margin-left:6%; margin-top: 1em">There is no
support for sending the requests/responses automatically
over HTTP or TCP yet as suggested in RFC 3161. Users must
send the requests either by FTP or email.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-query</b> switch can be used for creating and printing a
time stamp request with the following options:</p>

<p style="margin-top: 1em"><b>-cert</b></p>

<p style="margin-left:17%; margin-top: 1em">Expect the TSA
to include its signing certificate in the response.</p>

<p style="margin-top: 1em"><b>-config</b>
<i>configfile</i></p>

<p style="margin-left:17%;">Specify an alternative
configuration file. Only the OID section is used.</p>

<p style="margin-top: 1em"><b>-data</b>
<i>file_to_hash</i></p>

<p style="margin-left:17%;">The data file for which the
time stamp request needs to be created. The default is
standard input.</p>

<p style="margin-top: 1em"><b>-digest</b>
<i>digest_bytes</i></p>

<p style="margin-left:17%;">Specify the message imprint
explicitly without the data file. The imprint must be
specified in a hexadecimal format, two characters per byte,
the bytes optionally separated by colons. The number of
bytes must match the message digest algorithm in use.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">A previously created time stamp
request in DER format that will be printed into the output
file. Useful for examining the content of a request in
human-readable format.</p>

<p style="margin-top: 1em"><b>-md4</b> | <b>-md5</b> |
<b>-ripemd160</b> | <b>-sha</b> | <b>-sha1</b></p>

<p style="margin-left:17%;">The message digest to apply to
the data file. It supports all the message digest algorithms
that are supported by the <b>dgst</b> command. The default
is SHA-1.</p>

<p style="margin-top: 1em"><b>-no_nonce</b></p>

<p style="margin-left:17%;">Specify no nonce in the
request. The default, to include a 64-bit long pseudo-random
nonce, is recommended to protect against replay attacks.</p>

<p style="margin-top: 1em"><b>-out</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-policy</b>
<i>object_id</i></p>

<p style="margin-left:17%;">The policy that the client
expects the TSA to use for creating the time stamp token.
Either dotted OID notation or OID names defined in the
config file can be used. If no policy is requested the TSA
uses its own default policy.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Output in
human-readable text format instead of DER.</p>

<p style="margin-left:6%; margin-top: 1em">A time stamp
response (TimeStampResp) consists of a response status and
the time stamp token itself (ContentInfo), if the token
generation was successful. The <b>-reply</b> command is for
creating a time stamp response or time stamp token based on
a request and printing the response/token in human-readable
format. If <b>-token_out</b> is not specified the output is
always a time stamp response (TimeStampResp), otherwise it
is a time stamp token (ContentInfo).</p>

<p style="margin-top: 1em"><b>-chain</b>
<i>certs_file.pem</i></p>

<p style="margin-left:17%;">The collection of PEM
certificates that will be included in the response in
addition to the signer certificate if the <b>-cert</b>
option was used for the request. This file is supposed to
contain the certificate chain for the signer certificate
from its issuer upwards. The <b>-reply</b> command does not
build a certificate chain automatically.</p>

<p style="margin-top: 1em"><b>-config</b>
<i>configfile</i></p>

<p style="margin-left:17%;">Specify an alternative
configuration file.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">Specify a previously created
time stamp response (or time stamp token, if
<b>-token_in</b> is also specified) in DER format that will
be written to the output file. This option does not require
a request; it is useful, for example, to examine the content
of a response or token or to extract the time stamp token
from a response. If the input is a token and the output is a
time stamp response a default &quot;granted&quot; status
info is added to the token.</p>

<p style="margin-top: 1em"><b>-inkey</b>
<i>private.pem</i></p>

<p style="margin-left:17%;">The signer private key of the
TSA in PEM format. Overrides the <b>signer_key</b> config
file option.</p>

<p style="margin-top: 1em"><b>-out</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">The response is written to this
file. The format and content of the file depends on other
options (see <b>-text</b> and <b>-token_out</b>). The
default is stdout.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-policy</b>
<i>object_id</i></p>

<p style="margin-left:17%;">The default policy to use for
the response. Either dotted OID notation or OID names
defined in the config file can be used. If no policy is
requested the TSA uses its own default policy.</p>

<p style="margin-top: 1em"><b>-queryfile</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">The file containing a
DER-encoded time stamp request.</p>

<p style="margin-top: 1em"><b>-section</b>
<i>tsa_section</i></p>

<p style="margin-left:17%;">The config file section
containing the settings for response generation.</p>

<p style="margin-top: 1em"><b>-signer</b>
<i>tsa_cert.pem</i></p>

<p style="margin-left:17%;">The PEM signer certificate of
the TSA. The TSA signing certificate must have exactly one
extended key usage assigned to it: timeStamping. The
extended key usage must also be critical, otherwise the
certificate is going to be refused. Overrides the
<b>signer_cert</b> variable of the config file.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Output in
human-readable text format instead of DER.</p>

<p style="margin-top: 1em"><b>-token_in</b></p>

<p style="margin-left:17%;">The input is a DER-encoded time
stamp token (ContentInfo) instead of a time stamp response
(TimeStampResp).</p>

<p style="margin-top: 1em"><b>-token_out</b></p>

<p style="margin-left:17%;">The output is a time stamp
token (ContentInfo) instead of a time stamp response
(TimeStampResp).</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-verify</b> command is for verifying if a time stamp
response or time stamp token is valid and matches a
particular time stamp request or data file. The
<b>-verify</b> command does not use the configuration
file.</p>

<p style="margin-top: 1em"><b>-CAfile</b>
<i>trusted_certs.pem</i></p>

<p style="margin-left:17%;">The file containing a set of
trusted self-signed PEM CA certificates. See <b>verify</b>
for additional details. Either this option or <b>-CApath</b>
must be specified.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>trusted_cert_path</i></p>

<p style="margin-left:17%;">The directory containing the
trused CA certificates of the client. See <b>verify</b> for
additional details. Either this option or <b>-CAfile</b>
must be specified.</p>

<p style="margin-top: 1em"><b>-data</b>
<i>file_to_hash</i></p>

<p style="margin-left:17%;">The response or token must be
verified against <i>file_to_hash</i>. The file is hashed
with the message digest algorithm specified in the token.
The <b>-digest</b> and <b>-queryfile</b> options must not be
specified with this one.</p>

<p style="margin-top: 1em"><b>-digest</b>
<i>digest_bytes</i></p>

<p style="margin-left:17%;">The response or token must be
verified against the message digest specified with this
option. The number of bytes must match the message digest
algorithm specified in the token. The <b>-data</b> and
<b>-queryfile</b> options must not be specified with this
one.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">The time stamp response that
needs to be verified, in DER format. This option in
mandatory.</p>

<p style="margin-top: 1em"><b>-queryfile</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">The original time stamp
request, in DER format. The <b>-data</b> and <b>-digest</b>
options must not be specified with this one.</p>

<p style="margin-top: 1em"><b>-token_in</b></p>

<p style="margin-left:17%;">The input is a DER-encoded time
stamp token (ContentInfo) instead of a time stamp response
(TimeStampResp).</p>

<p style="margin-top: 1em"><b>-untrusted</b>
<i>cert_file.pem</i></p>

<p style="margin-left:17%;">Additional untrusted PEM
certificates which may be needed when building the
certificate chain for the TSA&rsquo;s signing certificate.
This file must contain the TSA signing certificate and all
intermediate CA certificates unless the response includes
them.</p>

<p style="margin-left:6%; margin-top: 1em">Options
specified on the command line always override the settings
in the config file:</p>

<p style="margin-top: 1em"><b>tsa</b> <i>section</i>,
<b>default_tsa</b></p>

<p style="margin-left:17%;">This is the main section and it
specifies the name of another section that contains all the
options for the <b>-reply</b> option. This section can be
overridden with the <b>-section</b> command line switch.</p>

<p style="margin-top: 1em"><b>oid_file</b></p>

<p style="margin-left:17%;">See <b>ca</b> for a
description.</p>

<p style="margin-top: 1em"><b>oid_section</b></p>

<p style="margin-left:17%;">See <b>ca</b> for a
description.</p>

<p style="margin-top: 1em"><b>serial</b></p>

<p style="margin-left:17%; margin-top: 1em">The file
containing the hexadecimal serial number of the last time
stamp response created. This number is incremented by 1 for
each response. If the file does not exist at the time of
response generation a new file is created with serial number
1. This parameter is mandatory.</p>

<p style="margin-top: 1em"><b>signer_cert</b></p>

<p style="margin-left:17%;">TSA signing certificate, in PEM
format. The same as the <b>-signer</b> command line
option.</p>

<p style="margin-top: 1em"><b>certs</b></p>

<p style="margin-left:17%; margin-top: 1em">A set of
PEM-encoded certificates that need to be included in the
response. The same as the <b>-chain</b> command line
option.</p>

<p style="margin-top: 1em"><b>signer_key</b></p>

<p style="margin-left:17%;">The private key of the TSA, in
PEM format. The same as the <b>-inkey</b> command line
option.</p>

<p style="margin-top: 1em"><b>default_policy</b></p>

<p style="margin-left:17%;">The default policy to use when
the request does not mandate any policy. The same as the
<b>-policy</b> command line option.</p>

<p style="margin-top: 1em"><b>other_policies</b></p>

<p style="margin-left:17%;">Comma separated list of
policies that are also acceptable by the TSA and used only
if the request explicitly specifies one of them.</p>

<p style="margin-top: 1em"><b>digests</b></p>

<p style="margin-left:17%;">The list of message digest
algorithms that the TSA accepts. At least one algorithm must
be specified. This parameter is mandatory.</p>

<p style="margin-top: 1em"><b>accuracy</b></p>

<p style="margin-left:17%;">The accuracy of the time source
of the TSA in seconds, milliseconds and microseconds. For
example, secs:1, millisecs:500, microsecs:100. If any of the
components is missing, zero is assumed for that field.</p>


<p style="margin-top: 1em"><b>clock_precision_digits</b></p>

<p style="margin-left:17%;">The maximum number of digits,
which represent the fraction of seconds, that need to be
included in the time field. The trailing zeroes must be
removed from the time, so there might actually be fewer
digits or no fraction of seconds at all. The maximum value
is 6; the default is 0.</p>

<p style="margin-top: 1em"><b>ordering</b></p>

<p style="margin-left:17%;">If this option is yes, the
responses generated by this TSA can always be ordered, even
if the time difference between two responses is less than
the sum of their accuracies. The default is no.</p>

<p style="margin-top: 1em"><b>tsa_name</b></p>

<p style="margin-left:17%;">Set this option to yes if the
subject name of the TSA must be included in the TSA name
field of the response. The default is no.</p>

<p style="margin-top: 1em"><b>ess_cert_id_chain</b></p>

<p style="margin-left:17%;">The SignedData objects created
by the TSA always contain the certificate identifier of the
signing certificate in a signed attribute (see RFC 2634,
Enhanced Security Services). If this option is set to yes
and either the <b>certs</b> variable or the <b>-chain</b>
option is specified then the certificate identifiers of the
chain will also be included in the SigningCertificate signed
attribute. If this variable is set to no, only the signing
certificate identifier is included. The default is no.</p>

<p style="margin-top: 1em"><b>VERIFY</b></p>

<p style="margin-left:6%;"><b>openssl verify</b>
[<b>-CAfile</b> <i>file</i>] [<b>-CApath</b>
<i>directory</i>] [<b>-check_ss_sig</b>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-explicit_policy</b>]
[<b>-extended_crl</b>] [<b>-help</b>]
[<b>-ignore_critical</b>] [<b>-inhibit_any</b>]
[<b>-inhibit_map</b>] [<b>-issuer_checks</b>]
[<b>-policy_check</b>] [<b>-purpose</b> <i>purpose</i>]
[<b>-untrusted</b> <i>file</i>] [<b>-verbose</b>]
[<b>-x509_strict</b>] [<i>certificates</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>verify</b> command verifies certificate chains.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b></p>

<p style="margin-left:17%;">Verify the signature on the
self-signed root CA. This is disabled by default because it
doesn&rsquo;t add any security.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> of trusted
certificates. The <i>file</i> should contain multiple
certificates in PEM format, concatenated together.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">A <i>directory</i> of trusted
certificates. The certificates, or symbolic links to them,
should have names of the form <i>hash</i>.0, where
<i>hash</i> is the hashed certificate subject name (see the
<b>-hash</b> option of the <b>x509</b> utility).</p>

<p style="margin-top: 1em"><b>-crl_check</b></p>

<p style="margin-left:17%;">Check end entity certificate
validity by attempting to look up a valid CRL. If a valid
CRL cannot be found an error occurs.</p>

<p style="margin-top: 1em"><b>-crl_check_all</b></p>

<p style="margin-left:17%;">Check the validity of all
certificates in the chain by attempting to look up valid
CRLs.</p>

<p style="margin-top: 1em"><b>-explicit_policy</b></p>

<p style="margin-left:17%;">Set policy variable
require-explicit-policy (RFC 3280).</p>

<p style="margin-top: 1em"><b>-extended_crl</b></p>

<p style="margin-left:17%;">Enable extended CRL features
such as indirect CRLs and alternate CRL signing keys.</p>

<p style="margin-top: 1em"><b>-help</b></p>

<p style="margin-left:17%; margin-top: 1em">Print a usage
message.</p>

<p style="margin-top: 1em"><b>-ignore_critical</b></p>

<p style="margin-left:17%;">Ignore critical extensions
instead of rejecting the certificate.</p>

<p style="margin-top: 1em"><b>-inhibit_any</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-any-policy (RFC 3280).</p>

<p style="margin-top: 1em"><b>-inhibit_map</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-policy-mapping (RFC 3280).</p>

<p style="margin-top: 1em"><b>-issuer_checks</b></p>

<p style="margin-left:17%;">Print diagnostics relating to
searches for the issuer certificate of the current
certificate showing why each candidate issuer certificate
was rejected. The presence of rejection messages does not
itself imply that anything is wrong: during the normal
verify process several rejections may take place.</p>

<p style="margin-top: 1em"><b>-policy_check</b></p>

<p style="margin-left:17%;">Enable certificate policy
processing.</p>

<p style="margin-top: 1em"><b>-purpose</b>
<i>purpose</i></p>

<p style="margin-left:17%;">The intended use for the
certificate. Without this option no chain verification will
be done. Currently accepted uses are <b>sslclient</b>,
<b>sslserver</b>, <b>nssslserver</b>, <b>smimesign</b>,
<b>smimeencrypt</b>, <b>crlsign</b>, <b>any</b>, and
<b>ocsphelper</b>.</p>

<p style="margin-top: 1em"><b>-untrusted</b>
<i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> of untrusted
certificates. The <i>file</i> should contain multiple
certificates.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:17%;">Print extra information about
the operations being performed.</p>

<p style="margin-top: 1em"><b>-x509_strict</b></p>

<p style="margin-left:17%;">Disable workarounds for broken
certificates which have to be disabled for strict X.509
compliance.</p>

<p style="margin-top: 1em"><i>certificates</i></p>

<p style="margin-left:17%;">One or more PEM
<i>certificates</i> to verify. If no certificate files are
included, an attempt is made to read a certificate from
standard input. If the first certificate filename begins
with a dash, use a lone dash to mark the last option.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>verify</b> program uses the same functions as the
internal SSL and S/MIME verification, with one crucial
difference: wherever possible an attempt is made to continue
after an error, whereas normally the verify operation would
halt on the first error. This allows all the problems with a
certificate chain to be determined.</p>

<p style="margin-left:6%; margin-top: 1em">The verify
operation consists of a number of separate steps. Firstly a
certificate chain is built up starting from the supplied
certificate and ending in the root CA. It is an error if the
whole chain cannot be built up. The chain is built up by
looking up the issuer&rsquo;s certificate of the current
certificate. If a certificate is found which is its own
issuer, it is assumed to be the root CA.</p>

<p style="margin-left:6%; margin-top: 1em">All certificates
whose subject name matches the issuer name of the current
certificate are subject to further tests. The relevant
authority key identifier components of the current
certificate (if present) must match the subject key
identifier (if present) and issuer and serial number of the
candidate issuer; in addition the <b>keyUsage</b> extension
of the candidate issuer (if present) must permit certificate
signing.</p>

<p style="margin-left:6%; margin-top: 1em">The lookup first
looks in the list of untrusted certificates and if no match
is found the remaining lookups are from the trusted
certificates. The root CA is always looked up in the trusted
certificate list: if the certificate to verify is a root
certificate, then an exact match must be found in the
trusted list.</p>

<p style="margin-left:6%; margin-top: 1em">The second
operation is to check every untrusted certificate&rsquo;s
extensions for consistency with the supplied purpose. If the
<b>-purpose</b> option is not included, then no checks are
done. The supplied or &quot;leaf&quot; certificate must have
extensions compatible with the supplied purpose and all
other certificates must also be valid CA certificates. The
precise extensions required are described in more detail in
the <b>X509</b> section below.</p>

<p style="margin-left:6%; margin-top: 1em">The third
operation is to check the trust settings on the root CA. The
root CA should be trusted for the supplied purpose. A
certificate with no trust settings is considered to be valid
for all purposes.</p>

<p style="margin-left:6%; margin-top: 1em">The final
operation is to check the validity of the certificate chain.
The validity period is checked against the current system
time and the <b>notBefore</b> and <b>notAfter</b> dates in
the certificate. The certificate signatures are also checked
at this point.</p>

<p style="margin-left:6%; margin-top: 1em">If all
operations complete successfully, the certificate is
considered valid. If any operation fails then the
certificate is not valid. When a verify operation fails, the
output messages can be somewhat cryptic. The general form of
the error message is:</p>

<p style="margin-left:6%; margin-top: 1em">server.pem:
/C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA
(1024-bit) <br>
error 24 at 1 depth lookup:invalid CA certificate</p>

<p style="margin-left:6%; margin-top: 1em">The first line
contains the name of the certificate being verified,
followed by the subject name of the certificate. The second
line contains the error number and the depth. The depth is
the number of the certificate being verified when a problem
was detected starting with zero for the certificate being
verified itself, then 1 for the CA that signed the
certificate and so on. Finally a text version of the error
number is presented.</p>

<p style="margin-left:6%; margin-top: 1em">An exhaustive
list of the error codes and messages is shown below; this
also includes the name of the error code as defined in the
header file &lt;<i>openssl/x509_vfy.h</i>&gt;. Some of the
error codes are defined but never returned: these are
described as &quot;unused&quot;.</p>

<p style="margin-top: 1em">0 X509_V_OK</p>

<p style="margin-left:14%;">The operation was
successful.</p>

<p style="margin-top: 1em">2
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT</p>

<p style="margin-left:14%;">The issuer certificate of an
untrusted certificate could not be found.</p>

<p style="margin-top: 1em">3
X509_V_ERR_UNABLE_TO_GET_CRL</p>

<p style="margin-left:14%;">The CRL of a certificate could
not be found.</p>

<p style="margin-top: 1em">4
X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE</p>

<p style="margin-left:14%;">The certificate signature could
not be decrypted. This means that the actual signature value
could not be determined rather than it not matching the
expected value. This is only meaningful for RSA keys.</p>

<p style="margin-top: 1em">5
X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE</p>

<p style="margin-left:14%;">The CRL signature could not be
decrypted. This means that the actual signature value could
not be determined rather than it not matching the expected
value. Unused.</p>

<p style="margin-top: 1em">6
X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY</p>

<p style="margin-left:14%;">The public key in the
certificate <b>SubjectPublicKeyInfo</b> could not be
read.</p>

<p style="margin-top: 1em">7
X509_V_ERR_CERT_SIGNATURE_FAILURE</p>

<p style="margin-left:14%;">The signature of the
certificate is invalid.</p>

<p style="margin-top: 1em">8
X509_V_ERR_CRL_SIGNATURE_FAILURE</p>

<p style="margin-left:14%;">The signature of the
certificate is invalid.</p>

<p style="margin-top: 1em">9
X509_V_ERR_CERT_NOT_YET_VALID</p>

<p style="margin-left:14%;">The certificate is not yet
valid: the <b>notBefore</b> date is after the current
time.</p>

<p style="margin-top: 1em">10
X509_V_ERR_CERT_HAS_EXPIRED</p>

<p style="margin-left:14%;">The certificate has expired;
that is, the <b>notAfter</b> date is before the current
time.</p>

<p style="margin-top: 1em">11
X509_V_ERR_CRL_NOT_YET_VALID</p>

<p style="margin-left:14%;">The CRL is not yet valid.</p>

<p style="margin-top: 1em">12
X509_V_ERR_CRL_HAS_EXPIRED</p>

<p style="margin-left:14%;">The CRL has expired.</p>

<p style="margin-top: 1em">13
X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD</p>

<p style="margin-left:14%;">The certificate
<b>notBefore</b> field contains an invalid time.</p>

<p style="margin-top: 1em">14
X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD</p>

<p style="margin-left:14%;">The certificate <b>notAfter</b>
field contains an invalid time.</p>

<p style="margin-top: 1em">15
X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD</p>

<p style="margin-left:14%;">The CRL <b>lastUpdate</b> field
contains an invalid time.</p>

<p style="margin-top: 1em">16
X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD</p>

<p style="margin-left:14%;">The CRL <b>nextUpdate</b> field
contains an invalid time.</p>

<p style="margin-top: 1em">17 X509_V_ERR_OUT_OF_MEM</p>

<p style="margin-left:14%;">An error occurred trying to
allocate memory. This should never happen.</p>

<p style="margin-top: 1em">18
X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT</p>

<p style="margin-left:14%;">The passed certificate is
self-signed and the same certificate cannot be found in the
list of trusted certificates.</p>

<p style="margin-top: 1em">19
X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN</p>

<p style="margin-left:14%;">The certificate chain could be
built up using the untrusted certificates but the root could
not be found locally.</p>

<p style="margin-top: 1em">20
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY</p>

<p style="margin-left:14%;">The issuer certificate of a
locally looked up certificate could not be found. This
normally means the list of trusted certificates is not
complete.</p>

<p style="margin-top: 1em">21
X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE</p>

<p style="margin-left:14%;">No signatures could be verified
because the chain contains only one certificate and it is
not self-signed.</p>

<p style="margin-top: 1em">22
X509_V_ERR_CERT_CHAIN_TOO_LONG</p>

<p style="margin-left:14%;">The certificate chain length is
greater than the supplied maximum depth. Unused.</p>

<p style="margin-top: 1em">23 X509_V_ERR_CERT_REVOKED</p>

<p style="margin-left:14%;">The certificate has been
revoked.</p>

<p style="margin-top: 1em">24 X509_V_ERR_INVALID_CA</p>

<p style="margin-left:14%;">A CA certificate is invalid.
Either it is not a CA or its extensions are not consistent
with the supplied purpose.</p>

<p style="margin-top: 1em">25
X509_V_ERR_PATH_LENGTH_EXCEEDED</p>

<p style="margin-left:14%;">The <b>basicConstraints</b>
pathlength parameter has been exceeded.</p>

<p style="margin-top: 1em">26
X509_V_ERR_INVALID_PURPOSE</p>

<p style="margin-left:14%;">The supplied certificate cannot
be used for the specified purpose.</p>

<p style="margin-top: 1em">27 X509_V_ERR_CERT_UNTRUSTED</p>

<p style="margin-left:14%;">The root CA is not marked as
trusted for the specified purpose.</p>

<p style="margin-top: 1em">28 X509_V_ERR_CERT_REJECTED</p>

<p style="margin-left:14%;">The root CA is marked to reject
the specified purpose.</p>

<p style="margin-top: 1em">29
X509_V_ERR_SUBJECT_ISSUER_MISMATCH</p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its subject name did not
match the issuer name of the current certificate. Only
displayed when the <b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em">30
X509_V_ERR_AKID_SKID_MISMATCH</p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its subject key identifier
was present and did not match the authority key identifier
current certificate. Only displayed when the
<b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em">31
X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH</p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its issuer name and serial
number were present and did not match the authority key
identifier of the current certificate. Only displayed when
the <b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em">32
X509_V_ERR_KEYUSAGE_NO_CERTSIGN</p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its <b>keyUsage</b>
extension does not permit certificate signing.</p>

<p style="margin-top: 1em">50
X509_V_ERR_APPLICATION_VERIFICATION</p>

<p style="margin-left:14%;">An application specific error.
Unused.</p>

<p style="margin-top: 1em"><b>VERSION</b></p>

<p style="margin-left:6%;"><b>openssl version</b>
[<b>-abdfopv</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>version</b> command is used to print out version
information about <b>openssl</b>.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-a</b></p>

<p style="margin-left:17%; margin-top: 1em">All
information: this is the same as setting all the other
flags.</p>

<p style="margin-top: 1em"><b>-b</b></p>

<p style="margin-left:17%; margin-top: 1em">The date the
current version of <b>openssl</b> was built.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">OPENSSLDIR
setting.</p>

<p style="margin-top: 1em"><b>-f</b></p>

<p style="margin-left:17%; margin-top: 1em">Compilation
flags.</p>

<p style="margin-top: 1em"><b>-o</b></p>

<p style="margin-left:17%; margin-top: 1em">Option
information: various options set when the library was
built.</p>

<p style="margin-top: 1em"><b>-p</b></p>

<p style="margin-left:17%; margin-top: 1em">Platform
setting.</p>

<p style="margin-top: 1em"><b>-v</b></p>

<p style="margin-left:17%; margin-top: 1em">The current
<b>openssl</b> version.</p>

<p style="margin-top: 1em"><b>X509</b></p>

<p style="margin-left:6%;"><b>openssl x509</b> [<b>-C</b>]
[<b>-addreject</b> <i>arg</i>] [<b>-addtrust</b> <i>arg</i>]
[<b>-alias</b>] [<b>-CA</b> <i>file</i>]
[<b>-CAcreateserial</b>] [<b>-CAform der</b> | <b>pem</b>]
[<b>-CAkey</b> <i>file</i>] [<b>-CAkeyform der</b> |
<b>pem</b>] [<b>-CAserial</b> <i>file</i>] [<b>-certopt</b>
<i>option</i>] [<b>-checkend</b> <i>arg</i>]
[<b>-clrext</b>] [<b>-clrreject</b>] [<b>-clrtrust</b>]
[<b>-dates</b>] [<b>-days</b> <i>arg</i>] [<b>-email</b>]
[<b>-enddate</b>] [<b>-extensions</b> <i>section</i>]
[<b>-extfile</b> <i>file</i>] [<b>-fingerprint</b>]
[<b>-hash</b>] [<b>-in</b> <i>file</i>] [<b>-inform der</b>
| <b>net</b> | <b>pem</b>] [<b>-issuer</b>]
[<b>-issuer_hash</b>] [<b>-issuer_hash_old</b>] [<b>-keyform
der</b> | <b>pem</b>] [<b>-md5</b> | <b>-sha1</b>]
[<b>-modulus</b>] [<b>-nameopt</b> <i>option</i>]
[<b>-noout</b>] [<b>-ocsp_uri</b>] [<b>-ocspid</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> | <b>net</b>
| <b>pem</b>] [<b>-passin</b> <i>arg</i>] [<b>-pubkey</b>]
[<b>-purpose</b>] [<b>-req</b>] [<b>-serial</b>]
[<b>-set_serial</b> <i>n</i>] [<b>-setalias</b> <i>arg</i>]
[<b>-signkey</b> <i>file</i>] [<b>-startdate</b>]
[<b>-subject</b>] [<b>-subject_hash</b>]
[<b>-subject_hash_old</b>] [<b>-text</b>] [<b>-trustout</b>]
[<b>-x509toreq</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>x509</b>
command is a multi-purpose certificate utility. It can be
used to display certificate information, convert
certificates to various forms, sign certificate requests
like a &quot;mini CA&quot;, or edit certificate trust
settings.</p>

<p style="margin-left:6%; margin-top: 1em">The following
are x509 input, output, and general purpose options:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> | <b>net</b>
| <b>pem</b></p>

<p style="margin-left:14%;">The input format. Normally, the
command will expect an X.509 certificate, but this can
change if other options such as <b>-req</b> are present.</p>

<p style="margin-top: 1em"><b>-md5</b> | <b>-sha1</b></p>

<p style="margin-left:14%;">The digest to use. This affects
any signing or display option that uses a message digest,
such as the <b>-fingerprint</b>, <b>-signkey</b>, and
<b>-CA</b> options. If not specified, MD5 is used. SHA1 is
always used with DSA keys.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to write to, or
standard output if none is specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> | <b>net</b>
| <b>pem</b></p>

<p style="margin-left:14%;">The output format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-left:6%; margin-top: 1em">The following
are x509 display options:</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:14%; margin-top: 1em">Output the
certificate in the form of a C source file.</p>

<p style="margin-top: 1em"><b>-certopt</b>
<i>option</i></p>

<p style="margin-left:14%;">Customise the output format
used with <b>-text</b>, either using a list of
comma-separated options or by specifying <b>-certopt</b>
multiple times. The default behaviour is to print all
fields. The options are as follows:</p>

<p style="margin-top: 1em"><b>ca_default</b></p>

<p style="margin-left:41%; margin-top: 1em">Equivalent to
<b>no_issuer</b>, <b>no_pubkey</b>, <b>no_header</b>,
<b>no_version</b>, <b>no_sigdump</b>, and
<b>no_signame</b>.</p>

<p><b>compatible</b></p>

<p style="margin-left:41%; margin-top: 1em">Equivalent to
no output options at all.</p>

<p><b>ext_default</b></p>

<p style="margin-left:41%; margin-top: 1em">Print
unsupported certificate extensions.</p>

<p><b>ext_dump</b></p>

<p style="margin-left:41%; margin-top: 1em">Hex dump
unsupported extensions.</p>

<p><b>ext_error</b></p>

<p style="margin-left:41%; margin-top: 1em">Print an error
message for unsupported certificate extensions.</p>

<p><b>ext_parse</b></p>

<p style="margin-left:41%; margin-top: 1em">ASN.1 parse
unsupported extensions.</p>

<p><b>no_aux</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
certificate trust information.</p>

<p><b>no_extensions</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
X509V3 extensions.</p>

<p><b>no_header</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
header (Certificate and Data) information.</p>

<p><b>no_issuer</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the issuer name.</p>

<p><b>no_pubkey</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the public key.</p>

<p><b>no_serial</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the serial number.</p>

<p><b>no_sigdump</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not give a
hexadecimal dump of the certificate signature.</p>

<p><b>no_signame</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the signature algorithm used.</p>

<p><b>no_subject</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the subject name.</p>

<p><b>no_validity</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the <b>notBefore</b> and <b>notAfter</b> (validity)
fields.</p>

<p><b>no_version</b></p>

<p style="margin-left:41%; margin-top: 1em">Do not print
the version number.</p>

<p style="margin-top: 1em"><b>-dates</b></p>

<p style="margin-left:14%;">Print the start and expiry date
of a certificate.</p>

<p style="margin-top: 1em"><b>-email</b></p>

<p style="margin-left:14%;">Output the email addresses, if
any.</p>

<p style="margin-top: 1em"><b>-enddate</b></p>

<p style="margin-left:14%;">Print the expiry date of the
certificate; that is, the <b>notAfter</b> date.</p>

<p style="margin-top: 1em"><b>-fingerprint</b></p>

<p style="margin-left:14%;">Print the digest of the
DER-encoded version of the whole certificate.</p>

<p style="margin-top: 1em"><b>-hash</b></p>

<p style="margin-left:14%;">A synonym for
<b>-subject_hash</b>.</p>

<p style="margin-top: 1em"><b>-issuer</b></p>

<p style="margin-left:14%;">Print the issuer name.</p>

<p style="margin-top: 1em"><b>-issuer_hash</b></p>

<p style="margin-left:14%;">Print the hash of the
certificate issuer name.</p>

<p style="margin-top: 1em"><b>-issuer_hash_old</b></p>

<p style="margin-left:14%;">Print the hash of the
certificate issuer name using the older algorithm as used by
<b>openssl</b> versions before 1.0.0.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:14%;">Print the value of the modulus
of the public key contained in the certificate.</p>

<p style="margin-top: 1em"><b>-nameopt</b>
<i>option</i></p>

<p style="margin-left:14%;">Customise how the subject or
issuer names are displayed, either using a list of
comma-separated options or by specifying <b>-nameopt</b>
multiple times. The default behaviour is to use the
<b>oneline</b> format. The options, which can be preceded by
a dash to turn them off, are as follows:</p>

<p style="margin-top: 1em"><b>align</b></p>

<p style="margin-left:22%;">Align field values for a more
readable output. Only usable with <i>sep_multiline</i>.</p>

<p style="margin-top: 1em"><b>compat</b></p>

<p style="margin-left:22%;">Use the old format, equivalent
to specifying no options at all.</p>

<p style="margin-top: 1em"><b>dn_rev</b></p>

<p style="margin-left:22%;">Reverse the fields of the DN,
as required by RFC 2253. As a side effect, this also
reverses the order of multiple AVAs.</p>

<p style="margin-top: 1em"><b>dump_all</b></p>

<p style="margin-left:22%;">Dump all fields. When used with
<i>dump_der</i>, it allows the DER encoding of the structure
to be unambiguously determined.</p>

<p style="margin-top: 1em"><b>dump_der</b></p>

<p style="margin-left:22%;">Any fields that need to be
hexdumped are dumped using the DER encoding of the field.
Otherwise just the content octets will be displayed. Both
options use the RFC 2253 #XXXX... format.</p>

<p style="margin-top: 1em"><b>dump_nostr</b></p>

<p style="margin-left:22%;">Dump non-character string types
(for example OCTET STRING); usually, non-character string
types are displayed as though each content octet represents
a single character.</p>

<p style="margin-top: 1em"><b>dump_unknown</b></p>

<p style="margin-left:22%;">Dump any field whose OID is not
recognised by <b>openssl</b>.</p>

<p style="margin-top: 1em"><b>esc_2253</b></p>

<p style="margin-left:22%;">Escape the &quot;special&quot;
characters required by RFC 2253 in a field that is &ldquo;
,+&quot;&lt;&gt;;&rdquo;. Additionally, &rsquo;#&rsquo; is
escaped at the beginning of a string and a space character
at the beginning or end of a string.</p>

<p style="margin-top: 1em"><b>esc_ctrl</b></p>

<p style="margin-left:22%;">Escape control characters. That
is, those with ASCII values less than 0x20 (space) and the
delete (0x7f) character. They are escaped using the RFC 2253
\XX notation (where XX are two hex digits representing the
character value).</p>

<p style="margin-top: 1em"><b>esc_msb</b></p>

<p style="margin-left:22%;">Escape characters with the MSB
set; that is, with ASCII values larger than 127.</p>

<p style="margin-top: 1em"><b>multiline</b></p>

<p style="margin-left:22%;">A multiline format. Equivalent
to <b>esc_ctrl</b>, <b>esc_msb</b>, <b>sep_multiline</b>,
<b>space_eq</b>, <b>lname</b>, and <b>align</b>.</p>

<p style="margin-top: 1em"><b>no_type</b></p>

<p style="margin-left:22%;">Do not attempt to interpret
multibyte characters. That is, content octets are merely
dumped as though one octet represents each character. This
is useful for diagnostic purposes but results in rather odd
looking output.</p>

<p style="margin-top: 1em"><b>nofname</b>, <b>sname</b>,
<b>lname</b>, <b>oid</b></p>

<p style="margin-left:22%;">Alter how the field name is
displayed: <b>nofname</b> does not display the field at all;
<b>sname</b> uses the short name form (CN for
<b>commonName</b>, for example); <b>lname</b> uses the long
form. <b>oid</b> represents the OID in numerical form and is
useful for diagnostic purpose.</p>

<p style="margin-top: 1em"><b>oneline</b></p>

<p style="margin-left:22%;">A one line format which is more
readable than <b>RFC2253</b>. Equivalent to <b>esc_2253</b>,
<b>esc_ctrl</b>, <b>esc_msb</b>, <b>utf8</b>,
<b>dump_nostr</b>, <b>dump_der</b>, <b>use_quote</b>,
<b>sep_comma_plus_spc</b>, <b>space_eq</b>, and
<b>sname</b>.</p>

<p style="margin-top: 1em"><b>RFC2253</b></p>

<p style="margin-left:22%;">Displays names compatible with
RFC 2253. Equivalent to <b>esc_2253</b>, <b>esc_ctrl</b>,
<b>esc_msb</b>, <b>utf8</b>, <b>dump_nostr</b>,
<b>dump_unknown</b>, <b>dump_der</b>, <b>sep_comma_plus</b>,
<b>dn_rev</b>, and <b>sname</b>.</p>

<p style="margin-top: 1em"><b>sep_comma_plus</b>,
<b>sep_comma_plus_space</b>, <b>sep_semi_plus_space</b>,
<b>sep_multiline</b></p>

<p style="margin-left:22%;">Determine the field separators:
the first character is between RDNs and the second between
multiple AVAs (multiple AVAs are very rare and their use is
discouraged). The options ending in &quot;space&quot;
additionally place a space after the separator to make it
more readable. <b>sep_multiline</b> uses a linefeed
character for the RDN separator and a spaced &rsquo;+&rsquo;
for the AVA separator, as well as indenting the fields by
four characters.</p>

<p style="margin-top: 1em"><b>show_type</b></p>

<p style="margin-left:22%;">Show the type of the ASN.1
character string. The type precedes the field contents. For
example &quot;BMPSTRING: Hello World&quot;.</p>

<p style="margin-top: 1em"><b>space_eq</b></p>

<p style="margin-left:22%;">Place spaces round the
&rsquo;=&rsquo; character which follows the field name.</p>

<p style="margin-top: 1em"><b>use_quote</b></p>

<p style="margin-left:22%;">Escape some characters by
surrounding the whole string with &rsquo;&quot;&rsquo;
characters. Without the option, all escaping is done with
the &rsquo;\&rsquo; character.</p>

<p style="margin-top: 1em"><b>utf8</b></p>

<p style="margin-left:22%; margin-top: 1em">Convert all
strings to UTF8 format first, as required by RFC 2253. On a
UTF8 compatible terminal, the use of this option (and not
setting <b>esc_msb</b>) may result in the correct display of
multibyte characters. Usually, multibyte characters larger
than 0xff are represented using the format \UXXXX for 16
bits and \WXXXXXXXX for 32 bits, and any UTF8Strings are
converted to their character form first.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:14%;">Do not output the encoded
version of the request.</p>

<p style="margin-top: 1em"><b>-ocsp_uri</b></p>

<p style="margin-left:14%;">Print the OCSP responder
addresses, if any.</p>

<p style="margin-top: 1em"><b>-ocspid</b></p>

<p style="margin-left:14%;">Print OCSP hash values for the
subject name and public key.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:14%;">Print the public key.</p>

<p style="margin-top: 1em"><b>-serial</b></p>

<p style="margin-left:14%;">Print the certificate serial
number.</p>

<p style="margin-top: 1em"><b>-startdate</b></p>

<p style="margin-left:14%;">Print the start date of the
certificate; that is, the <b>notBefore</b> date.</p>

<p style="margin-top: 1em"><b>-subject</b></p>

<p style="margin-left:14%;">Print the subject name.</p>

<p style="margin-top: 1em"><b>-subject_hash</b></p>

<p style="margin-left:14%;">Print the hash of the
certificate subject name. This is used in <b>openssl</b> to
form an index to allow certificates in a directory to be
looked up by subject name.</p>

<p style="margin-top: 1em"><b>-subject_hash_old</b></p>

<p style="margin-left:14%;">Print the hash of the
certificate subject name using the older algorithm as used
by <b>openssl</b> versions before 1.0.0.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:14%;">Print the full certificate in
text form.</p>

<p style="margin-left:6%; margin-top: 1em">A trusted
certificate is a certificate which has several additional
pieces of information attached to it such as the permitted
and prohibited uses of the certificate and an alias. When a
certificate is being verified at least one certificate must
be trusted. By default, a trusted certificate must be stored
locally and be a root CA. The following are x509 trust
settings options:</p>

<p style="margin-top: 1em"><b>-addreject</b> <i>arg</i></p>

<p style="margin-left:14%;">Add a prohibited use. Accepts
the same values as the <b>-addtrust</b> option.</p>

<p style="margin-top: 1em"><b>-addtrust</b> <i>arg</i></p>

<p style="margin-left:14%;">Add a trusted certificate use.
Any object name can be used here, but currently only
<b>clientAuth</b> (SSL client use), <b>serverAuth</b> (SSL
server use), and <b>emailProtection</b> (S/MIME email) are
used.</p>

<p style="margin-top: 1em"><b>-alias</b></p>

<p style="margin-left:14%;">Output the certificate
alias.</p>

<p style="margin-top: 1em"><b>-clrreject</b></p>

<p style="margin-left:14%;">Clear all the prohibited or
rejected uses of the certificate.</p>

<p style="margin-top: 1em"><b>-clrtrust</b></p>

<p style="margin-left:14%;">Clear all the permitted or
trusted uses of the certificate.</p>

<p style="margin-top: 1em"><b>-purpose</b></p>

<p style="margin-left:14%;">Perform tests on the
certificate extensions. The same code is used when verifying
untrusted certificates in chains, so this section is useful
if a chain is rejected by the verify code.</p>

<p style="margin-left:14%; margin-top: 1em">The
<b>basicConstraints</b> extension CA flag is used to
determine whether the certificate can be used as a CA. If
the CA flag is true, it is a CA; if the CA flag is false, it
is not a CA. All CAs should have the CA flag set to
true.</p>

<p style="margin-left:14%; margin-top: 1em">If the
<b>basicConstraints</b> extension is absent, then the
certificate is considered to be a possible CA; other
extensions are checked according to the intended use of the
certificate. A warning is given in this case because the
certificate should really not be regarded as a CA. However
it is allowed to be a CA to work around some broken
software.</p>

<p style="margin-left:14%; margin-top: 1em">If the
certificate is a V1 certificate (and thus has no extensions)
and it is self-signed, it is also assumed to be a CA but a
warning is again given. This is to work around the problem
of Verisign roots which are V1 self-signed certificates.</p>

<p style="margin-left:14%; margin-top: 1em">If the
<b>keyUsage</b> extension is present, then additional
restraints are made on the uses of the certificate. A CA
certificate must have the <b>keyCertSign</b> bit set if the
<b>keyUsage</b> extension is present.</p>

<p style="margin-left:14%; margin-top: 1em">The extended
key usage extension places additional restrictions on the
certificate uses. If this extension is present, whether
critical or not, the key can only be used for the purposes
specified.</p>

<p style="margin-left:14%; margin-top: 1em">A complete
description of each test is given below. The comments about
<b>basicConstraints</b> and <b>keyUsage</b> and V1
certificates above apply to all CA certificates.</p>

<p style="margin-top: 1em">SSL Client</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the web client
authentication OID. <b>keyUsage</b> must be absent or it
must have the <b>digitalSignature</b> bit set. The Netscape
certificate type must be absent or it must have the SSL
client bit set.</p>

<p style="margin-top: 1em">SSL Client CA</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the web client
authentication OID. The Netscape certificate type must be
absent or it must have the SSL CA bit set: this is used as a
workaround if the <b>basicConstraints</b> extension is
absent.</p>

<p style="margin-top: 1em">SSL Server</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the web server
authentication and/or one of the SGC OIDs. <b>keyUsage</b>
must be absent or it must have the <b>digitalSignature</b>
set, the <b>keyEncipherment</b> set, or both bits set. The
Netscape certificate type must be absent or have the SSL
server bit set.</p>

<p style="margin-top: 1em">SSL Server CA</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the web server
authentication and/or one of the SGC OIDs. The Netscape
certificate type must be absent or the SSL CA bit must be
set: this is used as a workaround if the
<b>basicConstraints</b> extension is absent.</p>

<p style="margin-top: 1em">Netscape SSL Server</p>

<p style="margin-left:22%;">For Netscape SSL clients to
connect to an SSL server; it must have the
<b>keyEncipherment</b> bit set if the <b>keyUsage</b>
extension is present. This isn&rsquo;t always valid because
some cipher suites use the key for digital signing.
Otherwise it is the same as a normal SSL server.</p>

<p style="margin-top: 1em">Common S/MIME Client Tests</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the email protection
OID. The Netscape certificate type must be absent or should
have the S/MIME bit set. If the S/MIME bit is not set in
Netscape certificate type, then the SSL client bit is
tolerated as an alternative but a warning is shown: this is
because some Verisign certificates don&rsquo;t set the
S/MIME bit.</p>

<p style="margin-top: 1em">S/MIME Signing</p>

<p style="margin-left:22%;">In addition to the common
S/MIME client tests, the <b>digitalSignature</b> bit must be
set if the <b>keyUsage</b> extension is present.</p>

<p style="margin-top: 1em">S/MIME Encryption</p>

<p style="margin-left:22%;">In addition to the common
S/MIME tests, the <b>keyEncipherment</b> bit must be set if
the <b>keyUsage</b> extension is present.</p>

<p style="margin-top: 1em">S/MIME CA</p>

<p style="margin-left:22%;">The extended key usage
extension must be absent or include the email protection
OID. The Netscape certificate type must be absent or must
have the S/MIME CA bit set: this is used as a workaround if
the <b>basicConstraints</b> extension is absent.</p>

<p style="margin-top: 1em">CRL Signing</p>

<p style="margin-left:22%;">The <b>keyUsage</b> extension
must be absent or it must have the CRL signing bit set.</p>

<p style="margin-top: 1em">CRL Signing CA</p>

<p style="margin-left:22%;">The normal CA tests apply,
except the <b>basicConstraints</b> extension must be
present.</p>

<p style="margin-top: 1em"><b>-setalias</b> <i>arg</i></p>

<p style="margin-left:14%;">Set the alias of the
certificate, allowing the certificate to be referred to
using a nickname, such as &quot;Steve&rsquo;s
Certificate&quot;.</p>

<p style="margin-top: 1em"><b>-trustout</b></p>

<p style="margin-left:14%;">Output a trusted certificate
(the default if any trust settings are modified). An
ordinary or trusted certificate can be input, but by default
an ordinary certificate is output and any trust settings are
discarded.</p>

<p style="margin-left:6%; margin-top: 1em">The <b>x509</b>
utility can be used to sign certificates and requests: it
can thus behave like a mini CA. The following are x509
signing options:</p>

<p style="margin-top: 1em"><b>-CA</b> <i>file</i></p>

<p style="margin-left:14%;">The CA certificate to be used
for signing. When this option is present, <b>x509</b>
behaves like a mini CA. The input file is signed by the CA
using this option; that is, its issuer name is set to the
subject name of the CA and it is digitally signed using the
CA&rsquo;s private key.</p>

<p style="margin-left:14%; margin-top: 1em">This option is
normally combined with the <b>-req</b> option. Without the
<b>-req</b> option, the input is a certificate which must be
self-signed.</p>

<p style="margin-top: 1em"><b>-CAcreateserial</b></p>

<p style="margin-left:14%;">Create the CA serial number
file if it does not exist instead of generating an error.
The file will contain the serial number &rsquo;02&rsquo; and
the certificate being signed will have &rsquo;1&rsquo; as
its serial number.</p>

<p style="margin-top: 1em"><b>-CAform der</b> |
<b>pem</b></p>

<p style="margin-left:14%;">The format of the CA
certificate file. The default is <b>pem</b>.</p>

<p style="margin-top: 1em"><b>-CAkey</b> <i>file</i></p>

<p style="margin-left:14%;">Set the CA private key to sign
a certificate with. Otherwise it is assumed that the CA
private key is present in the CA certificate file.</p>

<p style="margin-top: 1em"><b>-CAkeyform der</b> |
<b>pem</b></p>

<p style="margin-left:14%;">The format of the CA private
key. The default is <b>pem</b>.</p>

<p style="margin-top: 1em"><b>-CAserial</b> <i>file</i></p>

<p style="margin-left:14%;">Use the serial number in
<i>file</i> to sign a certificate. The file should consist
of one line containing an even number of hex digits with the
serial number to use. After each use the serial number is
incremented and written out to the file again.</p>

<p style="margin-left:14%; margin-top: 1em">The default
filename consists of the CA certificate file base name with
<i>.srl</i> appended. For example, if the CA certificate
file is called <i>mycacert.pem</i>, it expects to find a
serial number file called <i>mycacert.srl</i>.</p>

<p style="margin-top: 1em"><b>-checkend</b> <i>arg</i></p>

<p style="margin-left:14%;">Check whether the certificate
expires in the next <i>arg</i> seconds. If so, exit with
return value 1; otherwise exit with return value 0.</p>

<p style="margin-top: 1em"><b>-clrext</b></p>

<p style="margin-left:14%;">Delete any extensions from a
certificate. This option is used when a certificate is being
created from another certificate (for example with the
<b>-signkey</b> or the <b>-CA</b> options). Normally, all
extensions are retained.</p>

<p style="margin-top: 1em"><b>-days</b> <i>arg</i></p>

<p style="margin-left:14%;">The number of days to make a
certificate valid for. The default is 30 days.</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i></p>

<p style="margin-left:14%;">The section to add certificate
extensions from. If this option is not specified, the
extensions should either be contained in the unnamed
(default) section or the default section should contain a
variable called &quot;extensions&quot; which contains the
section to use.</p>

<p style="margin-top: 1em"><b>-extfile</b> <i>file</i></p>

<p style="margin-left:14%;">File containing certificate
extensions to use. If not specified, no extensions are added
to the certificate.</p>

<p style="margin-top: 1em"><b>-keyform der</b> |
<b>pem</b></p>

<p style="margin-left:14%;">The format of the private key
file used in the <b>-signkey</b> option.</p>

<p style="margin-top: 1em"><b>-req</b></p>

<p style="margin-left:14%; margin-top: 1em">Expect a
certificate request on input instead of a certificate.</p>

<p style="margin-top: 1em"><b>-set_serial</b> <i>n</i></p>

<p style="margin-left:14%;">The serial number to use. This
option can be used with either the <b>-signkey</b> or
<b>-CA</b> options. If used in conjunction with the
<b>-CA</b> option, the serial number file (as specified by
the <b>-CAserial</b> or <b>-CAcreateserial</b> options) is
not used.</p>

<p style="margin-left:14%; margin-top: 1em">The serial
number can be decimal or hex (if preceded by
&rsquo;0x&rsquo;). Negative serial numbers can also be
specified but their use is not recommended.</p>

<p style="margin-top: 1em"><b>-signkey</b> <i>file</i></p>

<p style="margin-left:14%;">Self-sign <i>file</i> using the
supplied private key.</p>

<p style="margin-left:14%; margin-top: 1em">If the input
file is a certificate, it sets the issuer name to the
subject name (i.e. makes it self-signed), changes the public
key to the supplied value, and changes the start and end
dates. The start date is set to the current time and the end
date is set to a value determined by the <b>-days</b>
option. Any certificate extensions are retained unless the
<b>-clrext</b> option is supplied.</p>

<p style="margin-left:14%; margin-top: 1em">If the input is
a certificate request, a self-signed certificate is created
using the supplied private key using the subject name in the
request.</p>

<p style="margin-top: 1em"><b>-x509toreq</b></p>

<p style="margin-left:14%;">Convert a certificate into a
certificate request. The <b>-signkey</b> option is used to
pass the required private key.</p>

<p style="margin-top: 1em"><b>COMMON NOTATION</b></p>

<p style="margin-left:6%;">Several commands share a common
syntax, as detailed below.</p>

<p style="margin-left:6%; margin-top: 1em">Password
arguments, typically specified using <b>-passin</b> and
<b>-passout</b> for input and output passwords, allow
passwords to be obtained from a variety of sources. Both of
these options take a single argument, described below. If no
password argument is given and a password is required, then
the user is prompted to enter one: this will typically be
read from the current terminal with echoing turned off.</p>

<p style="margin-top: 1em"><b>pass</b>:<i>password</i></p>

<p style="margin-left:33%; margin-top: 1em">The actual
password is <i>password</i>. Since the password is visible
to utilities, this form should only be used where security
is not important.</p>

<p style="margin-top: 1em"><b>env</b>:<i>var</i></p>

<p style="margin-left:33%; margin-top: 1em">Obtain the
password from the environment variable <i>var</i>. Since the
environment of other processes is visible, this option
should be used with caution.</p>

<p style="margin-top: 1em"><b>file</b>:<i>path</i></p>

<p style="margin-left:33%; margin-top: 1em">The first line
of <i>path</i> is the password. If the same <i>path</i>
argument is supplied to <b>-passin</b> and <b>-passout</b>,
then the first line will be used for the input password and
the next line for the output password. <i>path</i> need not
refer to a regular file: it could, for example, refer to a
device or named pipe.</p>

<p style="margin-top: 1em"><b>fd</b>:<i>number</i></p>

<p style="margin-left:33%; margin-top: 1em">Read the
password from the file descriptor <i>number</i>. This can be
used to send the data via a pipe, for example.</p>

<p style="margin-top: 1em"><b>stdin</b></p>

<p style="margin-left:33%; margin-top: 1em">Read the
password from standard input.</p>

<p style="margin-left:6%; margin-top: 1em">Input/output
formats, typically specified using <b>-inform</b> and
<b>-outform</b>, indicate the format being read from or
written to. The argument is case insensitive.</p>

<p style="margin-top: 1em"><b>der</b></p>

<p style="margin-left:24%; margin-top: 1em">Distinguished
Encoding Rules (DER) is a binary format.</p>

<p><b>net</b></p>

<p style="margin-left:24%; margin-top: 1em">Insecure legacy
format.</p>

<p><b>pem</b></p>

<p style="margin-left:24%; margin-top: 1em">Privacy
Enhanced Mail (PEM) is base64-encoded.</p>

<p><b>smime</b></p>

<p style="margin-left:24%; margin-top: 1em">An SMIME format
message.</p>

<p><b>txt</b></p>

<p style="margin-left:24%; margin-top: 1em">Plain ASCII
text.</p>

<p style="margin-top: 1em"><b>ENVIRONMENT</b></p>

<p style="margin-left:6%;">The following environment
variables affect the execution of <b>openssl</b>:</p>

<p style="margin-top: 1em">OPENSSL_CONF</p>

<p style="margin-left:35%; margin-top: 1em">The location of
the master configuration file.</p>

<p style="margin-top: 1em"><b>FILES</b> <br>
/etc/ssl/</p>

<p style="margin-left:35%; margin-top: 1em">Default config
directory for <b>openssl</b>.</p>

<p>/etc/ssl/lib/</p>

<p style="margin-left:35%; margin-top: 1em">Unused.</p>

<p>/etc/ssl/private/</p>

<p style="margin-left:35%; margin-top: 1em">Default private
key directory.</p>

<p>/etc/ssl/openssl.cnf</p>

<p style="margin-left:35%; margin-top: 1em">Default
configuration file for <b>openssl</b>.</p>

<p>/etc/ssl/x509v3.cnf</p>

<p style="margin-left:35%; margin-top: 1em">Default
configuration file for <b>x509</b> certificates.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">acme-client(1), nc(1),
openssl.cnf(5), x509v3.cnf(5), ssl(8), starttls(8)</p>

<p style="margin-top: 1em"><b>STANDARDS</b> <br>
T. Dierks</p>

<p style="margin-left:6%;">and</p>

<p>C. Allen , <i><br>
The TLS Protocol Version 1.0</i> , <br>
RFC 2246 , <br>
January 1999 .</p>

<p style="margin-top: 1em">M. Wahl</p>

<p style="margin-left:6%;">,</p>

<p>S. Killie , and <br>
T. Howes , <i><br>
Lightweight Directory Access Protocol (v3): UTF-8 String
Representation of Distinguished Names</i> , <br>
RFC 2253 , <br>
December 1997 .</p>

<p style="margin-top: 1em">B. Kaliski</p>

<p style="margin-left:6%;">,</p>

<p><i>PKCS #7: Cryptographic Message Syntax Version 1.5</i>
, <br>
RFC 2315 , <br>
March 1998 .</p>

<p style="margin-top: 1em">R. Housley</p>

<p style="margin-left:6%;">,</p>

<p>W. Ford , <br>
W. Polk , and <br>
D. Solo , <i><br>
Internet X.509 Public Key Infrastructure Certificate and CRL
Profile</i> , <br>
RFC 2459 , <br>
January 1999 .</p>

<p style="margin-top: 1em">M. Myers</p>

<p style="margin-left:6%;">,</p>

<p>R. Ankney , <br>
A. Malpani , <br>
S. Galperin , and <br>
C. Adams , <i><br>
X.509 Internet Public Key Infrastructure Online Certificate
Status Protocol &ndash; OCSP</i> , <br>
RFC 2560 , <br>
June 1999 .</p>

<p style="margin-top: 1em">R. Housley</p>

<p style="margin-left:6%;">,</p>

<p><i>Cryptographic Message Syntax</i> , <br>
RFC 2630 , <br>
June 1999 .</p>

<p style="margin-top: 1em">P. Chown</p>

<p style="margin-left:6%;">,</p>

<p><i>Advanced Encryption Standard (AES) Ciphersuites for
Transport Layer Security (TLS)</i> , <br>
RFC 3268 , <br>
June 2002 .</p>

<p style="margin-left:6%; margin-top: 1em">BSD
August&nbsp;24, 2018 BSD</p>
<hr>
</body>
</html>
