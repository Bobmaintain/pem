<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Tue Feb  1 14:19:52 2022 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>OPENSSL(1) BSD General Commands Manual OPENSSL(1)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>openssl</b> &mdash; OpenSSL
command line tool</p>

<p style="margin-top: 1em"><b>SYNOPSIS</b></p>

<p style="margin-left:17%;"><b>openssl command</b>
[<i>command_opts</i>] [<i>command_args</i>]</p>

<p style="margin-left:17%; margin-top: 1em"><b>openssl
list-standard-commands</b> |
<b>list-message-digest-commands</b> |
<b>list-cipher-commands</b> | <b>list-cipher-algorithms</b>
| <b>list-message-digest-algorithms</b> |
<b>list-public-key-algorithms</b></p>

<p style="margin-left:17%; margin-top: 1em"><b>openssl
no-</b><i>command</i></p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;"><b>OpenSSL</b> is a cryptography
toolkit implementing the Transport Layer Security (TLS v1)
network protocol, as well as related cryptography
standards.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>openssl</b> program is a command line tool for using the
various cryptography functions of <b>openssl</b>&rsquo;s
crypto library from the shell.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-commands <b>list-standard-commands</b>,
<b>list-message-digest-commands</b>, and
<b>list-cipher-commands</b> output a list (one entry per
line) of the names of all standard commands, message digest
commands, or cipher commands, respectively, that are
available in the present <b>openssl</b> utility.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-commands <b>list-cipher-algorithms</b> and
<b>list-message-digest-algorithms</b> list all cipher and
message digest names, one entry per line. Aliases are listed
as:</p>

<p style="margin-left:14%; margin-top: 1em">from =&gt;
to</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-command <b>list-public-key-algorithms</b> lists all
supported public key algorithms.</p>

<p style="margin-left:6%; margin-top: 1em">The
pseudo-command <b>no-</b><i>command</i> tests whether a
command of the specified name is available. If
<i>command</i> does not exist, it returns 0 and prints
<b>no-</b><i>command</i>; otherwise it returns 1 and prints
<i>command</i>. In both cases, the output goes to stdout and
nothing is printed to stderr. Additional command line
arguments are always ignored. Since for each cipher there is
a command of the same name, this provides an easy way for
shell scripts to test for the availability of ciphers in the
<b>openssl</b> program.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>:
<b>no-</b><i>command</i> is not able to detect
pseudo-commands such as <b>quit</b>,
<b>list-</b><i>...</i><b>-commands</b>, or
<b>no-</b><i>command</i> itself.</p>

<p style="margin-top: 1em"><b>ASN1PARSE</b></p>

<p style="margin-left:6%;"><b>openssl asn1parse</b>
[<b>-i</b>] [<b>-dlimit</b> <i>number</i>] [<b>-dump</b>]
[<b>-genconf</b> <i>file</i>] [<b>-genstr</b> <i>str</i>]
[<b>-in</b> <i>file</i>] [<b>-inform der</b> | <b>pem</b> |
<b>txt</b>] [<b>-length</b> <i>number</i>] [<b>-noout</b>]
[<b>-offset</b> <i>number</i>] [<b>-oid</b> <i>file</i>]
[<b>-out</b> <i>file</i>] [<b>-strparse</b>
<i>offset</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>asn1parse</b> command is a diagnostic utility that can
parse ASN.1 structures. It can also be used to extract data
from ASN.1 formatted data.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-dlimit</b> <i>number</i></p>

<p style="margin-left:17%;">Dump the first <i>number</i>
bytes of unknown data in hex form.</p>

<p style="margin-top: 1em"><b>-dump</b></p>

<p style="margin-left:17%; margin-top: 1em">Dump unknown
data in hex form.</p>

<p style="margin-top: 1em"><b>-genconf</b> <i>file</i>,
<b>-genstr</b> <i>str</i></p>

<p style="margin-left:17%;">Generate encoded data based on
string <i>str</i>, file <i>file</i>, or both, using the
format described in ASN1_generate_nconf(3). If only
<i>file</i> is present then the string is obtained from the
default section using the name &ldquo;asn1&rdquo;. The
encoded data is passed through the ASN1 parser and printed
out as though it came from a file; the contents can thus be
examined and written to a file using the <b>-out</b>
option.</p>

<p style="margin-top: 1em"><b>-i</b></p>

<p style="margin-left:17%; margin-top: 1em">Indent the
output according to the &quot;depth&quot; of the
structures.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file; the default is
standard input.</p>

<p style="margin-top: 1em"><b>-inform der</b> | <b>pem</b>
| <b>txt</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-length</b> <i>number</i></p>

<p style="margin-left:17%;">Number of bytes to parse; the
default is until end of file.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output the parsed version of the input file.</p>

<p style="margin-top: 1em"><b>-offset</b> <i>number</i></p>

<p style="margin-left:17%;">Starting offset to begin
parsing; the default is start of file.</p>

<p style="margin-top: 1em"><b>-oid</b> <i>file</i></p>

<p style="margin-left:17%;">A file containing additional
object identifiers (OIDs). If an OID (object identifier) is
not part of <b>openssl</b>&rsquo;s internal table it will be
represented in numerical form (for example 1.2.3.4).</p>

<p style="margin-left:17%; margin-top: 1em">Each line
consists of three columns: the first column is the OID in
numerical format and should be followed by whitespace. The
second column is the &quot;short name&quot;, which is a
single word followed by whitespace. The final column is the
rest of the line and is the &quot;long name&quot;.
<b>asn1parse</b> displays the long name.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The DER-encoded output file;
the default is no encoded output (useful when combined with
<b>-strparse</b>).</p>

<p style="margin-top: 1em"><b>-strparse</b>
<i>offset</i></p>

<p style="margin-left:17%;">Parse the content octets of the
ASN.1 object starting at <i>offset</i>. This option can be
used multiple times to &quot;drill down&quot; into a nested
structure.</p>

<p style="margin-top: 1em"><b>CA</b></p>

<p style="margin-left:6%;"><b>openssl ca</b>
[<b>-batch</b>] [<b>-cert</b> <i>file</i>] [<b>-config</b>
<i>file</i>] [<b>-crl_CA_compromise</b> <i>time</i>]
[<b>-crl_compromise</b> <i>time</i>] [<b>-crl_hold</b>
<i>instruction</i>] [<b>-crl_reason</b> <i>reason</i>]
[<b>-crldays</b> <i>days</i>] [<b>-crlexts</b>
<i>section</i>] [<b>-crlhours</b> <i>hours</i>]
[<b>-days</b> <i>arg</i>] [<b>-enddate</b> <i>date</i>]
[<b>-extensions</b> <i>section</i>] [<b>-extfile</b>
<i>section</i>] [<b>-gencrl</b>] [<b>-in</b> <i>file</i>]
[<b>-infiles</b>] [<b>-key</b> <i>keyfile</i>]
[<b>-keyfile</b> <i>arg</i>] [<b>-keyform</b> <i>PEM</i>]
[<b>-md</b> <i>arg</i>] [<b>-msie_hack</b>] [<b>-name</b>
<i>section</i>] [<b>-noemailDN</b>] [<b>-notext</b>]
[<b>-out</b> <i>file</i>] [<b>-outdir</b> <i>dir</i>]
[<b>-passin</b> <i>arg</i>] [<b>-policy</b> <i>arg</i>]
[<b>-preserveDN</b>] [<b>-revoke</b> <i>file</i>]
[<b>-spkac</b> <i>file</i>] [<b>-ss_cert</b> <i>file</i>]
[<b>-startdate</b> <i>date</i>] [<b>-status</b>
<i>serial</i>] [<b>-subj</b> <i>arg</i>] [<b>-updatedb</b>]
[<b>-verbose</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ca</b>
command is a minimal certificate authority (CA) application.
It can be used to sign certificate requests in a variety of
forms and generate certificate revocation lists (CRLs). It
also maintains a text database of issued certificates and
their status.</p>

<p style="margin-left:6%; margin-top: 1em">The options
relevant to CAs are as follows:</p>

<p style="margin-top: 1em"><b>-batch</b></p>

<p style="margin-left:14%;">This sets the batch mode. In
this mode no questions will be asked and all certificates
will be certified automatically.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:14%;">The CA certificate file.</p>

<p style="margin-top: 1em"><b>-config</b> <i>file</i></p>

<p style="margin-left:14%;">Specifies the configuration
file to use.</p>

<p style="margin-top: 1em"><b>-days</b> <i>arg</i></p>

<p style="margin-left:14%;">The number of days to certify
the certificate for.</p>

<p style="margin-top: 1em"><b>-enddate</b> <i>date</i></p>

<p style="margin-left:14%;">This allows the expiry date to
be explicitly set. The format of the date is YYMMDDHHMMSSZ
(the same as an ASN1 UTCTime structure).</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i></p>

<p style="margin-left:14%;">The section of the
configuration file containing certificate extensions to be
added when a certificate is issued (defaults to
<b>x509_extensions</b> unless the <b>-extfile</b> option is
used). If no extension section is present, a V1 certificate
is created. If the extension section is present (even if it
is empty), then a V3 certificate is created.</p>

<p style="margin-top: 1em"><b>-extfile</b> <i>file</i></p>

<p style="margin-left:14%;">An additional configuration
<i>file</i> to read certificate extensions from (using the
default section unless the <b>-extensions</b> option is also
used).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">An input <i>file</i> containing
a single certificate request to be signed by the CA.</p>

<p style="margin-top: 1em"><b>-infiles</b></p>

<p style="margin-left:14%;">If present, this should be the
last option; all subsequent arguments are assumed to be the
names of files containing certificate requests.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:14%;">The password used to encrypt
the private key. Since on some systems the command line
arguments are visible, this option should be used with
caution.</p>

<p style="margin-top: 1em"><b>-keyfile</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to sign
requests with.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>PEM</i></p>

<p style="margin-left:14%;">Private key file format.</p>

<p style="margin-top: 1em"><b>-md</b> <i>alg</i></p>

<p style="margin-left:14%;">The message digest to use.
Possible values include <i>md5</i> and <i>sha1</i>. This
option also applies to CRLs.</p>

<p style="margin-top: 1em"><b>-msie_hack</b></p>

<p style="margin-left:14%;">This is a legacy option to make
<b>ca</b> work with very old versions of the IE certificate
enrollment control &quot;certenr3&quot;. It used
UniversalStrings for almost everything. Since the old
control has various security bugs, its use is strongly
discouraged. The newer control &quot;Xenroll&quot; does not
need this option.</p>

<p style="margin-top: 1em"><b>-name</b> <i>section</i></p>

<p style="margin-left:14%;">Specifies the configuration
file <i>section</i> to use (overrides <b>default_ca</b> in
the <b>ca</b> section).</p>

<p style="margin-top: 1em"><b>-noemailDN</b></p>

<p style="margin-left:14%;">The DN of a certificate can
contain the EMAIL field if present in the request DN,
however it is good policy just having the email set into the
<b>altName</b> extension of the certificate. When this
option is set, the EMAIL field is removed from the
certificate&rsquo;s subject and set only in the, eventually
present, extensions. The <i>email_in_dn</i> keyword can be
used in the configuration file to enable this behaviour.</p>

<p style="margin-top: 1em"><b>-notext</b></p>

<p style="margin-left:14%;">Don&rsquo;t output the text
form of a certificate to the output file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The output file to output
certificates to. The default is standard output. The
certificate details will also be printed out to this
file.</p>

<p style="margin-top: 1em"><b>-outdir</b>
<i>directory</i></p>

<p style="margin-left:14%;">The <i>directory</i> to output
certificates to. The certificate will be written to a file
consisting of the serial number in hex with &quot;.pem&quot;
appended.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-policy</b> <i>arg</i></p>

<p style="margin-left:14%;">This option defines the CA
&quot;policy&quot; to use. The policy section in the
configuration file consists of a set of variables
corresponding to certificate DN fields. The values may be
one of &quot;match&quot; (the value must match the same
field in the CA certificate), &quot;supplied&quot; (the
value must be present), or &quot;optional&quot; (the value
may be present). Any fields not mentioned in the policy
section are silently deleted, unless the <b>-preserveDN</b>
option is set, but this can be regarded more of a quirk than
intended behaviour.</p>

<p style="margin-top: 1em"><b>-preserveDN</b></p>

<p style="margin-left:14%;">Normally, the DN order of a
certificate is the same as the order of the fields in the
relevant policy section. When this option is set, the order
is the same as the request. This is largely for
compatibility with the older IE enrollment control which
would only accept certificates if their DNs matched the
order of the request. This is not needed for Xenroll.</p>

<p style="margin-top: 1em"><b>-spkac</b> <i>file</i></p>

<p style="margin-left:14%;">A file containing a single
Netscape signed public key and challenge, and additional
field values to be signed by the CA. This will usually come
from the KEYGEN tag in an HTML form to create a new private
key. It is, however, possible to create SPKACs using the
<b>spkac</b> utility.</p>

<p style="margin-left:14%; margin-top: 1em">The file should
contain the variable SPKAC set to the value of the SPKAC and
also the required DN components as name value pairs. If
it&rsquo;s necessary to include the same component twice,
then it can be preceded by a number and a
&rsquo;.&rsquo;.</p>

<p style="margin-top: 1em"><b>-ss_cert</b> <i>file</i></p>

<p style="margin-left:14%;">A single self-signed
certificate to be signed by the CA.</p>

<p style="margin-top: 1em"><b>-startdate</b>
<i>date</i></p>

<p style="margin-left:14%;">This allows the start date to
be explicitly set. The format of the date is YYMMDDHHMMSSZ
(the same as an ASN1 UTCTime structure).</p>

<p style="margin-top: 1em"><b>-status</b> <i>serial</i></p>

<p style="margin-left:14%;">Show the status of the
certificate with serial number <i>serial</i>.</p>

<p style="margin-top: 1em"><b>-updatedb</b></p>

<p style="margin-left:14%;">Update database for expired
certificates.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:14%;">This prints extra details about
the operations being performed.</p>

<p style="margin-left:6%; margin-top: 1em">The options
relevant to CRLs are as follows:</p>

<p style="margin-top: 1em"><b>-crl_CA_compromise</b>
<i>time</i></p>

<p style="margin-left:14%;">This is the same as
<b>-crl_compromise</b>, except the revocation reason is set
to CACompromise.</p>

<p style="margin-top: 1em"><b>-crl_compromise</b>
<i>time</i></p>

<p style="margin-left:14%;">This sets the revocation reason
to keyCompromise and the compromise time to <i>time</i>.
<i>time</i> should be in GeneralizedTime format, i.e.
YYYYMMDDHHMMSSZ.</p>

<p style="margin-top: 1em"><b>-crl_hold</b>
<i>instruction</i></p>

<p style="margin-left:14%;">This sets the CRL revocation
reason code to certificateHold and the hold instruction to
<i>instruction</i> which must be an OID. Although any OID
can be used, only holdInstructionNone (the use of which is
discouraged by RFC 2459), holdInstructionCallIssuer or
holdInstructionReject will normally be used.</p>

<p style="margin-top: 1em"><b>-crl_reason</b>
<i>reason</i></p>

<p style="margin-left:14%;">Revocation reason, where
<i>reason</i> is one of: unspecified, keyCompromise,
CACompromise, affiliationChanged, superseded,
cessationOfOperation, certificateHold or removeFromCRL. The
matching of <i>reason</i> is case insensitive. Setting any
revocation reason will make the CRL v2. In practice,
removeFromCRL is not particularly useful because it is only
used in delta CRLs which are not currently implemented.</p>

<p style="margin-top: 1em"><b>-crldays</b> <i>num</i></p>

<p style="margin-left:14%;">The number of days before the
next CRL is due. This is the days from now to place in the
CRL <b>nextUpdate</b> field.</p>

<p style="margin-top: 1em"><b>-crlexts</b>
<i>section</i></p>

<p style="margin-left:14%;">The <i>section</i> of the
configuration file containing CRL extensions to include. If
no CRL extension section is present then a V1 CRL is
created; if the CRL extension section is present (even if it
is empty) then a V2 CRL is created. The CRL extensions
specified are CRL extensions and <i>not</i> CRL entry
extensions. It should be noted that some software (for
example Netscape) can&rsquo;t handle V2 CRLs.</p>

<p style="margin-top: 1em"><b>-crlhours</b> <i>num</i></p>

<p style="margin-left:14%;">The number of hours before the
next CRL is due.</p>

<p style="margin-top: 1em"><b>-gencrl</b></p>

<p style="margin-left:14%;">This option generates a CRL
based on information in the index file.</p>

<p style="margin-top: 1em"><b>-revoke</b> <i>file</i></p>

<p style="margin-left:14%;">A <i>file</i> containing a
certificate to revoke.</p>

<p style="margin-top: 1em"><b>-subj</b> <i>arg</i></p>

<p style="margin-left:14%;">Supersedes the subject name
given in the request. The <i>arg</i> must be formatted as
<i>/type0=value0/type1=value1/type2=...</i>; characters may
be escaped by &rsquo;\&rsquo; (backslash), no spaces are
skipped.</p>

<p style="margin-left:6%; margin-top: 1em">Many of the
options can be set in the <b>ca</b> section of the
configuration file (or in the default section of the
configuration file), specified using <b>default_ca</b> or
<b>-name</b>. The options <b>preserve</b> and
<b>msie_hack</b> are read directly from the <b>ca</b>
section.</p>

<p style="margin-left:6%; margin-top: 1em">Many of the
configuration file options are identical to command line
options. Where the option is present in the configuration
file and the command line, the command line value is used.
Where an option is described as mandatory, then it must be
present in the configuration file or the command line
equivalent (if any) used.</p>

<p style="margin-top: 1em"><b>certificate</b></p>

<p style="margin-left:14%;">The same as <b>-cert</b>. It
gives the file containing the CA certificate. Mandatory.</p>

<p style="margin-top: 1em"><b>copy_extensions</b></p>

<p style="margin-left:14%;">Determines how extensions in
certificate requests should be handled. If set to
<b>none</b> or this option is not present, then extensions
are ignored and not copied to the certificate. If set to
<b>copy</b>, then any extensions present in the request that
are not already present are copied to the certificate. If
set to <b>copyall</b>, then all extensions in the request
are copied to the certificate: if the extension is already
present in the certificate it is deleted first.</p>

<p style="margin-left:14%; margin-top: 1em">The
<b>copy_extensions</b> option should be used with caution.
If care is not taken, it can be a security risk. For
example, if a certificate request contains a
<b>basicConstraints</b> extension with CA:TRUE and the
<b>copy_extensions</b> value is set to <b>copyall</b> and
the user does not spot this when the certificate is
displayed, then this will hand the requestor a valid CA
certificate.</p>

<p style="margin-left:14%; margin-top: 1em">This situation
can be avoided by setting <b>copy_extensions</b> to
<b>copy</b> and including <b>basicConstraints</b> with
CA:FALSE in the configuration file. Then if the request
contains a <b>basicConstraints</b> extension, it will be
ignored.</p>

<p style="margin-left:14%; margin-top: 1em">The main use of
this option is to allow a certificate request to supply
values for certain extensions such as
<b>subjectAltName</b>.</p>

<p style="margin-top: 1em"><b>crl_extensions</b></p>

<p style="margin-left:14%;">The same as
<b>-crlexts</b>.</p>

<p style="margin-top: 1em"><b>crlnumber</b></p>

<p style="margin-left:14%;">A text file containing the next
CRL number to use in hex. The CRL number will be inserted in
the CRLs only if this file exists. If this file is present,
it must contain a valid CRL number.</p>

<p style="margin-top: 1em"><b>database</b></p>

<p style="margin-left:14%;">The text database file to use.
Mandatory. This file must be present, though initially it
will be empty.</p>

<p style="margin-top: 1em"><b>default_crl_hours</b>,
<b>default_crl_days</b></p>

<p style="margin-left:14%;">The same as the
<b>-crlhours</b> and <b>-crldays</b> options. These will
only be used if neither command line option is present. At
least one of these must be present to generate a CRL.</p>

<p style="margin-top: 1em"><b>default_days</b></p>

<p style="margin-left:14%;">The same as the <b>-days</b>
option. The number of days to certify a certificate for.</p>

<p style="margin-top: 1em"><b>default_enddate</b></p>

<p style="margin-left:14%;">The same as the <b>-enddate</b>
option. Either this option or <b>default_days</b> (or the
command line equivalents) must be present.</p>

<p style="margin-top: 1em"><b>default_md</b></p>

<p style="margin-left:14%;">The same as the <b>-md</b>
option. The message digest to use. Mandatory.</p>

<p style="margin-top: 1em"><b>default_startdate</b></p>

<p style="margin-left:14%;">The same as the
<b>-startdate</b> option. The start date to certify a
certificate for. If not set, the current time is used.</p>

<p style="margin-top: 1em"><b>email_in_dn</b></p>

<p style="margin-left:14%;">The same as <b>-noemailDN</b>.
If the EMAIL field is to be removed from the DN of the
certificate, simply set this to &quot;no&quot;. If not
present, the default is to allow for the EMAIL field in the
certificate&rsquo;s DN.</p>

<p style="margin-top: 1em"><b>msie_hack</b></p>

<p style="margin-left:14%;">The same as
<b>-msie_hack</b>.</p>

<p style="margin-top: 1em"><b>name_opt</b>,
<b>cert_opt</b></p>

<p style="margin-left:14%;">These options allow the format
used to display the certificate details when asking the user
to confirm signing. All the options supported by the
<b>x509</b> utilities&rsquo; <b>-nameopt</b> and
<b>-certopt</b> switches can be used here, except that
<b>no_signame</b> and <b>no_sigdump</b> are permanently set
and cannot be disabled (this is because the certificate
signature cannot be displayed because the certificate has
not been signed at this point).</p>

<p style="margin-left:14%; margin-top: 1em">For
convenience, the value <b>ca_default</b> is accepted by both
to produce a reasonable output.</p>

<p style="margin-left:14%; margin-top: 1em">If neither
option is present, the format used in earlier versions of
<b>openssl</b> is used. Use of the old format is
<i>strongly</i> discouraged because it only displays fields
mentioned in the <b>policy</b> section, mishandles
multicharacter string types and does not display
extensions.</p>

<p style="margin-top: 1em"><b>new_certs_dir</b></p>

<p style="margin-left:14%;">The same as the <b>-outdir</b>
command line option. It specifies the directory where new
certificates will be placed. Mandatory.</p>

<p style="margin-top: 1em"><b>oid_file</b></p>

<p style="margin-left:14%;">This specifies a file
containing additional object identifiers. Each line of the
file should consist of the numerical form of the object
identifier followed by whitespace, then the short name
followed by whitespace and finally the long name.</p>

<p style="margin-top: 1em"><b>oid_section</b></p>

<p style="margin-left:14%;">This specifies a section in the
configuration file containing extra object identifiers. Each
line should consist of the short name of the object
identifier followed by &rsquo;=&rsquo; and the numerical
form. The short and long names are the same when this option
is used.</p>

<p style="margin-top: 1em"><b>policy</b></p>

<p style="margin-left:14%;">The same as <b>-policy</b>.
Mandatory.</p>

<p style="margin-top: 1em"><b>preserve</b></p>

<p style="margin-left:14%;">The same as
<b>-preserveDN</b>.</p>

<p style="margin-top: 1em"><b>private_key</b></p>

<p style="margin-left:14%;">Same as the <b>-keyfile</b>
option. The file containing the CA private key.
Mandatory.</p>

<p style="margin-top: 1em"><b>serial</b></p>

<p style="margin-left:14%;">A text file containing the next
serial number to use in hex. Mandatory. This file must be
present and contain a valid serial number.</p>

<p style="margin-top: 1em"><b>unique_subject</b></p>

<p style="margin-left:14%;">If the value <b>yes</b> is
given, the valid certificate entries in the database must
have unique subjects. If the value <b>no</b> is given,
several valid certificate entries may have the exact same
subject. The default value is <b>yes</b>.</p>

<p style="margin-top: 1em"><b>x509_extensions</b></p>

<p style="margin-left:14%;">The same as
<b>-extensions</b>.</p>

<p style="margin-top: 1em"><b>CIPHERS</b></p>

<p style="margin-left:6%;"><b>openssl ciphers</b>
[<b>-hVv</b>] [<b>-tls1</b>] [<i>cipherlist</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>ciphers</b> command converts <b>openssl</b> cipher lists
into ordered SSL cipher preference lists. It can be used as
a test tool to determine the appropriate cipherlist.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-h</b>, <b>-?</b></p>

<p style="margin-left:17%; margin-top: 1em">Print a brief
usage message.</p>

<p style="margin-top: 1em"><b>-tls1</b></p>

<p style="margin-left:17%; margin-top: 1em">Only include
TLS v1 ciphers.</p>

<p style="margin-top: 1em"><b>-V</b></p>

<p style="margin-left:17%; margin-top: 1em">Verbose. List
ciphers with a complete description of protocol version, key
exchange, authentication, encryption and mac algorithms, any
key size restrictions, and cipher suite codes (hex
format).</p>

<p style="margin-top: 1em"><b>-v</b></p>

<p style="margin-left:17%; margin-top: 1em">Like <b>-V</b>,
but without cipher suite codes.</p>

<p style="margin-top: 1em"><i>cipherlist</i></p>

<p style="margin-left:17%;">A cipher list to convert to a
cipher preference list. If it is not included, the default
cipher list will be used.</p>

<p style="margin-left:17%; margin-top: 1em">The cipher list
consists of one or more cipher strings separated by colons.
Commas or spaces are also acceptable separators, but colons
are normally used.</p>

<p style="margin-left:17%; margin-top: 1em">The actual
cipher string can take several different forms:</p>

<p style="margin-left:17%; margin-top: 1em">It can consist
of a single cipher suite, such as RC4-SHA.</p>

<p style="margin-left:17%; margin-top: 1em">It can
represent a list of cipher suites containing a certain
algorithm, or cipher suites of a certain type. For example
SHA1 represents all cipher suites using the digest algorithm
SHA1.</p>

<p style="margin-left:17%; margin-top: 1em">Lists of cipher
suites can be combined in a single cipher string using the
&rsquo;+&rsquo; character (logical AND operation). For
example, SHA1+DES represents all cipher suites containing
the SHA1 and DES algorithms.</p>

<p style="margin-left:17%; margin-top: 1em">Each cipher
string can be optionally preceded by the characters
&rsquo;!&rsquo;, &rsquo;-&rsquo;, or &rsquo;+&rsquo;. If
&rsquo;!&rsquo; is used, then the ciphers are permanently
deleted from the list. The ciphers deleted can never
reappear in the list even if they are explicitly stated. If
&rsquo;-&rsquo; is used, then the ciphers are deleted from
the list, but some or all of the ciphers can be added again
by later options. If &rsquo;+&rsquo; is used, then the
ciphers are moved to the end of the list. This option
doesn&rsquo;t add any new ciphers, it just moves matching
existing ones.</p>

<p style="margin-left:17%; margin-top: 1em">If none of
these characters is present, the string is just interpreted
as a list of ciphers to be appended to the current
preference list. If the list includes any ciphers already
present, they will be ignored; that is, they will not be
moved to the end of the list.</p>

<p style="margin-left:17%; margin-top: 1em">Additionally,
the cipher string <b>@STRENGTH</b> can be used at any point
to sort the current cipher list in order of encryption
algorithm key length.</p>

<p style="margin-left:6%; margin-top: 1em">The following is
a list of all permitted cipher strings and their
meanings.</p>

<p style="margin-top: 1em"><b>DEFAULT</b></p>

<p style="margin-left:14%;">The default cipher list. This
is determined at compile time and is currently
<b>ALL:!aNULL:!eNULL:!SSLv2</b>. This must be the first
cipher string specified.</p>

<p style="margin-top: 1em"><b>COMPLEMENTOFDEFAULT</b></p>

<p style="margin-left:14%;">The ciphers included in
<b>ALL</b>, but not enabled by default. Currently this is
<b>ADH</b>. Note that this rule does not cover <b>eNULL</b>,
which is not included by <b>ALL</b> (use
<b>COMPLEMENTOFALL</b> if necessary).</p>

<p style="margin-top: 1em"><b>ALL</b></p>

<p style="margin-left:14%; margin-top: 1em">All cipher
suites except the <b>eNULL</b> ciphers, which must be
explicitly enabled.</p>

<p style="margin-top: 1em"><b>COMPLEMENTOFALL</b></p>

<p style="margin-left:14%;">The cipher suites not enabled
by <b>ALL</b>, currently being <b>eNULL</b>.</p>

<p style="margin-top: 1em"><b>HIGH</b></p>


<p style="margin-left:14%; margin-top: 1em">&quot;High&quot;
encryption cipher suites. This currently means those with
key lengths larger than 128 bits.</p>

<p style="margin-top: 1em"><b>MEDIUM</b></p>

<p style="margin-left:14%;">&quot;Medium&quot; encryption
cipher suites, currently those using 128-bit encryption.</p>

<p style="margin-top: 1em"><b>LOW</b></p>


<p style="margin-left:14%; margin-top: 1em">&quot;Low&quot;
encryption cipher suites, currently those using 64- or
56-bit encryption algorithms.</p>

<p style="margin-top: 1em"><b>eNULL</b>, <b>NULL</b></p>

<p style="margin-left:14%;">The &quot;NULL&quot; ciphers;
that is, those offering no encryption. Because these offer
no encryption at all and are a security risk, they are
disabled unless explicitly included.</p>

<p style="margin-top: 1em"><b>aNULL</b></p>

<p style="margin-left:14%;">The cipher suites offering no
authentication. This is currently the anonymous DH
algorithms. These cipher suites are vulnerable to a
&quot;man in the middle&quot; attack, so their use is
normally discouraged.</p>

<p style="margin-top: 1em"><b>kRSA</b>, <b>RSA</b></p>

<p style="margin-left:14%;">Cipher suites using RSA key
exchange.</p>

<p style="margin-top: 1em"><b>kEDH</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using ephemeral DH key agreement.</p>

<p style="margin-top: 1em"><b>aRSA</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using RSA authentication, i.e. the certificates carry RSA
keys.</p>

<p style="margin-top: 1em"><b>aDSS</b>, <b>DSS</b></p>

<p style="margin-left:14%;">Cipher suites using DSS
authentication, i.e. the certificates carry DSS keys.</p>

<p style="margin-top: 1em"><b>TLSv1</b></p>

<p style="margin-left:14%;">TLS v1.0 cipher suites.</p>

<p style="margin-top: 1em"><b>DH</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using DH, including anonymous DH.</p>

<p style="margin-top: 1em"><b>ADH</b></p>

<p style="margin-left:14%; margin-top: 1em">Anonymous DH
cipher suites.</p>

<p style="margin-top: 1em"><b>AES</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using AES.</p>

<p style="margin-top: 1em"><b>3DES</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using triple DES.</p>

<p style="margin-top: 1em"><b>DES</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using DES (not triple DES).</p>

<p style="margin-top: 1em"><b>RC4</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using RC4.</p>

<p style="margin-top: 1em"><b>CAMELLIA</b></p>

<p style="margin-left:14%;">Cipher suites using
Camellia.</p>

<p style="margin-top: 1em"><b>CHACHA20</b></p>

<p style="margin-left:14%;">Cipher suites using
ChaCha20.</p>

<p style="margin-top: 1em"><b>IDEA</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using IDEA.</p>

<p style="margin-top: 1em"><b>MD5</b></p>

<p style="margin-left:14%; margin-top: 1em">Cipher suites
using MD5.</p>

<p style="margin-top: 1em"><b>SHA1</b>, <b>SHA</b></p>

<p style="margin-left:14%;">Cipher suites using SHA1.</p>

<p style="margin-top: 1em"><b>CRL</b></p>

<p style="margin-left:6%;"><b>openssl crl</b>
[<b>-CAfile</b> <i>file</i>] [<b>-CApath</b> <i>dir</i>]
[<b>-fingerprint</b>] [<b>-hash</b>] [<b>-in</b>
<i>file</i>] [<b>-inform der</b> | <b>pem</b>]
[<b>-issuer</b>] [<b>-lastupdate</b>] [<b>-nextupdate</b>]
[<b>-noout</b>] [<b>-out</b> <i>file</i>] [<b>-outform
der</b> | <b>pem</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>crl</b>
command processes CRL files in DER or PEM format. The PEM
CRL format uses the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN X509
CRL----- <br>
-----END X509 CRL-----</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature on a CRL
by looking up the issuing certificate in <i>file</i>.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">Verify the signature on a CRL
by looking up the issuing certificate in <i>dir</i>. This
directory must be a standard certificate directory, i.e. a
hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><b>-fingerprint</b></p>

<p style="margin-left:17%;">Print the CRL fingerprint.</p>

<p style="margin-top: 1em"><b>-hash</b></p>

<p style="margin-left:17%; margin-top: 1em">Output a hash
of the issuer name. This can be used to look up CRLs in a
directory by issuer name.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input file to read from, or
standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The input format.</p>

<p style="margin-top: 1em"><b>-issuer</b></p>

<p style="margin-left:17%;">Output the issuer name.</p>

<p style="margin-top: 1em"><b>-lastupdate</b></p>

<p style="margin-left:17%;">Output the <b>lastUpdate</b>
field.</p>

<p style="margin-top: 1em"><b>-nextupdate</b></p>

<p style="margin-left:17%;">Output the <b>nextUpdate</b>
field.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output the encoded version of the CRL.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output file to write to, or
standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">The output format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
CRL in text form.</p>

<p style="margin-top: 1em"><b>CRL2PKCS7</b></p>

<p style="margin-left:6%;"><b>openssl crl2pkcs7</b>
[<b>-certfile</b> <i>file</i>] [<b>-in</b> <i>file</i>]
[<b>-inform der</b> | <b>pem</b>] [<b>-nocrl</b>]
[<b>-out</b> <i>file</i>] [<b>-outform der</b> |
<b>pem</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>crl2pkcs7</b> command takes an optional CRL and one or
more certificates and converts them into a PKCS#7 degenerate
&quot;certificates only&quot; structure.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:17%;">Add the certificates in PEM
<i>file</i> to the PKCS#7 structure. This option can be used
more than once to read certificates from multiple files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Read the CRL from <i>file</i>,
or standard input if not specified.</p>

<p style="margin-top: 1em"><b>-inform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">Specify the CRL input
format.</p>

<p style="margin-top: 1em"><b>-nocrl</b></p>

<p style="margin-left:17%; margin-top: 1em">Normally, a CRL
is included in the output file. With this option, no CRL is
included in the output file and a CRL is not read from the
input file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Write the PKCS#7 structure to
<i>file</i>, or standard output if not specified.</p>

<p style="margin-top: 1em"><b>-outform der</b> |
<b>pem</b></p>

<p style="margin-left:17%;">Specify the PKCS#7 structure
output format.</p>

<p style="margin-top: 1em"><b>DGST</b></p>

<p style="margin-left:6%;"><b>openssl dgst</b> [</p>


<p><b>-gost-mac&nbsp;</b>|&nbsp;<b>-streebog256&nbsp;</b>|&nbsp;<b>-streebog512&nbsp;</b>|&nbsp;<b>-md_gost94&nbsp;</b>|
<b>-md4&nbsp;</b>|&nbsp;<b>-md5&nbsp;</b>|&nbsp;<b>-ripemd160&nbsp;</b>|&nbsp;<b>-sha1&nbsp;</b>|
<b>-sha224&nbsp;</b>|&nbsp;<b>-sha256&nbsp;</b>|&nbsp;<b>-sha384&nbsp;</b>|&nbsp;<b>-sha512&nbsp;</b>|&nbsp;<b>-whirlpool</b>
] [<b>-binary</b>] [<b>-cd</b>] [<b>-hex</b>]
[<b>-hmac&nbsp;</b><i>key</i>]
[<b>-keyform&nbsp;</b><i>PEM</i>]
[<b>-mac&nbsp;</b><i>algorithm</i>]
[<b>-macopt&nbsp;</b><i>nm</i>:<i>v</i>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-prverify&nbsp;</b><i>file</i>]
[<b>-sign&nbsp;</b><i>file</i>]
[<b>-signature&nbsp;</b><i>file</i>]
[<b>-sigopt&nbsp;</b><i>nm</i>:<i>v</i>]
[<b>-verify&nbsp;</b><i>file</i>] [<i>file&nbsp;...</i>]</p>

<p style="margin-left:6%; margin-top: 1em"><b>openssl
gost-mac</b> | <b>streebog256</b> | <b>streebog512</b> |
<b>md_gost94</b> | <b>md4</b> | <b>md5</b> |
<b>ripemd160</b> | <b>sha1</b> | <b>sha224</b> |
<b>sha256</b> | <b>sha384</b> | <b>sha512</b> |
<b>whirlpool</b> [<b>-c</b>] [<b>-d</b>]
[<i>file&nbsp;...</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The digest
functions output the message digest of a supplied
<i>file</i> or <i>files</i> in hexadecimal form. They can
also be used for digital signing and verification.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-binary</b></p>

<p style="margin-left:17%;">Output the digest or signature
in binary form.</p>

<p style="margin-top: 1em"><b>-c</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
digest in two-digit groups separated by colons; only
relevant if <i>hex</i> format output is used.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out BIO
debugging information.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Digest is to be
output as a hex dump. This is the default case for a
&quot;normal&quot; digest as opposed to a digital
signature.</p>

<p style="margin-top: 1em"><b>-hmac</b> <i>key</i></p>

<p style="margin-left:17%;">Create a hashed MAC using
<i>key</i>.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>PEM</i></p>

<p style="margin-left:17%;">Specifies the key format to
sign the digest with.</p>

<p style="margin-top: 1em"><b>-mac</b> <i>algorithm</i></p>

<p style="margin-left:17%;">Create a keyed Message
Authentication Code (MAC). The most popular MAC algorithm is
HMAC (hash-based MAC), but there are other MAC algorithms
which are not based on hash. MAC keys and other options
should be set via the <b>-macopt</b> parameter.</p>

<p style="margin-top: 1em"><b>-macopt</b>
<i>nm</i>:<i>v</i></p>

<p style="margin-left:17%;">Passes options to the MAC
algorithm, specified by <b>-mac</b>. The following options
are supported by HMAC:</p>

<p style="margin-top: 1em"><i>key</i>:<i>string</i></p>

<p style="margin-left:27%;">Specifies the MAC key as an
alphanumeric string (use if the key contain printable
characters only). String length must conform to any
restrictions of the MAC algorithm.</p>

<p style="margin-top: 1em"><i>hexkey</i>:<i>string</i></p>

<p style="margin-left:27%;">Specifies the MAC key in
hexadecimal form (two hex digits per byte). Key length must
conform to any restrictions of the MAC algorithm.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The file to output to, or
standard output by default.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-prverify</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature using the
private key in <i>file</i>. The output is either
&quot;Verification OK&quot; or &quot;Verification
Failure&quot;.</p>

<p style="margin-top: 1em"><b>-sign</b> <i>file</i></p>

<p style="margin-left:17%;">Digitally sign the digest using
the private key in <i>file</i>.</p>

<p style="margin-top: 1em"><b>-signature</b>
<i>file</i></p>

<p style="margin-left:17%;">The actual signature to
verify.</p>

<p style="margin-top: 1em"><b>-sigopt</b>
<i>nm</i>:<i>v</i></p>

<p style="margin-left:17%;">Pass options to the signature
algorithm during sign or verify operations. The names and
values of these options are algorithm-specific.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>file</i></p>

<p style="margin-left:17%;">Verify the signature using the
public key in <i>file</i>. The output is either
&quot;Verification OK&quot; or &quot;Verification
Failure&quot;.</p>

<p style="margin-top: 1em"><i>file&nbsp;...</i></p>

<p style="margin-left:17%;">File or files to digest. If no
files are specified then standard input is used.</p>

<p style="margin-top: 1em"><b>DGST NOTES</b></p>

<p style="margin-left:6%;">The digest of choice for all new
applications is SHA1. Other digests are, however, still
widely used.</p>

<p style="margin-left:6%; margin-top: 1em">If you wish to
sign or verify data using the DSA algorithm, the dss1 digest
must be used.</p>

<p style="margin-left:6%; margin-top: 1em">A source of
random numbers is required for certain signing algorithms,
in particular DSA.</p>

<p style="margin-left:6%; margin-top: 1em">The signing and
verify options should only be used if a single file is being
signed or verified.</p>

<p style="margin-top: 1em"><b>DH</b></p>

<p style="margin-left:6%;">Diffie-Hellman Parameter
Management. The <b>dh</b> command has been replaced by
<b>dhparam</b>. See <i>DHPARAM</i> below.</p>

<p style="margin-top: 1em"><b>DHPARAM</b></p>

<p style="margin-left:6%;"><b>openssl dhparam</b>
[<b>-2&nbsp;</b>|&nbsp;<b>-5</b>] [<b>-C</b>]
[<b>-check</b>] [<b>-dsaparam</b>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-text</b>] [<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>dhparam</b> command is used to manipulate DH parameter
files.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-2</b>, <b>-5</b></p>

<p style="margin-left:17%; margin-top: 1em">The generator
to use, either 2 or 5. 2 is the default. If present, the
input file is ignored and parameters are generated
instead.</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
converts the parameters into C code. The parameters can then
be loaded by calling the <b>get_dh</b><i>numbits</i>()
function.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">Check the DH
parameters.</p>

<p style="margin-top: 1em"><b>-dsaparam</b></p>

<p style="margin-left:17%;">If this option is used, DSA
rather than DH parameters are read or created; they are
converted to DH format. Otherwise, &quot;strong&quot; primes
(such that (p-1)/2 is also prime) will be used for DH
parameter generation.</p>

<p style="margin-left:17%; margin-top: 1em">DH parameter
generation with the <b>-dsaparam</b> option is much faster,
and the recommended exponent length is shorter, which makes
DH key exchange more efficient. Beware that with such
DSA-style DH parameters, a fresh DH key should be created
for each use to avoid small-subgroup attacks that may be
possible otherwise.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read parameters from, or standard input if
this option is not specified.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The argument <i>DER</i> uses an ASN1 DER-encoded
form compatible with the PKCS#3 DHparameter structure. The
<i>PEM</i> form is the default format: it consists of the
DER format base64-encoded with additional header and footer
lines.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
inhibits the output of the encoded version of the
parameters.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">This argument specifies that a
parameter set should be generated of size <i>numbits</i>. It
must be the last option. If not present, a value of 2048 is
used. If this value is present, the input file is ignored
and parameters are generated instead.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write parameters to. Standard output is used
if this option is not present. The output filename should
<i>not</i> be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prints out the DH parameters in human readable form.</p>

<p style="margin-top: 1em"><b>DHPARAM WARNINGS</b></p>

<p style="margin-left:6%;">The program <b>dhparam</b>
combines the functionality of the programs <b>dh</b> and
<b>gendh</b> in previous versions of <b>OpenSSL</b> and
<b>SSLeay</b>. The <b>dh</b> and <b>gendh</b> programs are
retained for now, but may have different purposes in future
versions of <b>OpenSSL</b>.</p>

<p style="margin-top: 1em"><b>DHPARAM NOTES</b></p>

<p style="margin-left:6%;">PEM format DH parameters use the
header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN DH
PARAMETERS----- <br>
-----END DH PARAMETERS-----</p>

<p style="margin-left:6%; margin-top: 1em"><b>OpenSSL</b>
currently only supports the older PKCS#3 DH, not the newer
X9.42 DH.</p>

<p style="margin-left:6%; margin-top: 1em">This program
manipulates DH parameters not keys.</p>

<p style="margin-top: 1em"><b>DHPARAM BUGS</b></p>

<p style="margin-left:6%;">There should be a way to
generate and manipulate DH keys.</p>

<p style="margin-top: 1em"><b>DHPARAM HISTORY</b></p>

<p style="margin-left:6%;">The <b>dhparam</b> command was
added in <b>OpenSSL</b> 0.9.5. The <b>-dsaparam</b> option
was added in <b>OpenSSL</b> 0.9.6.</p>

<p style="margin-top: 1em"><b>DSA</b></p>

<p style="margin-left:6%;"><b>openssl dsa</b> [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|
<b>-des&nbsp;</b>|&nbsp;<b>-des3</b> ]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-modulus</b>] [<b>-noout</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>dsa</b>
command processes DSA keys. They can be converted between
various forms and their components printed out.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>:
This command uses the traditional <b>SSLeay</b> compatible
format for private key encryption: newer applications should
use the more secure PKCS#8 format using the <b>pkcs8</b>
command.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">These options encrypt the
private key with the AES, DES, or the triple DES ciphers,
respectively, before outputting it. A pass phrase is
prompted for. If none of these options is specified, the key
is written in plain text. This means that using the
<b>dsa</b> utility to read in an encrypted key with no
encryption option can be used to remove the pass phrase from
a key, or by setting the encryption options it can be use to
add or change the pass phrase. These options can only be
used with PEM format output files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read a key from, or standard input if this
option is not specified. If the key is encrypted, a pass
phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The <i>DER</i> argument with a private key uses an
ASN1 DER-encoded form of an ASN.1 SEQUENCE consisting of the
values of version (currently zero), P, Q, G, and the public
and private key components, respectively, as ASN.1 INTEGERs.
When used with a public key it uses a
<i>SubjectPublicKeyInfo</i> structure: it is an error if the
key is not DSA.</p>

<p style="margin-left:17%; margin-top: 1em">The <i>PEM</i>
form is the default format: it consists of the DER format
base64-encoded with additional header and footer lines. In
the case of a private key, PKCS#8 format is also
accepted.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">This option prints out the
value of the public key component of the key.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prevents output of the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write a key to, or standard output if not
specified. If any encryption options are set then a pass
phrase will be prompted for. The output filename should
<i>not</i> be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">By default, a
private key is read from the input file. With this option a
public key is read instead.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">By default, a private key is
output. With this option a public key will be output
instead. This option is automatically set if the input is a
public key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
public/private key components and parameters.</p>

<p style="margin-top: 1em"><b>DSA NOTES</b></p>

<p style="margin-left:6%;">The PEM private key format uses
the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN DSA
PRIVATE KEY----- <br>
-----END DSA PRIVATE KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">The PEM public
key format uses the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PUBLIC KEY----- <br>
-----END PUBLIC KEY-----</p>

<p style="margin-top: 1em"><b>DSA EXAMPLES</b></p>

<p style="margin-left:6%;">To remove the pass phrase on a
DSA private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl dsa
-in key.pem -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To encrypt a
private key using triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl dsa
-in key.pem -des3 -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To convert a
private key from PEM to DER format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl dsa
-in key.pem -outform DER -out keyout.der</p>

<p style="margin-left:6%; margin-top: 1em">To print out the
components of a private key to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl dsa
-in key.pem -text -noout</p>

<p style="margin-left:6%; margin-top: 1em">To just output
the public part of a private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl dsa
-in key.pem -pubout -out pubkey.pem</p>

<p style="margin-top: 1em"><b>DSAPARAM</b></p>

<p style="margin-left:6%;"><b>openssl dsaparam</b>
[<b>-C</b>] [<b>-genkey</b>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-text</b>] [<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>dsaparam</b> command is used to manipulate or generate
DSA parameter files.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
converts the parameters into C code. The parameters can then
be loaded by calling the <b>get_dsa</b><i>XXX</i>()
function.</p>

<p style="margin-top: 1em"><b>-genkey</b></p>

<p style="margin-left:17%;">This option will generate a DSA
either using the specified or generated parameters.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read parameters from, or standard input if
this option is not specified. If the <i>numbits</i>
parameter is included, then this option will be ignored.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The <i>DER</i> argument uses an ASN1 DER-encoded
form compatible with RFC 2459 (PKIX) DSS-Parms that is a
SEQUENCE consisting of p, q and g, respectively. The
<i>PEM</i> form is the default format: it consists of the
DER format base64-encoded with additional header and footer
lines.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
inhibits the output of the encoded version of the
parameters.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">This option specifies that a
parameter set should be generated of size <i>numbits</i>. If
this option is included, the input file (if any) is
ignored.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write parameters to. Standard output is used
if this option is not present. The output filename should
<i>not</i> be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prints out the DSA parameters in human readable form.</p>

<p style="margin-top: 1em"><b>DSAPARAM NOTES</b></p>

<p style="margin-left:6%;">PEM format DSA parameters use
the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN DSA
PARAMETERS----- <br>
-----END DSA PARAMETERS-----</p>

<p style="margin-left:6%; margin-top: 1em">DSA parameter
generation is a slow process and as a result the same set of
DSA parameters is often used to generate several distinct
keys.</p>

<p style="margin-top: 1em"><b>EC</b></p>

<p style="margin-left:6%;"><b>openssl ec</b>
[<b>-conv_form&nbsp;</b><i>arg</i>] [<b>-des</b>]
[<b>-des3</b>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-param_enc&nbsp;</b><i>arg</i>] [<b>-param_out</b>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ec</b>
command processes EC keys. They can be converted between
various forms and their components printed out. Note:
<b>OpenSSL</b> uses the private key format specified in
&ldquo;SEC 1: Elliptic Curve Cryptography&rdquo;
(<b>http://www.secg.org/</b>). To convert an <b>OpenSSL</b>
EC private key into the PKCS#8 private key format use the
<b>pkcs8</b> command.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-conv_form</b> <i>arg</i></p>

<p style="margin-left:17%;">This specifies how the points
on the elliptic curve are converted into octet strings.
Possible values are: <b>compressed</b> (the default value),
<b>uncompressed</b>, and <b>hybrid</b>. For more information
regarding the point conversion forms please read the X9.62
standard. Note: Due to patent issues the <b>compressed</b>
option is disabled by default for binary curves and can be
enabled by defining the preprocessor macro
<i>OPENSSL_EC_BIN_PT_COMP</i> at compile time.</p>

<p style="margin-top: 1em"><b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">These options encrypt the
private key with the DES, triple DES, or any other cipher
supported by <b>OpenSSL</b> before outputting it. A pass
phrase is prompted for. If none of these options is
specified the key is written in plain text. This means that
using the <b>ec</b> utility to read in an encrypted key with
no encryption option can be used to remove the pass phrase
from a key, or by setting the encryption options it can be
use to add or change the pass phrase. These options can only
be used with PEM format output files.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
filename to read a key from, or standard input if this
option is not specified. If the key is encrypted a pass
phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. DER with a private key uses an ASN.1 DER-encoded
SEC1 private key. When used with a public key it uses the
SubjectPublicKeyInfo structure as specified in RFC 3280. PEM
is the default format: it consists of the DER format base64
encoded with additional header and footer lines. In the case
of a private key PKCS#8 format is also accepted.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Prevents output
of the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specifies the output filename
to write a key to, or standard output if none is specified.
If any encryption options are set then a pass phrase will be
prompted for. The output filename should <i>not</i> be the
same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format. The options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-param_enc</b> <i>arg</i></p>

<p style="margin-left:17%;">This specifies how the elliptic
curve parameters are encoded. Possible value are:
<b>named_curve</b>, i.e. the EC parameters are specified by
an OID; or <b>explicit</b>, where the EC parameters are
explicitly given (see RFC 3279 for the definition of the EC
parameter structures). The default value is
<b>named_curve</b>. Note: the <b>implicitlyCA</b>
alternative, as specified in RFC 3279, is currently not
implemented in <b>OpenSSL</b>.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">By default a
private key is read from the input file; with this option a
public key is read instead.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">By default a private key is
output; with this option a public key is output instead.
This option is automatically set if the input is a public
key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
public/private key components and parameters.</p>

<p style="margin-top: 1em"><b>EC NOTES</b></p>

<p style="margin-left:6%;">The PEM private key format uses
the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN EC
PRIVATE KEY----- <br>
-----END EC PRIVATE KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">The PEM public
key format uses the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PUBLIC KEY----- <br>
-----END PUBLIC KEY-----</p>

<p style="margin-top: 1em"><b>EC EXAMPLES</b></p>

<p style="margin-left:6%;">To encrypt a private key using
triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -des3 -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To convert a
private key from PEM to DER format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -outform DER -out keyout.der</p>

<p style="margin-left:6%; margin-top: 1em">To print out the
components of a private key to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -text -noout</p>

<p style="margin-left:6%; margin-top: 1em">To just output
the public part of a private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -pubout -out pubkey.pem</p>

<p style="margin-left:6%; margin-top: 1em">To change the
parameter encoding to <b>explicit</b>:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -param_enc explicit -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To change the
point conversion form to <b>compressed</b>:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ec
-in key.pem -conv_form compressed -out keyout.pem</p>

<p style="margin-top: 1em"><b>EC HISTORY</b></p>

<p style="margin-left:6%;">The <b>ec</b> command was first
introduced in <b>OpenSSL</b> 0.9.8.</p>

<p style="margin-top: 1em"><b>EC AUTHORS</b></p>

<p style="margin-left:6%;">Nils Larsch.</p>

<p style="margin-top: 1em"><b>ECPARAM</b></p>

<p style="margin-left:6%;"><b>openssl ecparam</b>
[<b>-C</b>] [<b>-check</b>]
[<b>-conv_form&nbsp;</b><i>arg</i>] [<b>-genkey</b>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-list_curves</b>] [<b>-name&nbsp;</b><i>arg</i>]
[<b>-no_seed</b>] [<b>-noout</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-param_enc&nbsp;</b><i>arg</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">This command is
used to manipulate or generate EC parameter files.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:17%; margin-top: 1em">Convert the EC
parameters into C code. The parameters can then be loaded by
calling the <b>get_ec_group_XXX</b>() function.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">Validate the
elliptic curve parameters.</p>

<p style="margin-top: 1em"><b>-conv_form</b> <i>arg</i></p>

<p style="margin-left:17%;">Specify how the points on the
elliptic curve are converted into octet strings. Possible
values are: <b>compressed</b> (the default value),
<b>uncompressed</b>, and <b>hybrid</b>. For more information
regarding the point conversion forms please read the X9.62
standard. Note: Due to patent issues the <b>compressed</b>
option is disabled by default for binary curves and can be
enabled by defining the preprocessor macro
<i>OPENSSL_EC_BIN_PT_COMP</i> at compile time.</p>

<p style="margin-top: 1em"><b>-genkey</b></p>

<p style="margin-left:17%;">Generate an EC private key
using the specified parameters.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Specify the input filename to
read parameters from or standard input if this option is not
specified.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">Specify the input format. DER
uses an ASN.1 DER-encoded form compatible with RFC 3279
EcpkParameters. PEM is the default format: it consists of
the DER format base64 encoded with additional header and
footer lines.</p>

<p style="margin-top: 1em"><b>-list_curves</b></p>

<p style="margin-left:17%;">Print out a list of all
currently implemented EC parameter names and exit.</p>

<p style="margin-top: 1em"><b>-name</b> <i>arg</i></p>

<p style="margin-left:17%;">Use the EC parameters with the
specified &rsquo;short&rsquo; name. Use <b>-list_curves</b>
to get a list of all currently implemented EC
parameters.</p>

<p style="margin-top: 1em"><b>-no_seed</b></p>

<p style="margin-left:17%;">Inhibit that the
&rsquo;seed&rsquo; for the parameter generation is included
in the ECParameters structure (see RFC 3279).</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Inhibit the
output of the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specify the output filename
parameters are written to. Standard output is used if this
option is not present. The output filename should <i>not</i>
be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">Specify the output format; the
parameters have the same meaning as the <b>-inform</b>
option.</p>

<p style="margin-top: 1em"><b>-param_enc</b> <i>arg</i></p>

<p style="margin-left:17%;">This specifies how the elliptic
curve parameters are encoded. Possible value are:
<b>named_curve</b>, i.e. the EC parameters are specified by
an OID, or <b>explicit</b>, where the EC parameters are
explicitly given (see RFC 3279 for the definition of the EC
parameter structures). The default value is
<b>named_curve</b>. Note: the <b>implicitlyCA</b>
alternative, as specified in RFC 3279, is currently not
implemented in <b>OpenSSL</b>.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
EC parameters in human readable form.</p>

<p style="margin-top: 1em"><b>ECPARAM NOTES</b></p>

<p style="margin-left:6%;">PEM format EC parameters use the
header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN EC
PARAMETERS----- <br>
-----END EC PARAMETERS-----</p>

<p style="margin-left:6%; margin-top: 1em"><b>OpenSSL</b>
is currently not able to generate new groups and therefore
<b>ecparam</b> can only create EC parameters from known
(named) curves.</p>

<p style="margin-top: 1em"><b>ECPARAM EXAMPLES</b></p>

<p style="margin-left:6%;">To create EC parameters with the
group &rsquo;prime192v1&rsquo;:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -out ec_param.pem -name prime192v1</p>

<p style="margin-left:6%; margin-top: 1em">To create EC
parameters with explicit parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -out ec_param.pem -name prime192v1 \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-param_enc explicit</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To validate
given EC parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -in ec_param.pem -check</p>

<p style="margin-left:6%; margin-top: 1em">To create EC
parameters and a private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -out ec_key.pem -name prime192v1 -genkey</p>

<p style="margin-left:6%; margin-top: 1em">To change the
point encoding to &rsquo;compressed&rsquo;:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -in ec_in.pem -out ec_out.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-conv_form compressed</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To print out the
EC parameters to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
ecparam -in ec_param.pem -noout -text</p>

<p style="margin-top: 1em"><b>ECPARAM HISTORY</b></p>

<p style="margin-left:6%;">The <b>ecparam</b> command was
first introduced in <b>OpenSSL</b> 0.9.8.</p>

<p style="margin-top: 1em"><b>ECPARAM AUTHORS</b></p>

<p style="margin-left:6%;">Nils Larsch.</p>

<p style="margin-top: 1em"><b>ENC</b></p>

<p style="margin-left:6%;"><b>openssl enc -ciphername</b>
[<b>-AadePp</b>] [<b>-base64</b>]
[<b>-bufsize&nbsp;</b><i>number</i>] [<b>-debug</b>]
[<b>-in&nbsp;</b><i>file</i>] [<b>-iv&nbsp;</b><i>IV</i>]
[<b>-K&nbsp;</b><i>key</i>] [<b>-k&nbsp;</b><i>password</i>]
[<b>-kfile&nbsp;</b><i>file</i>]
[<b>-md&nbsp;</b><i>digest</i>] [<b>-none</b>]
[<b>-nopad</b>] [<b>-nosalt</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-pass&nbsp;</b><i>arg</i>] [<b>-S&nbsp;</b><i>salt</i>]
[<b>-salt</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The symmetric
cipher commands allow data to be encrypted or decrypted
using various block and stream ciphers using keys based on
passwords or explicitly provided. Base64 encoding or
decoding can also be performed either by itself or in
addition to the encryption or decryption.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-A</b></p>

<p style="margin-left:17%; margin-top: 1em">If the
<b>-a</b> option is set, then base64 process the data on one
line.</p>

<p style="margin-top: 1em"><b>-a</b>, <b>-base64</b></p>

<p style="margin-left:17%;">Base64 process the data. This
means that if encryption is taking place, the data is
base64-encoded after encryption. If decryption is set, the
input data is base64 decoded before being decrypted.</p>

<p style="margin-top: 1em"><b>-bufsize</b>
<i>number</i></p>

<p style="margin-left:17%;">Set the buffer size for
I/O.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">Decrypt the
input data.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Debug the BIOs
used for I/O.</p>

<p style="margin-top: 1em"><b>-e</b></p>

<p style="margin-left:17%; margin-top: 1em">Encrypt the
input data: this is the default.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">The input <i>file</i>; standard
input by default.</p>

<p style="margin-top: 1em"><b>-iv</b> <i>IV</i></p>

<p style="margin-left:17%; margin-top: 1em">The actual
<i>IV</i> (initialisation vector) to use: this must be
represented as a string comprised only of hex digits. When
only the <i>key</i> is specified using the <b>-K</b> option,
the <i>IV</i> must explicitly be defined. When a password is
being specified using one of the other options, the
<i>IV</i> is generated from this password.</p>

<p style="margin-top: 1em"><b>-K</b> <i>key</i></p>

<p style="margin-left:17%; margin-top: 1em">The actual
<i>key</i> to use: this must be represented as a string
comprised only of hex digits. If only the key is specified,
the <i>IV</i> must be additionally specified using the
<b>-iv</b> option. When both a <i>key</i> and a
<i>password</i> are specified, the <i>key</i> given with the
<b>-K</b> option will be used and the <i>IV</i> generated
from the password will be taken. It probably does not make
much sense to specify both <i>key</i> and
<i>password</i>.</p>

<p style="margin-top: 1em"><b>-k</b> <i>password</i></p>

<p style="margin-left:17%;">The <i>password</i> to derive
the key from. This is for compatibility with previous
versions of <b>OpenSSL</b>. Superseded by the <b>-pass</b>
option.</p>

<p style="margin-top: 1em"><b>-kfile</b> <i>file</i></p>

<p style="margin-left:17%;">Read the password to derive the
key from the first line of <i>file</i>. This is for
compatibility with previous versions of <b>OpenSSL</b>.
Superseded by the <b>-pass</b> option.</p>

<p style="margin-top: 1em"><b>-md</b> <i>digest</i></p>

<p style="margin-left:17%;">Use <i>digest</i> to create a
key from a pass phrase. <i>digest</i> may be one of
&ldquo;md5&rdquo; or &ldquo;sha1&rdquo;.</p>

<p style="margin-top: 1em"><b>-none</b></p>

<p style="margin-left:17%; margin-top: 1em">Use NULL cipher
(no encryption or decryption of input).</p>

<p style="margin-top: 1em"><b>-nopad</b></p>

<p style="margin-left:17%; margin-top: 1em">Disable
standard block padding.</p>

<p style="margin-top: 1em"><b>-nosalt</b></p>

<p style="margin-left:17%;">Don&rsquo;t use a <i>salt</i>
in the key derivation routines. This option should
<i>NEVER</i> be used unless compatibility with previous
versions of <b>OpenSSL</b> or <b>SSLeay</b> is required.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output <i>file</i>,
standard output by default.</p>

<p style="margin-top: 1em"><b>-P</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
<i>salt</i>, <i>key</i>, and <i>IV</i> used, then
immediately exit; don&rsquo;t do any encryption or
decryption.</p>

<p style="margin-top: 1em"><b>-p</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
<i>salt</i>, <i>key</i>, and <i>IV</i> used.</p>

<p style="margin-top: 1em"><b>-pass</b> <i>arg</i></p>

<p style="margin-left:17%;">The password source.</p>

<p style="margin-top: 1em"><b>-S</b> <i>salt</i></p>

<p style="margin-left:17%;">The actual <i>salt</i> to use:
this must be represented as a string comprised only of hex
digits.</p>

<p style="margin-top: 1em"><b>-salt</b></p>

<p style="margin-left:17%; margin-top: 1em">Use a
<i>salt</i> in the key derivation routines. This is the
default.</p>

<p style="margin-top: 1em"><b>ENC NOTES</b></p>

<p style="margin-left:6%;">The program can be called either
as <b>openssl ciphername</b> or <b>openssl enc
-ciphername</b>.</p>

<p style="margin-left:6%; margin-top: 1em">A password will
be prompted for to derive the <i>key</i> and <i>IV</i> if
necessary.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-nosalt</b> option should <i>NEVER</i> be used unless
compatibility with previous versions of <b>OpenSSL</b> or
<b>SSLeay</b> is required.</p>

<p style="margin-left:6%; margin-top: 1em">With the
<b>-nosalt</b> option it is possible to perform efficient
dictionary attacks on the password and to attack stream
cipher encrypted data. The reason for this is that without
the salt the same password always generates the same
encryption key. When the salt is being used the first eight
bytes of the encrypted data are reserved for the salt: it is
generated at random when encrypting a file and read from the
encrypted file when it is decrypted.</p>

<p style="margin-left:6%; margin-top: 1em">Some of the
ciphers do not have large keys and others have security
implications if not used correctly. A beginner is advised to
just use a strong block cipher in CBC mode such as bf or
des3.</p>

<p style="margin-left:6%; margin-top: 1em">All the block
ciphers normally use PKCS#5 padding also known as standard
block padding: this allows a rudimentary integrity or
password check to be performed. However, since the chance of
random data passing the test is better than 1 in 256, it
isn&rsquo;t a very good test.</p>

<p style="margin-left:6%; margin-top: 1em">If padding is
disabled, the input data must be a multiple of the cipher
block length.</p>

<p style="margin-left:6%; margin-top: 1em">All RC2 ciphers
have the same key and effective key length.</p>

<p style="margin-left:6%; margin-top: 1em">Blowfish and RC5
algorithms use a 128-bit key.</p>

<p style="margin-top: 1em"><b>ENC SUPPORTED CIPHERS</b></p>

<p style="margin-left:14%;">aes-[128|192|256]-cbc
128/192/256 bit AES in CBC mode</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%">


<p>Alias for aes-[128|192|256]-cbc</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]-cfb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">


<p>128/192/256 bit AES in 128 bit CFB mode</p></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]-cfb1</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">


<p>128/192/256 bit AES in 1 bit CFB mode</p></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]-cfb8</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">


<p>128/192/256 bit AES in 8 bit CFB mode</p></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]-ecb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">


<p>128/192/256 bit AES in ECB mode</p></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>aes-[128|192|256]-ofb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">


<p>128/192/256 bit AES in OFB mode</p></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>base64</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Base 64</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>bf</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>Alias for bf-cbc</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>bf-cbc</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Blowfish in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>bf-cfb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Blowfish in CFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>bf-ecb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Blowfish in ECB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>bf-ofb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Blowfish in OFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>Alias for cast-cbc</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast-cbc</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>CAST in CBC mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast5-cbc</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>CAST5 in CBC mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast5-cfb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>CAST5 in CFB mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast5-ecb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>CAST5 in ECB mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>cast5-ofb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>CAST5 in OFB mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>Alias for des-cbc</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-cbc</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>DES in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-cfb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>DES in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ecb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>DES in ECB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ofb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>DES in OFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>Two key triple DES EDE in ECB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede-cbc</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Two key triple DES EDE in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede-cfb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Two key triple DES EDE in CFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede-ofb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Two key triple DES EDE in OFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des3</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>Alias for des-ede3-cbc</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede3</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">


<p>Three key triple DES EDE in ECB mode</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede3-cbc</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Three key triple DES EDE in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede3-cfb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Three key triple DES EDE CFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>des-ede3-ofb</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>Three key triple DES EDE in OFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>desx</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>DESX algorithm</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>Alias for rc2-cbc</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-cbc</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>128-bit RC2 in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-cfb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>128-bit RC2 in CFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-ecb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>128-bit RC2 in ECB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-ofb</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>128-bit RC2 in OFB mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-64-cbc</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>64-bit RC2 in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc2-40-cbc</p></td>
<td width="6%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="6%">


<p>40-bit RC2 in CBC mode</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc4</p></td>
<td width="6%">
</td>
<td width="6%">
</td>
<td width="7%">


<p>128-bit RC4</p></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
<tr valign="top" align="left">
<td width="14%"></td>
<td width="7%">


<p>rc4-40</p></td>
<td width="6%"></td>
<td width="6%">
</td>
<td width="7%">
</td>
<td width="6%">


<p>40-bit RC4</p></td>
<td width="7%"></td>
<td width="47%">
</td></tr>
</table>

<p style="margin-top: 1em"><b>ENC EXAMPLES</b></p>

<p style="margin-left:6%;">Just base64 encode a binary
file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
base64 -in file.bin -out file.b64</p>

<p style="margin-left:6%; margin-top: 1em">Decode the same
file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
base64 -d -in file.b64 -out file.bin</p>

<p style="margin-left:6%; margin-top: 1em">Encrypt a file
using triple DES in CBC mode using a prompted password:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl des3
-salt -in file.txt -out file.des3</p>

<p style="margin-left:6%; margin-top: 1em">Decrypt a file
using a supplied password:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl des3
-d -in file.des3 -out file.txt -k mypassword</p>

<p style="margin-left:6%; margin-top: 1em">Encrypt a file
then base64 encode it (so it can be sent via mail for
example) using Blowfish in CBC mode:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl bf -a
-salt -in file.txt -out file.bf</p>

<p style="margin-left:6%; margin-top: 1em">Base64 decode a
file then decrypt it:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl bf -d
-a -in file.bf -out file.txt</p>

<p style="margin-top: 1em"><b>ENC BUGS</b></p>

<p style="margin-left:6%;">The <b>-A</b> option when used
with large files doesn&rsquo;t work properly.</p>

<p style="margin-left:6%; margin-top: 1em">There should be
an option to allow an iteration count to be included.</p>

<p style="margin-left:6%; margin-top: 1em">The <b>enc</b>
program only supports a fixed number of algorithms with
certain parameters. Therefore it is not possible to use RC2
with a 76-bit key or RC4 with an 84-bit key with this
program.</p>

<p style="margin-top: 1em"><b>ERRSTR</b></p>

<p style="margin-left:6%;"><b>openssl errstr</b>
[<b>-stats</b>] <i>errno ...</i></p>

<p style="margin-left:6%; margin-top: 1em">The
<b>errstr</b> command performs error number to error string
conversion, generating a human-readable string representing
the error code <i>errno</i>. The string is obtained through
the ERR_error_string_n(3) function and has the following
format:</p>

<p style="margin-left:14%; margin-top: 1em">error:[error
code]:[library name]:[function name]:[reason string]</p>

<p style="margin-left:6%; margin-top: 1em">[error code] is
an 8-digit hexadecimal number. The remaining fields [library
name], [function name], and [reason string] are all ASCII
text.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-stats</b></p>

<p style="margin-left:17%; margin-top: 1em">Print debugging
statistics about various aspects of the hash table.</p>

<p style="margin-top: 1em"><b>ERRSTR EXAMPLES</b></p>

<p style="margin-left:6%;">The following error code:</p>


<p style="margin-left:14%; margin-top: 1em">27594:error:2006D080:lib(32):func(109):reason(128):bss_file.c:107:</p>

<p style="margin-left:6%; margin-top: 1em">...can be
displayed with:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
errstr 2006D080</p>

<p style="margin-left:6%; margin-top: 1em">...to produce
the error message:</p>


<p style="margin-left:14%; margin-top: 1em">error:2006D080:BIO
routines:BIO_new_file:no such file</p>

<p style="margin-top: 1em"><b>GENDH</b></p>

<p style="margin-left:6%;">Generation of Diffie-Hellman
Parameters. Replaced by <b>dhparam</b>. See <i>DHPARAM</i>
above.</p>

<p style="margin-top: 1em"><b>GENDSA</b></p>

<p style="margin-left:6%;"><b>openssl gendsa</b> [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|
<b>-des&nbsp;</b>|&nbsp;<b>-des3</b> ]
[<b>-out&nbsp;</b><i>file</i>] [<i>paramfile</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>gendsa</b> command generates a DSA private key from a DSA
parameter file (which will typically be generated by the
<b>openssl dsaparam</b> command).</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">These options encrypt the
private key with the AES, DES, or the triple DES ciphers,
respectively, before outputting it. A pass phrase is
prompted for. If none of these options are specified, no
encryption is used.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output <i>file</i>. If this
argument is not specified, standard output is used.</p>

<p style="margin-top: 1em"><i>paramfile</i></p>

<p style="margin-left:17%;">This option specifies the DSA
parameter file to use. The parameters in this file determine
the size of the private key. DSA parameters can be generated
and examined using the <b>openssl dsaparam</b> command.</p>

<p style="margin-top: 1em"><b>GENDSA NOTES</b></p>

<p style="margin-left:6%;">DSA key generation is little
more than random number generation so it is much quicker
than RSA key generation, for example.</p>

<p style="margin-top: 1em"><b>GENPKEY</b></p>

<p style="margin-left:6%;"><b>openssl genpkey</b>
[<b>-algorithm&nbsp;</b><i>alg</i>] [<i>cipher</i>]
[<b>-genparam</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-paramfile&nbsp;</b><i>file</i>]
[<b>-pass&nbsp;</b><i>arg</i>]
[<b>-pkeyopt&nbsp;</b><i>opt</i>:<i>value</i>]
[<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>genpkey</b> command generates private keys. The use of
this program is encouraged over the algorithm specific
utilities because additional algorithm options can be
used.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-algorithm</b> <i>alg</i></p>

<p style="margin-left:17%;">The public key algorithm to
use, such as RSA, DSA, or DH. If used this option must
precede any <b>-pkeyopt</b> options. The options
<b>-paramfile</b> and <b>-algorithm</b> are mutually
exclusive.</p>

<p style="margin-top: 1em"><i>cipher</i></p>

<p style="margin-left:17%; margin-top: 1em">Encrypt the
private key with the supplied cipher. Any algorithm name
accepted by <b>EVP_get_cipherbyname</b>() is acceptable,
such as <b>des3</b>.</p>

<p style="margin-top: 1em"><b>-genparam</b></p>

<p style="margin-left:17%;">Generate a set of parameters
instead of a private key. If used this option must precede
any <b>-algorithm</b>, <b>-paramfile</b>, or <b>-pkeyopt</b>
options.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output filename. If this
argument is not specified then standard output is used.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format, DER or PEM.</p>

<p style="margin-top: 1em"><b>-paramfile</b>
<i>file</i></p>

<p style="margin-left:17%;">Some public key algorithms
generate a private key based on a set of parameters. They
can be supplied using this option. If this option is used
the public key algorithm used is determined by the
parameters. If used this option must precede any
<b>-pkeyopt</b> options. The options <b>-paramfile</b> and
<b>-algorithm</b> are mutually exclusive.</p>

<p style="margin-top: 1em"><b>-pass</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pkeyopt</b>
<i>opt</i>:<i>value</i></p>

<p style="margin-left:17%;">Set the public key algorithm
option <i>opt</i> to <i>value</i>. The precise set of
options supported depends on the public key algorithm used
and its implementation. See <i>GENPKEY KEY GENERATION
OPTIONS</i> below for more details.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print an
(unencrypted) text representation of private and public keys
and parameters along with the DER or PEM structure.</p>

<p style="margin-top: 1em"><b>GENPKEY KEY GENERATION
OPTIONS</b></p>

<p style="margin-left:6%;">The options supported by each
algorithm and indeed each implementation of an algorithm can
vary. The options for the <b>OpenSSL</b> implementations are
detailed below.</p>


<p style="margin-top: 1em">rsa_keygen_bits:<i>numbits</i></p>

<p style="margin-left:24%;">(RSA) The number of bits in the
generated key. If not specified 2048 is used.</p>


<p style="margin-top: 1em">rsa_keygen_pubexp:<i>value</i></p>

<p style="margin-left:24%;">(RSA) The RSA public exponent
value. This can be a large decimal or hexadecimal value if
preceded by 0x. The default value is 65537.</p>


<p style="margin-top: 1em">dsa_paramgen_bits:<i>numbits</i></p>

<p style="margin-left:24%;">(DSA) The number of bits in the
generated parameters. If not specified 1024 is used.</p>


<p style="margin-top: 1em">dh_paramgen_prime_len:<i>numbits</i></p>

<p style="margin-left:24%;">(DH) The number of bits in the
prime parameter <i>p</i>.</p>


<p style="margin-top: 1em">dh_paramgen_generator:<i>value</i></p>

<p style="margin-left:24%;">(DH) The value to use for the
generator <i>g</i>.</p>


<p style="margin-top: 1em">ec_paramgen_curve:<i>curve</i></p>

<p style="margin-left:24%;">(EC) The EC curve to use.</p>

<p style="margin-top: 1em"><b>GENPKEY EXAMPLES</b></p>

<p style="margin-left:6%;">Generate an RSA private key
using default parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -algorithm RSA -out key.pem</p>

<p style="margin-left:6%; margin-top: 1em">Encrypt and
output a private key using 128-bit AES and the passphrase
&quot;hello&quot;:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -algorithm RSA -out key.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-aes-128-cbc -pass pass:hello</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Generate a
2048-bit RSA key using 3 as the public exponent:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -algorithm RSA -out key.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-pkeyopt rsa_keygen_bits:2048 -pkeyopt
rsa_keygen_pubexp:3</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Generate
1024-bit DSA parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -genparam -algorithm DSA \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out dsap.pem -pkeyopt dsa_paramgen_bits:1024</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Generate a DSA
key from parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -paramfile dsap.pem -out dsakey.pem</p>

<p style="margin-left:6%; margin-top: 1em">Generate
1024-bit DH parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -genparam -algorithm DH \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out dhp.pem -pkeyopt dh_paramgen_prime_len:1024</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Generate a DH
key from parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genpkey -paramfile dhp.pem -out dhkey.pem</p>

<p style="margin-top: 1em"><b>GENRSA</b></p>

<p style="margin-left:6%;"><b>openssl genrsa</b>
[<b>-3&nbsp;</b>|&nbsp;<b>-f4</b>] [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|
<b>-des&nbsp;</b>|&nbsp;<b>-des3</b> ]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<i>numbits</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>genrsa</b> command generates an RSA private key.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-3</b> | <b>-f4</b></p>

<p style="margin-left:17%;">The public exponent to use,
either 3 or 65537. The default is 65537.</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">These options encrypt the
private key with the AES, DES, or the triple DES ciphers,
respectively, before outputting it. If none of these options
are specified, no encryption is used. If encryption is used,
a pass phrase is prompted for, if it is not supplied via the
<b>-passout</b> option.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">The output <i>file</i>. If this
argument is not specified, standard output is used.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><i>numbits</i></p>

<p style="margin-left:17%;">The size of the private key to
generate in bits. This must be the last option specified.
The default is 2048.</p>

<p style="margin-top: 1em"><b>GENRSA NOTES</b></p>

<p style="margin-left:6%;">RSA private key generation
essentially involves the generation of two prime numbers.
When generating a private key, various symbols will be
output to indicate the progress of the generation. A
&rsquo;.&rsquo; represents each number which has passed an
initial sieve test; &rsquo;+&rsquo; means a number has
passed a single round of the Miller-Rabin primality test. A
newline means that the number has passed all the prime tests
(the actual number depends on the key size).</p>

<p style="margin-left:6%; margin-top: 1em">Because key
generation is a random process, the time taken to generate a
key may vary somewhat.</p>

<p style="margin-top: 1em"><b>GENRSA BUGS</b></p>

<p style="margin-left:6%;">A quirk of the prime generation
algorithm is that it cannot generate small primes. Therefore
the number of bits should not be less that 64. For typical
private keys this will not matter because for security
reasons they will be much larger (typically 2048 bits).</p>

<p style="margin-top: 1em"><b>NSEQ</b></p>

<p style="margin-left:6%;"><b>openssl nseq</b> [<b>-in</b>
<i>file</i>] [<b>-out</b> <i>file</i>] [<b>-toseq</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>nseq</b>
command takes a file containing a Netscape certificate
sequence and prints out the certificates contained in it or
takes a file of certificates and converts it into a Netscape
certificate sequence.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read, or standard input if this option is not
specified.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specifies the output
<i>file</i>, or standard output by default.</p>

<p style="margin-top: 1em"><b>-toseq</b></p>

<p style="margin-left:17%; margin-top: 1em">Normally, a
Netscape certificate sequence will be input and the output
is the certificates contained in it. With the <b>-toseq</b>
option the situation is reversed: a Netscape certificate
sequence is created from a file of certificates.</p>

<p style="margin-top: 1em"><b>NSEQ EXAMPLES</b></p>

<p style="margin-left:6%;">Output the certificates in a
Netscape certificate sequence:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl nseq
-in nseq.pem -out certs.pem</p>

<p style="margin-left:6%; margin-top: 1em">Create a
Netscape certificate sequence:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl nseq
-in certs.pem -toseq -out nseq.pem</p>

<p style="margin-top: 1em"><b>NSEQ NOTES</b></p>

<p style="margin-left:6%;">The PEM-encoded form uses the
same headers and footers as a certificate:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
CERTIFICATE----- <br>
-----END CERTIFICATE-----</p>

<p style="margin-left:6%; margin-top: 1em">A Netscape
certificate sequence is a Netscape specific form that can be
sent to browsers as an alternative to the standard PKCS#7
format when several certificates are sent to the browser:
for example during certificate enrollment. It is used by the
Netscape certificate server, for example.</p>

<p style="margin-top: 1em"><b>NSEQ BUGS</b></p>

<p style="margin-left:6%;">This program needs a few more
options, like allowing DER or PEM input and output files and
allowing multiple certificate files to be used.</p>

<p style="margin-top: 1em"><b>OCSP</b></p>

<p style="margin-left:6%;"><b>openssl ocsp</b>
[<b>-CA&nbsp;</b><i>file</i>]
[<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-cert&nbsp;</b><i>file</i>]
[<b>-dgst&nbsp;</b><i>alg</i>] [</p>

<p><b>-host</b> <i>hostname</i>:<i>port</i> ]
[<b>-index&nbsp;</b><i>indexfile</i>]
[<b>-issuer&nbsp;</b><i>file</i>]
[<b>-ndays&nbsp;</b><i>days</i>]
[<b>-nmin&nbsp;</b><i>minutes</i>] [<b>-no_cert_checks</b>]
[<b>-no_cert_verify</b>] [<b>-no_certs</b>]
[<b>-no_chain</b>] [<b>-no_intern</b>] [<b>-no_nonce</b>]
[<b>-no_signature_verify</b>] [<b>-nonce</b>]
[<b>-noverify</b>] [<b>-nrequest&nbsp;</b><i>number</i>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-path&nbsp;</b><i>path</i>]
[<b>-port&nbsp;</b><i>portnum</i>] [<b>-req_text</b>]
[<b>-reqin&nbsp;</b><i>file</i>]
[<b>-reqout&nbsp;</b><i>file</i>] [<b>-resp_key_id</b>]
[<b>-resp_no_certs</b>] [<b>-resp_text</b>]
[<b>-respin&nbsp;</b><i>file</i>]
[<b>-respout&nbsp;</b><i>file</i>]
[<b>-rkey&nbsp;</b><i>file</i>]
[<b>-rother&nbsp;</b><i>file</i>]
[<b>-rsigner&nbsp;</b><i>file</i>]
[<b>-serial&nbsp;</b><i>number</i>]
[<b>-sign_other&nbsp;</b><i>file</i>]
[<b>-signer&nbsp;</b><i>file</i>]
[<b>-signkey&nbsp;</b><i>file</i>]
[<b>-status_age&nbsp;</b><i>age</i>] [<b>-text</b>]
[<b>-trust_other</b>]
[<b>-url&nbsp;</b><i>responder_url</i>]
[<b>-VAfile&nbsp;</b><i>file</i>]
[<b>-validity_period&nbsp;</b><i>nsec</i>]
[<b>-verify_other&nbsp;</b><i>file</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The Online
Certificate Status Protocol (OCSP) enables applications to
determine the (revocation) state of an identified
certificate (RFC 2560).</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ocsp</b>
command performs many common OCSP tasks. It can be used to
print out requests and responses, create requests and send
queries to an OCSP responder, and behave like a mini OCSP
server itself.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i>,
<b>-CApath</b> <i>directory</i></p>

<p style="margin-left:17%;"><i>file</i> or <i>path</i>
containing trusted CA certificates. These are used to verify
the signature on the OCSP response.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">Add the certificate <i>file</i>
to the request. The issuer certificate is taken from the
previous <b>-issuer</b> option, or an error occurs if no
issuer certificate is specified.</p>

<p style="margin-top: 1em"><b>-dgst</b> <i>alg</i></p>

<p style="margin-left:17%;">Sets the digest algorithm to
use for certificate identification in the OCSP request. By
default SHA-1 is used.</p>

<p style="margin-top: 1em"><b>-host</b>
<i>hostname</i>:<i>port</i>, <b>-path</b> <i>path</i></p>

<p style="margin-left:17%;">If the <b>-host</b> option is
present, then the OCSP request is sent to the host
<i>hostname</i> on port <i>port</i>. <b>-path</b> specifies
the HTTP path name to use, or &rsquo;/&rsquo; by
default.</p>

<p style="margin-top: 1em"><b>-issuer</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the current
issuer certificate. This option can be used multiple times.
The certificate specified in <i>file</i> must be in PEM
format. This option <i>must</i> come before any <b>-cert</b>
options.</p>

<p style="margin-top: 1em"><b>-no_cert_checks</b></p>

<p style="margin-left:17%;">Don&rsquo;t perform any
additional checks on the OCSP response signer&rsquo;s
certificate. That is, do not make any checks to see if the
signer&rsquo;s certificate is authorised to provide the
necessary status information: as a result this option should
only be used for testing purposes.</p>

<p style="margin-top: 1em"><b>-no_cert_verify</b></p>

<p style="margin-left:17%;">Don&rsquo;t verify the OCSP
response signer&rsquo;s certificate at all. Since this
option allows the OCSP response to be signed by any
certificate, it should only be used for testing
purposes.</p>

<p style="margin-top: 1em"><b>-no_certs</b></p>

<p style="margin-left:17%;">Don&rsquo;t include any
certificates in signed request.</p>

<p style="margin-top: 1em"><b>-no_chain</b></p>

<p style="margin-left:17%;">Do not use certificates in the
response as additional untrusted CA certificates.</p>

<p style="margin-top: 1em"><b>-no_intern</b></p>

<p style="margin-left:17%;">Ignore certificates contained
in the OCSP response when searching for the signer&rsquo;s
certificate. With this option, the signer&rsquo;s
certificate must be specified with either the
<b>-verify_other</b> or <b>-VAfile</b> options.</p>

<p style="margin-top: 1em"><b>-no_signature_verify</b></p>

<p style="margin-left:17%;">Don&rsquo;t check the signature
on the OCSP response. Since this option tolerates invalid
signatures on OCSP responses, it will normally only be used
for testing purposes.</p>

<p style="margin-top: 1em"><b>-nonce</b>,
<b>-no_nonce</b></p>

<p style="margin-left:17%;">Add an OCSP <i>nonce</i>
extension to a request or disable an OCSP <i>nonce</i>
addition. Normally, if an OCSP request is input using the
<b>-respin</b> option no <i>nonce</i> is added: using the
<b>-nonce</b> option will force addition of a <i>nonce</i>.
If an OCSP request is being created (using the <b>-cert</b>
and <b>-serial</b> options) a <i>nonce</i> is automatically
added; specifying <b>-no_nonce</b> overrides this.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:17%;">Don&rsquo;t attempt to verify
the OCSP response signature or the <i>nonce</i> values. This
option will normally only be used for debugging since it
disables all verification of the responder&rsquo;s
certificate.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specify output <i>file</i>;
default is standard output.</p>

<p style="margin-top: 1em"><b>-req_text</b>,
<b>-resp_text</b>, <b>-text</b></p>

<p style="margin-left:17%;">Print out the text form of the
OCSP request, response, or both, respectively.</p>

<p style="margin-top: 1em"><b>-reqin</b> <i>file</i>,
<b>-respin</b> <i>file</i></p>

<p style="margin-left:17%;">Read an OCSP request or
response file from <i>file</i>. These options are ignored if
an OCSP request or response creation is implied by other
options (for example with the <b>-serial</b>, <b>-cert</b>,
and <b>-host</b> options).</p>

<p style="margin-top: 1em"><b>-reqout</b> <i>file</i>,
<b>-respout</b> <i>file</i></p>

<p style="margin-left:17%;">Write out the DER-encoded
certificate request or response to <i>file</i>.</p>

<p style="margin-top: 1em"><b>-serial</b> <i>num</i></p>

<p style="margin-left:17%;">Same as the <b>-cert</b> option
except the certificate with serial number <i>num</i> is
added to the request. The serial number is interpreted as a
decimal integer unless preceded by &rsquo;0x&rsquo;.
Negative integers can also be specified by preceding the
value with a &rsquo;-&rsquo; sign.</p>

<p style="margin-top: 1em"><b>-sign_other</b>
<i>file</i></p>

<p style="margin-left:17%;">Additional certificates to
include in the signed request.</p>

<p style="margin-top: 1em"><b>-signer</b> <i>file</i>,
<b>-signkey</b> <i>file</i></p>

<p style="margin-left:17%;">Sign the OCSP request using the
certificate specified in the <b>-signer</b> option and the
private key specified by the <b>-signkey</b> option. If the
<b>-signkey</b> option is not present, then the private key
is read from the same file as the certificate. If neither
option is specified, the OCSP request is not signed.</p>

<p style="margin-top: 1em"><b>-trust_other</b></p>

<p style="margin-left:17%;">The certificates specified by
the <b>-verify_other</b> option should be explicitly trusted
and no additional checks will be performed on them. This is
useful when the complete responder certificate chain is not
available or trusting a root CA is not appropriate.</p>

<p style="margin-top: 1em"><b>-url</b>
<i>responder_url</i></p>

<p style="margin-left:17%;">Specify the responder URL. Both
HTTP and HTTPS (SSL/TLS) URLs can be specified.</p>

<p style="margin-top: 1em"><b>-VAfile</b> <i>file</i></p>

<p style="margin-left:17%;"><i>file</i> containing
explicitly trusted responder certificates. Equivalent to the
<b>-verify_other</b> and <b>-trust_other</b> options.</p>

<p style="margin-top: 1em"><b>-validity_period</b>
<i>nsec</i>, <b>-status_age</b> <i>age</i></p>

<p style="margin-left:17%;">These options specify the range
of times, in seconds, which will be tolerated in an OCSP
response. Each certificate status response includes a
<i>notBefore</i> time and an optional <i>notAfter</i> time.
The current time should fall between these two values, but
the interval between the two times may be only a few
seconds. In practice the OCSP responder and clients&rsquo;
clocks may not be precisely synchronised and so such a check
may fail. To avoid this the <b>-validity_period</b> option
can be used to specify an acceptable error range in seconds,
the default value is 5 minutes.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<i>notAfter</i> time is omitted from a response, then this
means that new status information is immediately available.
In this case the age of the <i>notBefore</i> field is
checked to see it is not older than <i>age</i> seconds old.
By default, this additional check is not performed.</p>

<p style="margin-top: 1em"><b>-verify_other</b>
<i>file</i></p>

<p style="margin-left:17%;"><i>file</i> containing
additional certificates to search when attempting to locate
the OCSP response signing certificate. Some responders omit
the actual signer&rsquo;s certificate from the response;
this option can be used to supply the necessary certificate
in such cases.</p>

<p style="margin-top: 1em"><b>OCSP SERVER OPTIONS <br>
-CA</b> <i>file</i></p>

<p style="margin-left:14%;">CA certificate corresponding to
the revocation information in <i>indexfile</i>.</p>

<p style="margin-top: 1em"><b>-index</b>
<i>indexfile</i></p>

<p style="margin-left:14%;"><i>indexfile</i> is a text
index file in <b>ca</b> format containing certificate
revocation information.</p>

<p style="margin-left:14%; margin-top: 1em">If the
<b>-index</b> option is specified, the <b>ocsp</b> utility
is in <i>responder</i> mode, otherwise it is in
<i>client</i> mode. The request(s) the responder processes
can be either specified on the command line (using the
<b>-issuer</b> and <b>-serial</b> options), supplied in a
file (using the <b>-respin</b> option) or via external OCSP
clients (if <i>port</i> or <i>url</i> is specified).</p>

<p style="margin-left:14%; margin-top: 1em">If the
<b>-index</b> option is present, then the <b>-CA</b> and
<b>-rsigner</b> options must also be present.</p>

<p style="margin-top: 1em"><b>-nmin</b> <i>minutes</i>,
<b>-ndays</b> <i>days</i></p>

<p style="margin-left:14%;">Number of <i>minutes</i> or
<i>days</i> when fresh revocation information is available:
used in the <i>nextUpdate</i> field. If neither option is
present, the <i>nextUpdate</i> field is omitted, meaning
fresh revocation information is immediately available.</p>

<p style="margin-top: 1em"><b>-nrequest</b>
<i>number</i></p>

<p style="margin-left:14%;">The OCSP server will exit after
receiving <i>number</i> requests, default unlimited.</p>

<p style="margin-top: 1em"><b>-port</b> <i>portnum</i></p>

<p style="margin-left:14%;">Port to listen for OCSP
requests on. The port may also be specified using the
<b>-url</b> option.</p>

<p style="margin-top: 1em"><b>-resp_key_id</b></p>

<p style="margin-left:14%;">Identify the signer certificate
using the key ID; default is to use the subject name.</p>

<p style="margin-top: 1em"><b>-resp_no_certs</b></p>

<p style="margin-left:14%;">Don&rsquo;t include any
certificates in the OCSP response.</p>

<p style="margin-top: 1em"><b>-rkey</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to sign OCSP
responses with; if not present, the file specified in the
<b>-rsigner</b> option is used.</p>

<p style="margin-top: 1em"><b>-rother</b> <i>file</i></p>

<p style="margin-left:14%;">Additional certificates to
include in the OCSP response.</p>

<p style="margin-top: 1em"><b>-rsigner</b> <i>file</i></p>

<p style="margin-left:14%;">The certificate to sign OCSP
responses with.</p>

<p style="margin-top: 1em"><b>OCSP RESPONSE
VERIFICATION</b></p>

<p style="margin-left:6%;">OCSP Response follows the rules
specified in RFC 2560.</p>

<p style="margin-left:6%; margin-top: 1em">Initially the
OCSP responder certificate is located and the signature on
the OCSP request checked using the responder
certificate&rsquo;s public key.</p>

<p style="margin-left:6%; margin-top: 1em">Then a normal
certificate verify is performed on the OCSP responder
certificate building up a certificate chain in the process.
The locations of the trusted certificates used to build the
chain can be specified by the <b>-CAfile</b> and
<b>-CApath</b> options or they will be looked for in the
standard <b>OpenSSL</b> certificates directory.</p>

<p style="margin-left:6%; margin-top: 1em">If the initial
verify fails, the OCSP verify process halts with an
error.</p>

<p style="margin-left:6%; margin-top: 1em">Otherwise the
issuing CA certificate in the request is compared to the
OCSP responder certificate: if there is a match then the
OCSP verify succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">Otherwise the
OCSP responder certificate&rsquo;s CA is checked against the
issuing CA certificate in the request. If there is a match
and the OCSPSigning extended key usage is present in the
OCSP responder certificate, then the OCSP verify
succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">Otherwise the
root CA of the OCSP responder&rsquo;s CA is checked to see
if it is trusted for OCSP signing. If it is, the OCSP verify
succeeds.</p>

<p style="margin-left:6%; margin-top: 1em">If none of these
checks is successful, the OCSP verify fails.</p>

<p style="margin-left:6%; margin-top: 1em">What this
effectively means is that if the OCSP responder certificate
is authorised directly by the CA it is issuing revocation
information about (and it is correctly configured), then
verification will succeed.</p>

<p style="margin-left:6%; margin-top: 1em">If the OCSP
responder is a <i>global responder</i> which can give
details about multiple CAs and has its own separate
certificate chain, then its root CA can be trusted for OCSP
signing. For example:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in ocspCA.pem -addtrust OCSPSigning \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-out trustedCA.pem</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Alternatively,
the responder certificate itself can be explicitly trusted
with the <b>-VAfile</b> option.</p>

<p style="margin-top: 1em"><b>OCSP NOTES</b></p>

<p style="margin-left:6%;">As noted, most of the verify
options are for testing or debugging purposes. Normally,
only the <b>-CApath</b>, <b>-CAfile</b> and (if the
responder is a &rsquo;global VA&rsquo;) <b>-VAfile</b>
options need to be used.</p>

<p style="margin-left:6%; margin-top: 1em">The OCSP server
is only useful for test and demonstration purposes: it is
not really usable as a full OCSP responder. It contains only
a very simple HTTP request handling and can only handle the
POST form of OCSP queries. It also handles requests
serially, meaning it cannot respond to new requests until it
has processed the current one. The text index file format of
revocation is also inefficient for large quantities of
revocation data.</p>

<p style="margin-left:6%; margin-top: 1em">It is possible
to run the <b>ocsp</b> application in <i>responder</i> mode
via a CGI script using the <b>-respin</b> and
<b>-respout</b> options.</p>

<p style="margin-top: 1em"><b>OCSP EXAMPLES</b></p>

<p style="margin-left:6%;">Create an OCSP request and write
it to a file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-issuer issuer.pem -cert c1.pem -cert c2.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-reqout req.der</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Send a query to
an OCSP responder with URL <i>http://ocsp.myhost.com/</i>,
save the response to a file and print it out in text
form:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-issuer issuer.pem -cert c1.pem -cert c2.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-url http://ocsp.myhost.com/ -resp_text -respout
resp.der</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Read in an OCSP
response and print out in text form:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-respin resp.der -text</p>

<p style="margin-left:6%; margin-top: 1em">OCSP server on
port 8888 using a standard <b>ca</b> configuration, and a
separate responder certificate. All requests and responses
are printed to a file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-index demoCA/index.txt -port 8888 -rsigner \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>rcert.pem -CA demoCA/cacert.pem -text -out log.txt</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">As above, but
exit after processing one request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-index demoCA/index.txt -port 8888 -rsigner \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>rcert.pem -CA demoCA/cacert.pem -nrequest 1</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Query status
information using internally generated request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-index demoCA/index.txt -rsigner rcert.pem -CA \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>demoCA/cacert.pem -issuer demoCA/cacert.pem -serial
1</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Query status
information using request read from a file and write the
response to a second file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ocsp
-index demoCA/index.txt -rsigner rcert.pem -CA \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>demoCA/cacert.pem -reqin req.der -respout resp.der</p></td></tr>
</table>

<p style="margin-top: 1em"><b>PASSWD</b></p>

<p style="margin-left:6%;"><b>openssl passwd</b> [<b>-1</b>
| <b>-apr1</b> | <b>-crypt</b>] [<b>-in</b> <i>file</i>]
[<b>-noverify</b>] [<b>-quiet</b>] [<b>-reverse</b>]
[<b>-salt</b> <i>string</i>] [<b>-stdin</b>] [<b>-table</b>]
[<i>password</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>passwd</b> command computes the hash of a password typed
at run-time or the hash of each password in a list. The
password list is taken from the named <i>file</i> for option
<b>-in</b>, from stdin for option <b>-stdin</b>, or from the
command line, or from the terminal otherwise. The UNIX
standard algorithm <i>crypt</i> and the MD5-based BSD
password algorithm <i>1</i> and its Apache variant
<i>apr1</i> are available.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-1</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the MD5
based BSD password algorithm <i>1</i>.</p>

<p style="margin-top: 1em"><b>-apr1</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the
<i>apr1</i> algorithm (Apache variant of the) BSD
algorithm.</p>

<p style="margin-top: 1em"><b>-crypt</b></p>

<p style="margin-left:17%; margin-top: 1em">Use the
<i>crypt</i> algorithm (default).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Read passwords from
<i>file</i>.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:17%;">Don&rsquo;t verify when reading
a password from the terminal.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output warnings when passwords given on the command line are
truncated.</p>

<p style="margin-top: 1em"><b>-reverse</b></p>

<p style="margin-left:17%;">Switch table columns. This only
makes sense in conjunction with the <b>-table</b>
option.</p>

<p style="margin-top: 1em"><b>-salt</b> <i>string</i></p>

<p style="margin-left:17%;">Use the specified <i>salt</i>.
When reading a password from the terminal, this implies
<b>-noverify</b>.</p>

<p style="margin-top: 1em"><b>-stdin</b></p>

<p style="margin-left:17%; margin-top: 1em">Read passwords
from <i>stdin</i>.</p>

<p style="margin-top: 1em"><b>-table</b></p>

<p style="margin-left:17%; margin-top: 1em">In the output
list, prepend the cleartext password and a TAB character to
each password hash.</p>

<p style="margin-top: 1em"><b>PASSWD EXAMPLES</b></p>

<p style="margin-left:14%;">$ openssl passwd -crypt -salt
xx password</p>

<p style="margin-left:6%;">prints
&quot;xxj31ZMTZzkVA&quot;.</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
passwd -1 -salt xxxxxxxx password</p>

<p style="margin-left:6%;">prints
&quot;$1$xxxxxxxx$UYCIxa628.9qXjpQCjM4a.&quot;.</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
passwd -apr1 -salt xxxxxxxx password</p>

<p style="margin-left:6%;">prints
&quot;$apr1$xxxxxxxx$dxHfLAsjHkDRmG83UXe8K0&quot;.</p>

<p style="margin-top: 1em"><b>PKCS7</b></p>

<p style="margin-left:6%;"><b>openssl pkcs7</b>
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-print_certs</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkcs7</b>
command processes PKCS#7 files in DER or PEM format.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read from, or standard input if this option
is not specified.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. <i>DER</i> format is a DER-encoded PKCS#7 v1.5
structure. <i>PEM</i> (the default) is a base64-encoded
version of the DER form with header and footer lines.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output the encoded version of the PKCS#7 structure (or
certificates if <b>-print_certs</b> is set).</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specifies the output
<i>file</i> to write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-print_certs</b></p>

<p style="margin-left:17%;">Prints out any certificates or
CRLs contained in the file. They are preceded by their
subject and issuer names in a one-line format.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out
certificate details in full rather than just subject and
issuer names.</p>

<p style="margin-top: 1em"><b>PKCS7 EXAMPLES</b></p>

<p style="margin-left:6%;">Convert a PKCS#7 file from PEM
to DER:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs7
-in file.pem -outform DER -out file.der</p>

<p style="margin-left:6%; margin-top: 1em">Output all
certificates in a file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs7
-in file.pem -print_certs -out certs.pem</p>

<p style="margin-top: 1em"><b>PKCS7 NOTES</b></p>

<p style="margin-left:6%;">The PEM PKCS#7 format uses the
header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PKCS7----- <br>
-----END PKCS7-----</p>

<p style="margin-left:6%; margin-top: 1em">For
compatibility with some CAs it will also accept:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
CERTIFICATE----- <br>
-----END CERTIFICATE-----</p>

<p style="margin-top: 1em"><b>PKCS7 RESTRICTIONS</b></p>

<p style="margin-left:6%;">There is no option to print out
all the fields of a PKCS#7 file.</p>

<p style="margin-left:6%; margin-top: 1em">The PKCS#7
routines only understand PKCS#7 v 1.5 as specified in RFC
2315. They cannot currently parse, for example, the new CMS
as described in RFC 2630.</p>

<p style="margin-top: 1em"><b>PKCS8</b></p>

<p style="margin-left:6%;"><b>openssl pkcs8</b>
[<b>-embed</b>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-nocrypt</b>] [<b>-noiter</b>] [<b>-nooct</b>]
[<b>-nsdb</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-topk8</b>]
[<b>-v1&nbsp;</b><i>alg</i>]
[<b>-v2&nbsp;</b><i>alg</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkcs8</b>
command processes private keys in PKCS#8 format. It can
handle both unencrypted PKCS#8 PrivateKeyInfo format and
EncryptedPrivateKeyInfo format with a variety of PKCS#5
(v1.5 and v2.0) and PKCS#12 algorithms.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-embed</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
generates DSA keys in a broken format. The DSA parameters
are embedded inside the <i>PrivateKey</i> structure. In this
form the OCTET STRING contains an ASN1 SEQUENCE consisting
of two structures: a SEQUENCE containing the parameters and
an ASN1 INTEGER containing the private key.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read a key from, or standard input if this
option is not specified. If the key is encrypted, a pass
phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. If a PKCS#8 format key is expected on input, then
either a DER- or PEM-encoded version of a PKCS#8 key will be
expected. Otherwise the DER or PEM format of the traditional
format private key is used.</p>

<p style="margin-top: 1em"><b>-nocrypt</b></p>

<p style="margin-left:17%;">PKCS#8 keys generated or input
are normally PKCS#8 <i>EncryptedPrivateKeyInfo</i>
structures using an appropriate password-based encryption
algorithm. With this option, an unencrypted
<i>PrivateKeyInfo</i> structure is expected or output. This
option does not encrypt private keys at all and should only
be used when absolutely necessary. Certain software such as
some versions of Java code signing software use unencrypted
private keys.</p>

<p style="margin-top: 1em"><b>-noiter</b></p>

<p style="margin-left:17%;">Use an iteration count of 1.
See the <i>PKCS12</i> section below for a detailed
explanation of this option.</p>

<p style="margin-top: 1em"><b>-nooct</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
generates RSA private keys in a broken format that some
software uses. Specifically the private key should be
enclosed in an OCTET STRING, but some software just includes
the structure itself without the surrounding OCTET
STRING.</p>

<p style="margin-top: 1em"><b>-nsdb</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
generates DSA keys in a broken format compatible with
Netscape private key databases. The <i>PrivateKey</i>
contains a SEQUENCE consisting of the public and private
keys, respectively.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write a key to, or standard output by
default. If any encryption options are set, a pass phrase
will be prompted for. The output filename should <i>not</i>
be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-topk8</b></p>

<p style="margin-left:17%; margin-top: 1em">Normally, a
PKCS#8 private key is expected on input and a traditional
format private key will be written. With the <b>-topk8</b>
option the situation is reversed: it reads a traditional
format private key and writes a PKCS#8 format key.</p>

<p style="margin-top: 1em"><b>-v1</b> <i>alg</i></p>

<p style="margin-left:17%;">This option specifies a PKCS#5
v1.5 or PKCS#12 algorithm to use. A complete list of
possible algorithms is included below.</p>

<p style="margin-top: 1em"><b>-v2</b> <i>alg</i></p>

<p style="margin-left:17%;">This option enables the use of
PKCS#5 v2.0 algorithms. Normally, PKCS#8 private keys are
encrypted with the password-based encryption algorithm
called <i>pbeWithMD5AndDES-CBC</i>; this uses 56-bit DES
encryption but it was the strongest encryption algorithm
supported in PKCS#5 v1.5. Using the <b>-v2</b> option PKCS#5
v2.0 algorithms are used which can use any encryption
algorithm such as 168-bit triple DES or 128-bit RC2, however
not many implementations support PKCS#5 v2.0 yet. If using
private keys with <b>OpenSSL</b> then this doesn&rsquo;t
matter.</p>

<p style="margin-left:17%; margin-top: 1em">The <i>alg</i>
argument is the encryption algorithm to use; valid values
include <i>des</i>, <i>des3</i>, and <i>rc2</i>. It is
recommended that <i>des3</i> is used.</p>

<p style="margin-top: 1em"><b>PKCS8 NOTES</b></p>

<p style="margin-left:6%;">The encrypted form of a
PEM-encoded PKCS#8 file uses the following headers and
footers:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
ENCRYPTED PRIVATE KEY----- <br>
-----END ENCRYPTED PRIVATE KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">The unencrypted
form uses:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PRIVATE KEY----- <br>
-----END PRIVATE KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">Private keys
encrypted using PKCS#5 v2.0 algorithms and high iteration
counts are more secure than those encrypted using the
traditional <b>SSLeay</b> compatible formats. So if
additional security is considered important, the keys should
be converted.</p>

<p style="margin-left:6%; margin-top: 1em">The default
encryption is only 56 bits because this is the encryption
that most current implementations of PKCS#8 support.</p>

<p style="margin-left:6%; margin-top: 1em">Some software
may use PKCS#12 password-based encryption algorithms with
PKCS#8 format private keys: these are handled automatically
but there is no option to produce them.</p>

<p style="margin-left:6%; margin-top: 1em">It is possible
to write out DER-encoded encrypted private keys in PKCS#8
format because the encryption details are included at an
ASN1 level whereas the traditional format includes them at a
PEM level.</p>

<p style="margin-top: 1em"><b>PKCS#5 V1.5 AND PKCS#12
ALGORITHMS</b></p>

<p style="margin-left:6%;">Various algorithms can be used
with the <b>-v1</b> command line option, including PKCS#5
v1.5 and PKCS#12. These are described in more detail
below.</p>

<p style="margin-top: 1em"><i>PBE-MD5-DES</i></p>

<p style="margin-left:14%;">These algorithms were included
in the original PKCS#5 v1.5 specification. They only offer
56 bits of protection since they both use DES.</p>

<p style="margin-top: 1em"><i>PBE-SHA1-RC2-64</i> |
<i>PBE-MD5-RC2-64</i> | <i>PBE-SHA1-DES</i></p>

<p style="margin-left:14%;">These algorithms are not
mentioned in the original PKCS#5 v1.5 specification but they
use the same key derivation algorithm and are supported by
some software. They are mentioned in PKCS#5 v2.0. They use
either 64-bit RC2 or 56-bit DES.</p>

<p style="margin-top: 1em"><i>PBE-SHA1-RC4-128</i> |
<i>PBE-SHA1-RC4-40</i> | <i>PBE-SHA1-3DES</i> |
<i>PBE-SHA1-2DES <br>
PBE-SHA1-RC2-128</i> | <i>PBE-SHA1-RC2-40</i></p>

<p style="margin-left:14%;">These algorithms use the
PKCS#12 password-based encryption algorithm and allow strong
encryption algorithms like triple DES or 128-bit RC2 to be
used.</p>

<p style="margin-top: 1em"><b>PKCS8 EXAMPLES</b></p>

<p style="margin-left:6%;">Convert a private key from
traditional to PKCS#5 v2.0 format using triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs8
-in key.pem -topk8 -v2 des3 -out enckey.pem</p>

<p style="margin-left:6%; margin-top: 1em">Convert a
private key to PKCS#8 using a PKCS#5 1.5 compatible
algorithm (DES):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs8
-in key.pem -topk8 -out enckey.pem</p>

<p style="margin-left:6%; margin-top: 1em">Convert a
private key to PKCS#8 using a PKCS#12 compatible algorithm
(3DES):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs8
-in key.pem -topk8 -out enckey.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-v1 PBE-SHA1-3DES</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Read a
DER-unencrypted PKCS#8 format private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs8
-inform DER -nocrypt -in key.der -out key.pem</p>

<p style="margin-left:6%; margin-top: 1em">Convert a
private key from any PKCS#8 format to traditional
format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkcs8
-in pk8.pem -out key.pem</p>

<p style="margin-top: 1em"><b>PKCS8 STANDARDS</b></p>

<p style="margin-left:6%;">Test vectors from this PKCS#5
v2.0 implementation were posted to the pkcs-tng mailing list
using triple DES, DES and RC2 with high iteration counts;
several people confirmed that they could decrypt the private
keys produced and therefore it can be assumed that the
PKCS#5 v2.0 implementation is reasonably accurate at least
as far as these algorithms are concerned.</p>

<p style="margin-left:6%; margin-top: 1em">The format of
PKCS#8 DSA (and other) private keys is not well documented:
it is hidden away in PKCS#11 v2.01, section 11.9;
<b>OpenSSL</b>&rsquo;s default DSA PKCS#8 private key format
complies with this standard.</p>

<p style="margin-top: 1em"><b>PKCS8 BUGS</b></p>

<p style="margin-left:6%;">There should be an option that
prints out the encryption algorithm in use and other details
such as the iteration count.</p>

<p style="margin-left:6%; margin-top: 1em">PKCS#8 using
triple DES and PKCS#5 v2.0 should be the default private key
format; for <b>OpenSSL</b> compatibility, several of the
utilities use the old format at present.</p>

<p style="margin-top: 1em"><b>PKCS12</b></p>

<p style="margin-left:6%;"><b>openssl pkcs12</b> [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|
<b>-des&nbsp;</b>|&nbsp;<b>-des3</b> ] [<b>-cacerts</b>]
[<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-caname&nbsp;</b><i>name</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-certfile&nbsp;</b><i>file</i>]
[<b>-certpbe&nbsp;</b><i>alg</i>] [<b>-chain</b>]
[<b>-clcerts</b>] [<b>-CSP&nbsp;</b><i>name</i>]
[<b>-descert</b>] [<b>-export</b>]
[<b>-in&nbsp;</b><i>file</i>] [<b>-info</b>]
[<b>-inkey&nbsp;</b><i>file</i>] [<b>-keyex</b>]
[<b>-keypbe&nbsp;</b><i>alg</i>] [<b>-keysig</b>]
[<b>-macalg&nbsp;</b><i>alg</i>] [<b>-maciter</b>]
[<b>-name&nbsp;</b><i>name</i>] [<b>-nocerts</b>]
[<b>-nodes</b>] [<b>-noiter</b>] [<b>-nokeys</b>]
[<b>-nomac</b>] [<b>-nomaciter</b>] [<b>-nomacver</b>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-twopass</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>pkcs12</b> command allows PKCS#12 files (sometimes
referred to as PFX files) to be created and parsed. PKCS#12
files are used by several programs including Netscape, MSIE
and MS Outlook.</p>

<p style="margin-left:6%; margin-top: 1em">There are a lot
of options; the meaning of some depends on whether a PKCS#12
file is being created or parsed. By default, a PKCS#12 file
is parsed; a PKCS#12 file can be created by using the
<b>-export</b> option (see below).</p>

<p style="margin-top: 1em"><b>PKCS12 PARSING OPTIONS <br>
-aes128</b> | <b>-aes192</b> | <b>-aes256</b> | <b>-des</b>
| <b>-des3</b></p>

<p style="margin-left:14%;">Use AES, DES, or triple DES,
respectively, to encrypt private keys before outputting. The
default is triple DES.</p>

<p style="margin-top: 1em"><b>-cacerts</b></p>

<p style="margin-left:14%;">Only output CA certificates
(not client certificates).</p>

<p style="margin-top: 1em"><b>-clcerts</b></p>

<p style="margin-left:14%;">Only output client certificates
(not CA certificates).</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">This specifies the <i>file</i>
of the PKCS#12 file to be parsed. Standard input is used by
default.</p>

<p style="margin-top: 1em"><b>-info</b></p>

<p style="margin-left:14%;">Output additional information
about the PKCS#12 file structure, algorithms used, and
iteration counts.</p>

<p style="margin-top: 1em"><b>-nocerts</b></p>

<p style="margin-left:14%;">No certificates at all will be
output.</p>

<p style="margin-top: 1em"><b>-nodes</b></p>

<p style="margin-left:14%;">Don&rsquo;t encrypt the private
keys at all.</p>

<p style="margin-top: 1em"><b>-nokeys</b></p>

<p style="margin-left:14%;">No private keys will be
output.</p>

<p style="margin-top: 1em"><b>-nomacver</b></p>

<p style="margin-left:14%;">Don&rsquo;t attempt to verify
the integrity MAC before reading the file.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:14%;">This option inhibits output of
the keys and certificates to the output file version of the
PKCS#12 file.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The <i>file</i> to write
certificates and private keys to, standard output by
default. They are all written in PEM format.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:14%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-twopass</b></p>

<p style="margin-left:14%;">Prompt for separate integrity
and encryption passwords: most software always assumes these
are the same so this option will render such PKCS#12 files
unreadable.</p>

<p style="margin-top: 1em"><b>PKCS12 FILE CREATION OPTIONS
<br>
-CAfile</b> <i>file</i></p>

<p style="margin-left:14%;">CA storage as a file.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:14%;">CA storage as a directory. This
directory must be a standard certificate directory: that is,
a hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><b>-caname</b> <i>name</i></p>

<p style="margin-left:14%;">This specifies the
&quot;friendly name&quot; for other certificates. This
option may be used multiple times to specify names for all
certificates in the order they appear. Netscape ignores
friendly names on other certificates, whereas MSIE displays
them.</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:14%;">A file to read additional
certificates from.</p>

<p style="margin-top: 1em"><b>-certpbe</b> <i>alg</i>,
<b>-keypbe</b> <i>alg</i></p>

<p style="margin-left:14%;">These options allow the
algorithm used to encrypt the private key and certificates
to be selected. Any PKCS#5 v1.5 or PKCS#12 PBE algorithm
name can be used (see the <i>PKCS12 NOTES</i> section for
more information). If a cipher name (as output by the
<b>list-cipher-algorithms</b> command) is specified then it
is used with PKCS#5 v2.0. For interoperability reasons it is
advisable to only use PKCS#12 algorithms.</p>

<p style="margin-top: 1em"><b>-chain</b></p>

<p style="margin-left:14%;">If this option is present, an
attempt is made to include the entire certificate chain of
the user certificate. The standard CA store is used for this
search. If the search fails, it is considered a fatal
error.</p>

<p style="margin-top: 1em"><b>-CSP</b> <i>name</i></p>

<p style="margin-left:14%;">Write <i>name</i> as a
Microsoft CSP name.</p>

<p style="margin-top: 1em"><b>-descert</b></p>

<p style="margin-left:14%;">Encrypt the certificate using
triple DES; this may render the PKCS#12 file unreadable by
some &quot;export grade&quot; software. By default, the
private key is encrypted using triple DES and the
certificate using 40-bit RC2.</p>

<p style="margin-top: 1em"><b>-export</b></p>

<p style="margin-left:14%;">This option specifies that a
PKCS#12 file will be created rather than parsed.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The <i>file</i> to read
certificates and private keys from, standard input by
default. They must all be in PEM format. The order
doesn&rsquo;t matter but one private key and its
corresponding certificate should be present. If additional
certificates are present, they will also be included in the
PKCS#12 file.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:14%;">File to read private key from.
If not present, a private key must be present in the input
file.</p>

<p style="margin-top: 1em"><b>-keyex</b> |
<b>-keysig</b></p>

<p style="margin-left:14%;">Specifies that the private key
is to be used for key exchange or just signing. This option
is only interpreted by MSIE and similar MS software.
Normally, &quot;export grade&quot; software will only allow
512-bit RSA keys to be used for encryption purposes, but
arbitrary length keys for signing. The <b>-keysig</b> option
marks the key for signing only. Signing only keys can be
used for S/MIME signing, authenticode (ActiveX control
signing) and SSL client authentication; however, due to a
bug only MSIE 5.0 and later support the use of signing only
keys for SSL client authentication.</p>

<p style="margin-top: 1em"><b>-macalg</b> <i>alg</i></p>

<p style="margin-left:14%;">Specify the MAC digest
algorithm. If not included then SHA1 is used.</p>

<p style="margin-top: 1em"><b>-maciter</b></p>

<p style="margin-left:14%;">This option is included for
compatibility with previous versions; it used to be needed
to use MAC iterations counts but they are now used by
default.</p>

<p style="margin-top: 1em"><b>-name</b> <i>name</i></p>

<p style="margin-left:14%;">This specifies the
&quot;friendly name&quot; for the certificate and private
key. This name is typically displayed in list boxes by
software importing the file.</p>

<p style="margin-top: 1em"><b>-nomac</b></p>

<p style="margin-left:14%;">Don&rsquo;t attempt to provide
the MAC integrity.</p>

<p style="margin-top: 1em"><b>-nomaciter</b>,
<b>-noiter</b></p>

<p style="margin-left:14%;">These options affect the
iteration counts on the MAC and key algorithms. Unless you
wish to produce files compatible with MSIE 4.0, you should
leave these options alone.</p>

<p style="margin-left:14%; margin-top: 1em">To discourage
attacks by using large dictionaries of common passwords, the
algorithm that derives keys from passwords can have an
iteration count applied to it: this causes a certain part of
the algorithm to be repeated and slows it down. The MAC is
used to check the file integrity but since it will normally
have the same password as the keys and certificates it could
also be attacked. By default, both MAC and encryption
iteration counts are set to 2048; using these options the
MAC and encryption iteration counts can be set to 1. Since
this reduces the file security you should not use these
options unless you really have to. Most software supports
both MAC and key iteration counts. MSIE 4.0 doesn&rsquo;t
support MAC iteration counts, so it needs the
<b>-nomaciter</b> option.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">This specifies <i>file</i> to
write the PKCS#12 file to. Standard output is used by
default.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:14%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>PKCS12 NOTES</b></p>

<p style="margin-left:6%;">Although there are a large
number of options, most of them are very rarely used. For
PKCS#12 file parsing, only <b>-in</b> and <b>-out</b> need
to be used for PKCS#12 file creation. <b>-export</b> and
<b>-name</b> are also used.</p>

<p style="margin-left:6%; margin-top: 1em">If none of the
<b>-clcerts</b>, <b>-cacerts</b>, or <b>-nocerts</b> options
are present, then all certificates will be output in the
order they appear in the input PKCS#12 files. There is no
guarantee that the first certificate present is the one
corresponding to the private key. Certain software which
requires a private key and certificate and assumes the first
certificate in the file is the one corresponding to the
private key: this may not always be the case. Using the
<b>-clcerts</b> option will solve this problem by only
outputting the certificate corresponding to the private key.
If the CA certificates are required, they can be output to a
separate file using the <b>-nokeys</b> and <b>-cacerts</b>
options to just output CA certificates.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-keypbe</b> and <b>-certpbe</b> algorithms allow the
precise encryption algorithms for private keys and
certificates to be specified. Normally, the defaults are
fine but occasionally software can&rsquo;t handle triple DES
encrypted private keys; then the option <b>-keypbe</b>
<i>PBE-SHA1-RC2-40</i> can be used to reduce the private key
encryption to 40-bit RC2. A complete description of all
algorithms is contained in the <i>PKCS8</i> section
above.</p>

<p style="margin-top: 1em"><b>PKCS12 EXAMPLES</b></p>

<p style="margin-left:6%;">Parse a PKCS#12 file and output
it to a file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -in file.p12 -out file.pem</p>

<p style="margin-left:6%; margin-top: 1em">Output only
client certificates to a file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -in file.p12 -clcerts -out file.pem</p>

<p style="margin-left:6%; margin-top: 1em">Don&rsquo;t
encrypt the private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -in file.p12 -out file.pem -nodes</p>

<p style="margin-left:6%; margin-top: 1em">Print some info
about a PKCS#12 file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -in file.p12 -info -noout</p>

<p style="margin-left:6%; margin-top: 1em">Create a PKCS#12
file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -export -in file.pem -out file.p12 \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-name &quot;My Certificate&quot;</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Include some
extra certificates:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkcs12 -export -in file.pem -out file.p12 \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-name &quot;My Certificate&quot; -certfile
othercerts.pem</p> </td></tr>
</table>

<p style="margin-top: 1em"><b>PKCS12 BUGS</b></p>

<p style="margin-left:6%;">Some would argue that the
PKCS#12 standard is one big bug :-)</p>

<p style="margin-left:6%; margin-top: 1em">Versions of
<b>OpenSSL</b> before 0.9.6a had a bug in the PKCS#12 key
generation routines. Under rare circumstances this could
produce a PKCS#12 file encrypted with an invalid key. As a
result some PKCS#12 files which triggered this bug from
other implementations (MSIE or Netscape) could not be
decrypted by <b>OpenSSL</b> and similarly <b>OpenSSL</b>
could produce PKCS#12 files which could not be decrypted by
other implementations. The chances of producing such a file
are relatively small: less than 1 in 256.</p>

<p style="margin-left:6%; margin-top: 1em">A side effect of
fixing this bug is that any old invalidly encrypted PKCS#12
files can no longer be parsed by the fixed version. Under
such circumstances the <b>pkcs12</b> utility will report
that the MAC is OK but fail with a decryption error when
extracting private keys.</p>

<p style="margin-left:6%; margin-top: 1em">This problem can
be resolved by extracting the private keys and certificates
from the PKCS#12 file using an older version of
<b>OpenSSL</b> and recreating the PKCS#12 file from the keys
and certificates using a newer version of <b>OpenSSL</b>.
For example:</p>

<p style="margin-left:14%; margin-top: 1em">$ old-openssl
-in bad.p12 -out keycerts.pem <br>
$ openssl -in keycerts.pem -export -name &quot;My PKCS#12
file&quot; \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-out fixed.p12</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-top: 1em"><b>PKEY</b></p>

<p style="margin-left:6%;"><b>openssl pkey</b>
[<i>cipher</i>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-text</b>] [<b>-text_pub</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkey</b>
command processes public or private keys. They can be
converted between various forms and their components printed
out.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><i>cipher</i></p>

<p style="margin-left:17%; margin-top: 1em">These options
encrypt the private key with the supplied cipher. Any
algorithm name accepted by <b>EVP_get_cipherbyname</b>() is
acceptable, such as <b>des3</b>.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
filename to read a key from, or standard input if this
option is not specified. If the key is encrypted a pass
phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format, DER or PEM.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
filename to write a key to, or standard output if this
option is not specified. If any encryption options are set
then a pass phrase will be prompted for. The output filename
should <i>not</i> be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">By default a
private key is read from the input file: with this option a
public key is read instead.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">By default a private key is
output: with this option a public key will be output
instead. This option is automatically set if the input is a
public key.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Print out the
various public or private key components in plain text in
addition to the encoded version.</p>

<p style="margin-top: 1em"><b>-text_pub</b></p>

<p style="margin-left:17%;">Print out only public key
components even if a private key is being processed.</p>

<p style="margin-top: 1em"><b>PKEY EXAMPLES</b></p>

<p style="margin-left:6%;">To remove the pass phrase on an
RSA private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To encrypt a
private key using triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -des3 -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To convert a
private key from PEM to DER format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -outform DER -out keyout.der</p>

<p style="margin-left:6%; margin-top: 1em">To print the
components of a private key to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -text -noout</p>

<p style="margin-left:6%; margin-top: 1em">To print the
public components of a private key to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -text_pub -noout</p>

<p style="margin-left:6%; margin-top: 1em">To just output
the public part of a private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl pkey
-in key.pem -pubout -out pubkey.pem</p>

<p style="margin-top: 1em"><b>PKEYPARAM</b></p>

<p style="margin-left:6%;"><b>openssl pkeyparam</b>
[<b>-in</b> <i>file</i>] [<b>-noout</b>] [<b>-out</b>
<i>file</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>pkey</b>
command processes public or private keys. They can be
converted between various forms and their components printed
out.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
filename to read parameters from, or standard input if this
option is not specified.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Do not output
the encoded version of the parameters.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
filename to write parameters to, or standard output if this
option is not specified.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
parameters in plain text in addition to the encoded
version.</p>

<p style="margin-top: 1em"><b>PKEYPARAM EXAMPLES</b></p>

<p style="margin-left:6%;">Print out text version of
parameters:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyparam -in param.pem -text</p>

<p style="margin-top: 1em"><b>PKEYPARAM NOTES</b></p>

<p style="margin-left:6%;">There are no <b>-inform</b> or
<b>-outform</b> options for this command because only PEM
format is supported because the key type is determined by
the PEM headers.</p>

<p style="margin-top: 1em"><b>PKEYUTL</b></p>

<p style="margin-left:6%;"><b>openssl pkeyutl</b>
[<b>-asn1parse</b>] [<b>-certin</b>] [<b>-decrypt</b>]
[<b>-derive</b>] [<b>-encrypt</b>] [<b>-hexdump</b>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inkey&nbsp;</b><i>file</i>]
[<b>-keyform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-peerform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-peerkey&nbsp;</b><i>file</i>]
[<b>-pkeyopt&nbsp;</b><i>opt</i>:<i>value</i>]
[<b>-pubin</b>] [<b>-rev</b>]
[<b>-sigfile&nbsp;</b><i>file</i>] [<b>-sign</b>]
[<b>-verify</b>] [<b>-verifyrecover</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>pkeyutl</b> command can be used to perform public key
operations using any supported algorithm.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1parse</b></p>

<p style="margin-left:17%;">ASN1parse the output data. This
is useful when combined with the <b>-verifyrecover</b>
option when an ASN1 structure is signed.</p>

<p style="margin-top: 1em"><b>-certin</b></p>

<p style="margin-left:17%;">The input is a certificate
containing a public key.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:17%;">Decrypt the input data using a
private key.</p>

<p style="margin-top: 1em"><b>-derive</b></p>

<p style="margin-left:17%;">Derive a shared secret using
the peer key.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:17%;">Encrypt the input data using a
public key.</p>

<p style="margin-top: 1em"><b>-hexdump</b></p>

<p style="margin-left:17%;">Hex dump the output data.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">Specify the input filename to
read data from, or standard input if this option is not
specified.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:17%;">The input key file. By default
it should be a private key.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">The key format DER or PEM.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specify the output filename to
write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-peerform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">The peer key format DER or
PEM.</p>

<p style="margin-top: 1em"><b>-peerkey</b> <i>file</i></p>

<p style="margin-left:17%;">The peer key file, used by key
derivation (agreement) operations.</p>

<p style="margin-top: 1em"><b>-pkeyopt</b>
<i>opt</i>:<i>value</i></p>

<p style="margin-left:17%;">Public key options.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">The input file
is a public key.</p>

<p style="margin-top: 1em"><b>-rev</b></p>

<p style="margin-left:17%; margin-top: 1em">Reverse the
order of the input buffer. This is useful for some libraries
(such as CryptoAPI) which represent the buffer in little
endian format.</p>

<p style="margin-top: 1em"><b>-sigfile</b> <i>file</i></p>

<p style="margin-left:17%;">Signature file (verify
operation only).</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:17%; margin-top: 1em">Sign the input
data and output the signed result. This requires a private
key.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the input data against
the signature file and indicate if the verification
succeeded or failed.</p>

<p style="margin-top: 1em"><b>-verifyrecover</b></p>

<p style="margin-left:17%;">Verify the input data and
output the recovered data.</p>

<p style="margin-top: 1em"><b>PKEYUTL NOTES</b></p>

<p style="margin-left:6%;">The operations and options
supported vary according to the key algorithm and its
implementation. The <b>OpenSSL</b> operations and options
are indicated below.</p>

<p style="margin-left:6%; margin-top: 1em">Unless otherwise
mentioned all algorithms support the
<i>digest</i>:<i>alg</i> option which specifies the digest
in use for sign, verify, and verifyrecover operations. The
value <i>alg</i> should represent a digest name as used in
the <b>EVP_get_digestbyname</b>() function, for example
<b>sha1</b>.</p>

<p style="margin-left:6%; margin-top: 1em"><b>RSA
algorithm</b> <br>
The RSA algorithm supports the encrypt, decrypt, sign,
verify, and verifyrecover operations in general. Some
padding modes only support some of these operations
however.</p>


<p style="margin-top: 1em">rsa_padding_mode:<i>mode</i></p>

<p style="margin-left:17%;">This sets the RSA padding mode.
Acceptable values for <i>mode</i> are <b>pkcs1</b> for
PKCS#1 padding; <b>none</b> for no padding; <b>oaep</b> for
OAEP mode; <b>x931</b> for X9.31 mode; and <b>pss</b> for
PSS.</p>

<p style="margin-left:17%; margin-top: 1em">In PKCS#1
padding if the message digest is not set then the supplied
data is signed or verified directly instead of using a
DigestInfo structure. If a digest is set then a DigestInfo
structure is used and its length must correspond to the
digest type.</p>

<p style="margin-left:17%; margin-top: 1em">For oeap mode
only encryption and decryption is supported.</p>

<p style="margin-left:17%; margin-top: 1em">For x931 if the
digest type is set it is used to format the block data;
otherwise the first byte is used to specify the X9.31 digest
ID. Sign, verify, and verifyrecover can be performed in this
mode.</p>

<p style="margin-left:17%; margin-top: 1em">For pss mode
only sign and verify are supported and the digest type must
be specified.</p>

<p style="margin-top: 1em">rsa_pss_saltlen:<i>len</i></p>

<p style="margin-left:17%;">For pss mode only this option
specifies the salt length. Two special values are supported:
-1 sets the salt length to the digest length. When signing
-2 sets the salt length to the maximum permissible value.
When verifying -2 causes the salt length to be automatically
determined based on the PSS block structure.</p>

<p style="margin-left:6%; margin-top: 1em"><b>DSA
algorithm</b> <br>
The DSA algorithm supports the sign and verify operations.
Currently there are no additional options other than
<i>digest</i>. Only the SHA1 digest can be used and this
digest is assumed by default.</p>

<p style="margin-left:6%; margin-top: 1em"><b>DH
algorithm</b> <br>
The DH algorithm supports the derive operation and no
additional options.</p>

<p style="margin-left:6%; margin-top: 1em"><b>EC
algorithm</b> <br>
The EC algorithm supports the sign, verify, and derive
operations. The sign and verify operations use ECDSA and
derive uses ECDH. Currently there are no additional options
other than <i>digest</i>. Only the SHA1 digest can be used
and this digest is assumed by default.</p>

<p style="margin-top: 1em"><b>PKEYUTL EXAMPLES</b></p>

<p style="margin-left:6%;">Sign some data using a private
key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyutl -sign -in file -inkey key.pem -out sig</p>

<p style="margin-left:6%; margin-top: 1em">Recover the
signed data (e.g. if an RSA key is used):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyutl -verifyrecover -in sig -inkey key.pem</p>

<p style="margin-left:6%; margin-top: 1em">Verify the
signature (e.g. a DSA key):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyutl -verify -in file -sigfile sig \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-inkey key.pem</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Sign data using
a message digest value (this is currently only valid for
RSA):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyutl -sign -in file -inkey key.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out sig -pkeyopt digest:sha256</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Derive a shared
secret value:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
pkeyutl -derive -inkey key.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-peerkey pubkey.pem -out secret</p></td></tr>
</table>

<p style="margin-top: 1em"><b>PRIME</b></p>

<p style="margin-left:6%;"><b>openssl prime</b>
[<b>-bits</b> <i>n</i>] [<b>-checks</b> <i>n</i>]
[<b>-generate</b>] [<b>-hex</b>] [<b>-safe</b>] <i>p</i></p>

<p style="margin-left:6%; margin-top: 1em">The <b>prime</b>
command is used to generate prime numbers, or to check
numbers for primality. Results are probabilistic: they have
an exceedingly high likelihood of being correct, but are not
guaranteed.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-bits</b> <i>n</i></p>

<p style="margin-left:17%;">Specify the number of bits in
the generated prime number. Must be used in conjunction with
<b>-generate</b>.</p>

<p style="margin-top: 1em"><b>-checks</b> <i>n</i></p>

<p style="margin-left:17%;">Perform a Miller-Rabin
probabilistic primality test with <i>n</i> iterations. The
default is 20.</p>

<p style="margin-top: 1em"><b>-generate</b></p>

<p style="margin-left:17%;">Generate a pseudo-random prime
number. Must be used in conjunction with <b>-bits</b>.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Output in hex
format.</p>

<p style="margin-top: 1em"><b>-safe</b></p>

<p style="margin-left:17%; margin-top: 1em">Generate only
&quot;safe&quot; prime numbers (i.e. a prime p so that
(p-1)/2 is also prime).</p>

<p style="margin-top: 1em"><i>p</i></p>

<p style="margin-left:17%; margin-top: 1em">Test if number
<i>p</i> is prime.</p>

<p style="margin-top: 1em"><b>RAND</b></p>

<p style="margin-left:6%;"><b>openssl rand</b>
[<b>-base64</b>] [<b>-hex</b>] [<b>-out</b> <i>file</i>]
<i>num</i></p>

<p style="margin-left:6%; margin-top: 1em">The <b>rand</b>
command outputs <i>num</i> pseudo-random bytes.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-base64</b></p>

<p style="margin-left:17%;">Perform <i>base64</i> encoding
on the output.</p>

<p style="margin-top: 1em"><b>-hex</b></p>

<p style="margin-left:17%; margin-top: 1em">Specify
hexadecimal output.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Write to <i>file</i> instead of
standard output.</p>

<p style="margin-top: 1em"><b>REQ</b></p>

<p style="margin-left:6%;"><b>openssl req</b>
[<b>-asn1-kludge</b>] [<b>-batch</b>]
[<b>-config&nbsp;</b><i>file</i>]
[<b>-days&nbsp;</b><i>n</i>]
[<b>-extensions&nbsp;</b><i>section</i>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-key&nbsp;</b><i>keyfile</i>]
[<b>-keyform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-keyout&nbsp;</b><i>file</i>]
[<b>-md4&nbsp;</b>|&nbsp;<b>-md5&nbsp;</b>|&nbsp;<b>-sha1</b>]
[<b>-modulus</b>] [<b>-nameopt&nbsp;</b><i>option</i>]
[<b>-new</b>] [<b>-newhdr</b>]
[<b>-newkey&nbsp;</b><i>arg</i>] [<b>-no-asn1-kludge</b>]
[<b>-nodes</b>] [<b>-noout</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-pubkey</b>]
[<b>-reqexts&nbsp;</b><i>section</i>]
[<b>-reqopt&nbsp;</b><i>option</i>]
[<b>-set_serial&nbsp;</b><i>n</i>]
[<b>-subj&nbsp;</b><i>arg</i>] [<b>-subject</b>]
[<b>-text</b>] [<b>-utf8</b>] [<b>-verbose</b>]
[<b>-verify</b>] [<b>-x509</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>req</b>
command primarily creates and processes certificate requests
in PKCS#10 format. It can additionally create self-signed
certificates, for use as root CAs, for example.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1-kludge</b></p>

<p style="margin-left:17%;">By default, the <b>req</b>
command outputs certificate requests containing no
attributes in the correct PKCS#10 format. However certain
CAs will only accept requests containing no attributes in an
invalid form: this option produces this invalid format.</p>

<p style="margin-left:17%; margin-top: 1em">More precisely,
the <i>Attributes</i> in a PKCS#10 certificate request are
defined as a SET OF Attribute. They are <i>not</i> optional,
so if no attributes are present then they should be encoded
as an empty SET OF. The invalid form does not include the
empty SET OF, whereas the correct form does.</p>

<p style="margin-left:17%; margin-top: 1em">It should be
noted that very few CAs still require the use of this
option.</p>

<p style="margin-top: 1em"><b>-batch</b></p>


<p style="margin-left:17%; margin-top: 1em">Non-interactive
mode.</p>

<p style="margin-top: 1em"><b>-config</b> <i>file</i></p>

<p style="margin-left:17%;">This allows an alternative
configuration file to be specified; this overrides the
compile time filename or any specified in the OPENSSL_CONF
environment variable.</p>

<p style="margin-top: 1em"><b>-days</b> <i>n</i></p>

<p style="margin-left:17%;">When the <b>-x509</b> option is
being used, this specifies the number of days to certify the
certificate for. The default is 30 days.</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i>, <b>-reqexts</b> <i>section</i></p>

<p style="margin-left:17%;">These options specify
alternative sections to include certificate extensions (if
the <b>-x509</b> option is present) or certificate request
extensions. This allows several different sections to be
used in the same configuration file to specify requests for
a variety of purposes.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read a request from, or standard input if
this option is not specified. A request is only read if the
creation options <b>-new</b> and <b>-newkey</b> are not
specified.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The <i>DER</i> argument uses an ASN1 DER-encoded
form compatible with the PKCS#10. The <i>PEM</i> form is the
default format: it consists of the DER format base64-encoded
with additional header and footer lines.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">This specifies the file to read
the private key from. It also accepts PKCS#8 format private
keys for PEM format files.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">The format of the private key
file specified in the <b>-key</b> argument. <i>PEM</i> is
the default.</p>

<p style="margin-top: 1em"><b>-keyout</b> <i>file</i></p>

<p style="margin-left:17%;">This gives the <i>file</i> to
write the newly created private key to. If this option is
not specified, the filename present in the configuration
file is used.</p>

<p style="margin-top: 1em"><b>-md5</b> | <b>-sha1</b> |
<b>-sha256</b></p>

<p style="margin-left:17%;">This specifies the message
digest to sign the request with. This overrides the digest
algorithm specified in the configuration file.</p>

<p style="margin-left:17%; margin-top: 1em">Some public key
algorithms may override this choice. For instance, DSA
signatures always use SHA1.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">This option prints out the
value of the modulus of the public key contained in the
request.</p>

<p style="margin-top: 1em"><b>-nameopt</b> <i>option</i>,
<b>-reqopt</b> <i>option</i></p>

<p style="margin-left:17%;">These options determine how the
subject or issuer names are displayed. The <i>option</i>
argument can be a single option or multiple options
separated by commas. Alternatively, these options may be
used more than once to set multiple options. See the
<i>X509</i> section below for details.</p>

<p style="margin-top: 1em"><b>-new</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
generates a new certificate request. It will prompt the user
for the relevant field values. The actual fields prompted
for and their maximum and minimum sizes are specified in the
configuration file and any requested extensions.</p>

<p style="margin-left:17%; margin-top: 1em">If the
<b>-key</b> option is not used, it will generate a new RSA
private key using information specified in the configuration
file.</p>

<p style="margin-top: 1em"><b>-newhdr</b></p>

<p style="margin-left:17%;">Adds the word NEW to the PEM
file header and footer lines on the outputed request. Some
software (Netscape certificate server) and some CAs need
this.</p>

<p style="margin-top: 1em"><b>-newkey</b> <i>arg</i></p>

<p style="margin-left:17%;">This option creates a new
certificate request and a new private key. The argument
takes one of several forms. <i>rsa</i>:<i>nbits</i>, where
<i>nbits</i> is the number of bits, generates an RSA key
<i>nbits</i> in size. If <i>nbits</i> is omitted, i.e.
<b>-newkey rsa</b> specified, the default key size,
specified in the configuration file, is used.</p>

<p style="margin-left:17%; margin-top: 1em">All other
algorithms support the <i>alg</i>:<i>file</i> form, where
file may be an algorithm parameter file, created by the
<b>genpkey -genparam</b> command or an X.509 certificate for
a key with appropriate algorithm.</p>


<p style="margin-left:17%; margin-top: 1em"><i>param</i>:<i>file</i>
generates a key using the parameter file or certificate
<i>file</i>; the algorithm is determined by the parameters.
<i>algname</i>:<i>file</i> use algorithm <i>algname</i> and
parameter file <i>file</i>: the two algorithms must match or
an error occurs. <i>algname</i> just uses algorithm
<i>algname</i>, and parameters, if necessary, should be
specified via the <b>-pkeyopt</b> option.</p>


<p style="margin-left:17%; margin-top: 1em"><i>dsa</i>:<i>file</i>
generates a DSA key using the parameters in the file
<i>file</i>.</p>

<p style="margin-top: 1em"><b>-no-asn1-kludge</b></p>

<p style="margin-left:17%;">Reverses the effect of
<b>-asn1-kludge</b>.</p>

<p style="margin-top: 1em"><b>-nodes</b></p>

<p style="margin-left:17%; margin-top: 1em">If this option
is specified and a private key is created, it will not be
encrypted.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prevents output of the encoded version of the request.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:17%;">Outputs the public key.</p>

<p style="margin-top: 1em"><b>-reqopt</b> <i>option</i></p>

<p style="margin-left:17%;">Customise the output format
used with <b>-text</b>. The <i>option</i> argument can be a
single option or multiple options separated by commas.</p>

<p style="margin-left:17%; margin-top: 1em">See the
discussion of the <b>-certopt</b> option in the <b>x509</b>
command.</p>

<p style="margin-top: 1em"><b>-set_serial</b> <i>n</i></p>

<p style="margin-left:17%;">Serial number to use when
outputting a self-signed certificate. This may be specified
as a decimal value or a hex value if preceded by
&rsquo;0x&rsquo;. It is possible to use negative serial
numbers but this is not recommended.</p>

<p style="margin-top: 1em"><b>-subj</b> <i>arg</i></p>

<p style="margin-left:17%;">Replaces subject field of input
request with specified data and outputs modified request.
The arg must be formatted as
<i>/type0=value0/type1=value1/type2=...</i>; characters may
be escaped by &rsquo;\&rsquo; (backslash); no spaces are
skipped.</p>

<p style="margin-top: 1em"><b>-subject</b></p>

<p style="margin-left:17%;">Prints out the request subject
(or certificate subject if <b>-x509</b> is specified.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
certificate request in text form.</p>

<p style="margin-top: 1em"><b>-utf8</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
causes field values to be interpreted as UTF8 strings; by
default they are interpreted as ASCII. This means that the
field values, whether prompted from a terminal or obtained
from a configuration file, must be valid UTF8 strings.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:17%;">Print extra details about the
operations being performed.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verifies the signature on the
request.</p>

<p style="margin-top: 1em"><b>-x509</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
outputs a self-signed certificate instead of a certificate
request. This is typically used to generate a test
certificate or a self-signed root CA. The extensions added
to the certificate (if any) are specified in the
configuration file. Unless specified using the
<b>-set_serial</b> option, 0 will be used for the serial
number.</p>

<p style="margin-top: 1em"><b>REQ CONFIGURATION FILE
FORMAT</b></p>

<p style="margin-left:6%;">The configuration options are
specified in the <i>req</i> section of the configuration
file. As with all configuration files, if no value is
specified in the specific section (i.e. <i>req</i>) then the
initial unnamed or <i>default</i> section is searched
too.</p>

<p style="margin-left:6%; margin-top: 1em">The options
available are described in detail below.</p>

<p style="margin-top: 1em"><i>attributes</i></p>

<p style="margin-left:14%;">This specifies the section
containing any request attributes: its format is the same as
<i>distinguished_name</i>. Typically these may contain the
<i>challengePassword</i> or <i>unstructuredName</i> types.
They are currently ignored by <b>OpenSSL</b>&rsquo;s request
signing utilities, but some CAs might want them.</p>

<p style="margin-top: 1em"><i>default_bits</i></p>

<p style="margin-left:14%;">This specifies the default key
size in bits. If not specified, 2048 is used. It is used if
the <b>-new</b> option is used. It can be overridden by
using the <b>-newkey</b> option.</p>

<p style="margin-top: 1em"><i>default_keyfile</i></p>

<p style="margin-left:14%;">This is the default file to
write a private key to. If not specified, the key is written
to standard output. This can be overridden by the
<b>-keyout</b> option.</p>

<p style="margin-top: 1em"><i>default_md</i></p>

<p style="margin-left:14%;">This option specifies the
digest algorithm to use. Possible values include <i>md5</i>,
<i>sha1</i> and <i>sha256</i>. If not present, SHA256 is
used. This option can be overridden on the command line.</p>

<p style="margin-top: 1em"><i>distinguished_name</i></p>

<p style="margin-left:14%;">This specifies the section
containing the distinguished name fields to prompt for when
generating a certificate or certificate request. The format
is described in the next section.</p>

<p style="margin-top: 1em"><i>encrypt_key</i></p>

<p style="margin-left:14%;">If this is set to <i>no</i> and
a private key is generated, it is <i>not</i> encrypted. This
is equivalent to the <b>-nodes</b> command line option. For
compatibility, <i>encrypt_rsa_key</i> is an equivalent
option.</p>

<p style="margin-top: 1em"><i>input_password</i> |
<i>output_password</i></p>

<p style="margin-left:14%;">The passwords for the input
private key file (if present) and the output private key
file (if one will be created). The command line options
<b>-passin</b> and <b>-passout</b> override the
configuration file values.</p>

<p style="margin-top: 1em"><i>oid_file</i></p>

<p style="margin-left:14%;">This specifies a file
containing additional OBJECT IDENTIFIERS. Each line of the
file should consist of the numerical form of the object
identifier, followed by whitespace, then the short name
followed by whitespace and finally the long name.</p>

<p style="margin-top: 1em"><i>oid_section</i></p>

<p style="margin-left:14%;">This specifies a section in the
configuration file containing extra object identifiers. Each
line should consist of the short name of the object
identifier followed by &rsquo;=&rsquo; and the numerical
form. The short and long names are the same when this option
is used.</p>

<p style="margin-top: 1em"><i>prompt</i></p>

<p style="margin-left:14%;">If set to the value <i>no</i>,
this disables prompting of certificate fields and just takes
values from the config file directly. It also changes the
expected format of the <i>distinguished_name</i> and
<i>attributes</i> sections.</p>

<p style="margin-top: 1em"><i>req_extensions</i></p>

<p style="margin-left:14%;">This specifies the
configuration file section containing a list of extensions
to add to the certificate request. It can be overridden by
the <b>-reqexts</b> command line switch.</p>

<p style="margin-top: 1em"><i>string_mask</i></p>

<p style="margin-left:14%;">This option limits the string
types for encoding certain fields. The following values may
be used, limiting strings to the indicated types:</p>

<p style="margin-top: 1em"><i>utf8only</i></p>


<p style="margin-left:31%; margin-top: 1em"><i>UTF8String.</i>
This is the default, as recommended by PKIX in RFC 2459.</p>

<p style="margin-top: 1em"><i>default</i></p>


<p style="margin-left:31%; margin-top: 1em"><i>PrintableString</i>,
<i>IA5String</i>, <i>T61String</i>, <i>BMPString</i>,
<i>UTF8String</i>.</p>

<p style="margin-top: 1em"><i>pkix</i></p>


<p style="margin-left:31%; margin-top: 1em"><i>PrintableString</i>,
<i>IA5String</i>, <i>BMPString</i>, <i>UTF8String</i>. This
was inspired by the PKIX recommendation in RFC 2459 for
certificates generated before 2004, but differs by also
permitting <i>IA5String</i>.</p>

<p style="margin-top: 1em"><i>nombstr</i></p>


<p style="margin-left:31%; margin-top: 1em"><i>PrintableString</i>,
<i>IA5String</i>, <i>T61String</i>, <i>UniversalString</i>.
This was a workaround for some ancient software that had
problems with the variable-sized <i>BMPString</i> and
<i>UTF8String</i> types.</p>

<p style="margin-top: 1em"><b>MASK</b>:<i>number</i></p>

<p style="margin-left:31%; margin-top: 1em">This is an
explicit bitmask of permitted types, where <i>number</i> is
a C-style hex, decimal, or octal number that&rsquo;s a
bit-wise OR of B_ASN1_* values from
&lt;<i>openssl/asn1.h</i>&gt;.</p>

<p style="margin-top: 1em"><i>utf8</i></p>

<p style="margin-left:14%; margin-top: 1em">If set to the
value <i>yes</i>, then field values are interpreted as UTF8
strings; by default they are interpreted as ASCII. This
means that the field values, whether prompted from a
terminal or obtained from a configuration file, must be
valid UTF8 strings.</p>

<p style="margin-top: 1em"><i>x509_extensions</i></p>

<p style="margin-left:14%;">This specifies the
configuration file section containing a list of extensions
to add to a certificate generated when the <b>-x509</b>
switch is used. It can be overridden by the
<b>-extensions</b> command line switch.</p>

<p style="margin-top: 1em"><b>REQ DISTINGUISHED NAME AND
ATTRIBUTE SECTION FORMAT</b></p>

<p style="margin-left:6%;">There are two separate formats
for the distinguished name and attribute sections. If the
<b>-prompt</b> option is set to <i>no</i>, then these
sections just consist of field names and values: for
example,</p>

<p style="margin-left:14%; margin-top: 1em">CN=My Name <br>
OU=My Organization <br>
emailAddress=someone@somewhere.org</p>

<p style="margin-left:6%; margin-top: 1em">This allows
external programs (e.g. GUI based) to generate a template
file with all the field names and values and just pass it to
<b>req</b>. An example of this kind of configuration file is
contained in the <i>REQ EXAMPLES</i> section.</p>

<p style="margin-left:6%; margin-top: 1em">Alternatively if
the <b>-prompt</b> option is absent or not set to <i>no</i>,
then the file contains field prompting information. It
consists of lines of the form:</p>


<p style="margin-left:14%; margin-top: 1em">fieldName=&quot;prompt&quot;
<br>
fieldName_default=&quot;default field value&quot; <br>
fieldName_min= 2 <br>
fieldName_max= 4</p>


<p style="margin-left:6%; margin-top: 1em">&quot;fieldName&quot;
is the field name being used, for example <i>commonName</i>
(or CN). The &quot;prompt&quot; string is used to ask the
user to enter the relevant details. If the user enters
nothing, the default value is used; if no default value is
present, the field is omitted. A field can still be omitted
if a default value is present, if the user just enters the
&rsquo;.&rsquo; character.</p>

<p style="margin-left:6%; margin-top: 1em">The number of
characters entered must be between the <i>fieldName_min</i>
and <i>fieldName_max</i> limits: there may be additional
restrictions based on the field being used (for example
<i>countryName</i> can only ever be two characters long and
must fit in a <i>PrintableString</i>).</p>

<p style="margin-left:6%; margin-top: 1em">Some fields
(such as <i>organizationName</i>) can be used more than once
in a DN. This presents a problem because configuration files
will not recognize the same name occurring twice. To avoid
this problem, if the <i>fieldName</i> contains some
characters followed by a full stop, they will be ignored.
So, for example, a second <i>organizationName</i> can be
input by calling it &quot;1.organizationName&quot;.</p>

<p style="margin-left:6%; margin-top: 1em">The actual
permitted field names are any object identifier short or
long names. These are compiled into <b>OpenSSL</b> and
include the usual values such as <i>commonName</i>,
<i>countryName</i>, <i>localityName</i>,
<i>organizationName</i>, <i>organizationUnitName</i>,
<i>stateOrProvinceName</i>. Additionally,
<i>emailAddress</i> is included as well as <i>name</i>,
<i>surname</i>, <i>givenName initials</i> and
<i>dnQualifier</i>.</p>

<p style="margin-left:6%; margin-top: 1em">Additional
object identifiers can be defined with the <i>oid_file</i>
or <i>oid_section</i> options in the configuration file. Any
additional fields will be treated as though they were a
<i>DirectoryString</i>.</p>

<p style="margin-top: 1em"><b>REQ EXAMPLES</b></p>

<p style="margin-left:6%;">Examine and verify a certificate
request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl req
-in req.pem -text -verify -noout</p>

<p style="margin-left:6%; margin-top: 1em">Create a private
key and then generate a certificate request from it:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
genrsa -out key.pem 2048 <br>
$ openssl req -new -key key.pem -out req.pem</p>

<p style="margin-left:6%; margin-top: 1em">The same but
just using req:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl req
-newkey rsa:2048 -keyout key.pem -out req.pem</p>

<p style="margin-left:6%; margin-top: 1em">Generate a
self-signed root certificate:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl req
-x509 -newkey rsa:2048 -keyout key.pem -out req.pem</p>

<p style="margin-left:6%; margin-top: 1em">Example of a
file pointed to by the <i>oid_file</i> option:</p>

<p style="margin-left:14%; margin-top: 1em">1.2.3.4
shortName A longer Name <br>
1.2.3.6 otherName Other longer Name</p>

<p style="margin-left:6%; margin-top: 1em">Example of a
section pointed to by <i>oid_section</i> making use of
variable expansion:</p>


<p style="margin-left:14%; margin-top: 1em">testoid1=1.2.3.5
<br>
testoid2=${testoid1}.6</p>

<p style="margin-left:6%; margin-top: 1em">Sample
configuration file prompting for field values:</p>

<p style="margin-left:6%; margin-top: 1em">[ req ] <br>
default_bits = 1024 <br>
default_keyfile = privkey.pem <br>
distinguished_name = req_distinguished_name <br>
attributes = req_attributes <br>
x509_extensions = v3_ca</p>

<p style="margin-left:6%; margin-top: 1em">dirstring_type =
nobmp</p>

<p style="margin-left:6%; margin-top: 1em">[
req_distinguished_name ] <br>
countryName = Country Name (2 letter code) <br>
countryName_default = AU <br>
countryName_min = 2 <br>
countryName_max = 2</p>

<p style="margin-left:6%; margin-top: 1em">localityName =
Locality Name (eg, city)</p>


<p style="margin-left:6%; margin-top: 1em">organizationalUnitName
= Organizational Unit Name (eg, section)</p>

<p style="margin-left:6%; margin-top: 1em">commonName =
Common Name (eg, YOUR name) <br>
commonName_max = 64</p>

<p style="margin-left:6%; margin-top: 1em">emailAddress =
Email Address <br>
emailAddress_max = 40</p>

<p style="margin-left:6%; margin-top: 1em">[ req_attributes
] <br>
challengePassword = A challenge password <br>
challengePassword_min = 4 <br>
challengePassword_max = 20</p>

<p style="margin-left:6%; margin-top: 1em">[ v3_ca ]</p>


<p style="margin-left:6%; margin-top: 1em">subjectKeyIdentifier=hash
<br>
authorityKeyIdentifier=keyid:always,issuer:always <br>
basicConstraints = CA:true</p>

<p style="margin-left:6%; margin-top: 1em">Sample
configuration containing all field values:</p>

<p style="margin-left:6%; margin-top: 1em">[ req ] <br>
default_bits = 1024 <br>
default_keyfile = keyfile.pem <br>
distinguished_name = req_distinguished_name <br>
attributes = req_attributes <br>
prompt = no <br>
output_password = mypass</p>

<p style="margin-left:6%; margin-top: 1em">[
req_distinguished_name ] <br>
C = GB <br>
ST = Test State or Province <br>
L = Test Locality <br>
O = Organization Name <br>
OU = Organizational Unit Name <br>
CN = Common Name <br>
emailAddress = test@email.address</p>

<p style="margin-left:6%; margin-top: 1em">[ req_attributes
] <br>
challengePassword = A challenge password</p>

<p style="margin-top: 1em"><b>REQ NOTES</b></p>

<p style="margin-left:6%;">The header and footer lines in
the PEM format are normally:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
CERTIFICATE REQUEST----- <br>
-----END CERTIFICATE REQUEST-----</p>

<p style="margin-left:6%; margin-top: 1em">Some software
(some versions of Netscape certificate server) instead
needs:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN NEW
CERTIFICATE REQUEST----- <br>
-----END NEW CERTIFICATE REQUEST-----</p>

<p style="margin-left:6%; margin-top: 1em">which is
produced with the <b>-newhdr</b> option but is otherwise
compatible. Either form is accepted transparently on
input.</p>

<p style="margin-left:6%; margin-top: 1em">The certificate
requests generated by Xenroll with MSIE have extensions
added. It includes the <i>keyUsage</i> extension which
determines the type of key (signature only or general
purpose) and any additional OIDs entered by the script in an
<i>extendedKeyUsage</i> extension.</p>

<p style="margin-top: 1em"><b>REQ DIAGNOSTICS</b></p>

<p style="margin-left:6%;">The following messages are
frequently asked about:</p>

<p style="margin-left:14%; margin-top: 1em">Using
configuration from /some/path/openssl.cnf <br>
Unable to load config info</p>

<p style="margin-left:6%; margin-top: 1em">This is followed
some time later by...</p>

<p style="margin-left:14%; margin-top: 1em">unable to find
&rsquo;distinguished_name&rsquo; in config <br>
problems making Certificate Request</p>

<p style="margin-left:6%; margin-top: 1em">The first error
message is the clue: it can&rsquo;t find the configuration
file! Certain operations (like examining a certificate
request) don&rsquo;t need a configuration file so its use
isn&rsquo;t enforced. Generation of certificates or
requests, however, do need a configuration file. This could
be regarded as a bug.</p>

<p style="margin-left:6%; margin-top: 1em">Another puzzling
message is this:</p>

<p style="margin-left:14%; margin-top: 1em">Attributes:
<br>
a0:00</p>

<p style="margin-left:6%; margin-top: 1em">This is
displayed when no attributes are present and the request
includes the correct empty SET OF structure (the DER
encoding of which is 0xa0 0x00). If you just see:</p>


<p style="margin-left:14%; margin-top: 1em">Attributes:</p>

<p style="margin-left:6%; margin-top: 1em">then the SET OF
is missing and the encoding is technically invalid (but it
is tolerated). See the description of the command line
option <b>-asn1-kludge</b> for more information.</p>

<p style="margin-top: 1em"><b>REQ ENVIRONMENT
VARIABLES</b></p>

<p style="margin-left:6%;">The variable OPENSSL_CONF, if
defined, allows an alternative configuration file location
to be specified; it will be overridden by the <b>-config</b>
command line switch if it is present.</p>

<p style="margin-top: 1em"><b>REQ BUGS</b></p>

<p style="margin-left:6%;"><b>OpenSSL</b>&rsquo;s handling
of T61Strings (aka TeletexStrings) is broken: it effectively
treats them as ISO 8859-1 (Latin 1); Netscape and MSIE have
similar behaviour. This can cause problems if you need
characters that aren&rsquo;t available in
<i>PrintableStrings</i> and you don&rsquo;t want to or
can&rsquo;t use <i>BMPStrings</i>.</p>

<p style="margin-left:6%; margin-top: 1em">As a consequence
of the T61String handling, the only correct way to represent
accented characters in <b>OpenSSL</b> is to use a
<i>BMPString</i>: unfortunately Netscape currently chokes on
these. If you have to use accented characters with Netscape
and MSIE then you currently need to use the invalid
T61String form.</p>

<p style="margin-left:6%; margin-top: 1em">The current
prompting is not very friendly. It doesn&rsquo;t allow you
to confirm what you&rsquo;ve just entered. Other things,
like extensions in certificate requests, are statically
defined in the configuration file. Some of these, like an
email address in <i>subjectAltName</i>, should be input by
the user.</p>

<p style="margin-top: 1em"><b>RSA</b></p>

<p style="margin-left:6%;"><b>openssl rsa</b> [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|
<b>-des&nbsp;</b>|&nbsp;<b>-des3</b> ] [<b>-check</b>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>NET&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-modulus</b>] [<b>-noout</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>NET&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-passout&nbsp;</b><i>arg</i>] [<b>-pubin</b>]
[<b>-pubout</b>] [<b>-sgckey</b>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>rsa</b>
command processes RSA keys. They can be converted between
various forms and their components printed out.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>:
this command uses the traditional <b>SSLeay</b> compatible
format for private key encryption: newer applications should
use the more secure PKCS#8 format using the <b>pkcs8</b>
utility.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b></p>

<p style="margin-left:17%;">These options encrypt the
private key with the AES, DES, or the triple DES ciphers,
respectively, before outputting it. A pass phrase is
prompted for. If none of these options are specified, the
key is written in plain text. This means that using the
<b>rsa</b> utility to read in an encrypted key with no
encryption option can be used to remove the pass phrase from
a key, or by setting the encryption options it can be used
to add or change the pass phrase. These options can only be
used with PEM format output files.</p>

<p style="margin-top: 1em"><b>-check</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
checks the consistency of an RSA private key.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read a key from, or standard input if this
option is not specified. If the key is encrypted, a pass
phrase will be prompted for.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>NET</i> | <i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The <i>DER</i> argument uses an ASN1 DER-encoded
form compatible with the PKCS#1 RSAPrivateKey or
SubjectPublicKeyInfo format. The <i>PEM</i> form is the
default format: it consists of the DER format base64-encoded
with additional header and footer lines. On input PKCS#8
format private keys are also accepted. The <i>NET</i> form
is a format described in the <i>RSA NOTES</i> section.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prevents output of the encoded version of the key.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:17%;">This option prints out the
value of the modulus of the key.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write a key to, or standard output if this
option is not specified. If any encryption options are set,
a pass phrase will be prompted for. The output filename
should <i>not</i> be the same as the input filename.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>NET</i> | <i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-passout</b> <i>arg</i></p>

<p style="margin-left:17%;">The output file password
source.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">By default, a
private key is read from the input file; with this option a
public key is read instead.</p>

<p style="margin-top: 1em"><b>-pubout</b></p>

<p style="margin-left:17%;">By default, a private key is
output; with this option a public key will be output
instead. This option is automatically set if the input is a
public key.</p>

<p style="margin-top: 1em"><b>-sgckey</b></p>

<p style="margin-left:17%;">Use the modified <i>NET</i>
algorithm used with some versions of Microsoft IIS and SGC
keys.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
various public or private key components in plain text, in
addition to the encoded version.</p>

<p style="margin-top: 1em"><b>RSA NOTES</b></p>

<p style="margin-left:6%;">The PEM private key format uses
the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN RSA
PRIVATE KEY----- <br>
-----END RSA PRIVATE KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">The PEM public
key format uses the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PUBLIC KEY----- <br>
-----END PUBLIC KEY-----</p>

<p style="margin-left:6%; margin-top: 1em">The <i>NET</i>
form is a format compatible with older Netscape servers and
Microsoft IIS .key files; this uses unsalted RC4 for its
encryption. It is not very secure and so should only be used
when necessary.</p>

<p style="margin-left:6%; margin-top: 1em">Some newer
version of IIS have additional data in the exported .key
files. To use these with the <b>rsa</b> utility, view the
file with a binary editor and look for the string
&quot;private-key&quot;, then trace back to the byte
sequence 0x30, 0x82 (this is an ASN1 SEQUENCE). Copy all the
data from this point onwards to another file and use that as
the input to the <b>rsa</b> utility with the <b>-inform</b>
<i>NET</i> option. If there is an error after entering the
password, try the <b>-sgckey</b> option.</p>

<p style="margin-top: 1em"><b>RSA EXAMPLES</b></p>

<p style="margin-left:6%;">To remove the pass phrase on an
RSA private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl rsa
-in key.pem -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To encrypt a
private key using triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl rsa
-in key.pem -des3 -out keyout.pem</p>

<p style="margin-left:6%; margin-top: 1em">To convert a
private key from PEM to DER format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl rsa
-in key.pem -outform DER -out keyout.der</p>

<p style="margin-left:6%; margin-top: 1em">To print out the
components of a private key to standard output:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl rsa
-in key.pem -text -noout</p>

<p style="margin-left:6%; margin-top: 1em">To just output
the public part of a private key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl rsa
-in key.pem -pubout -out pubkey.pem</p>

<p style="margin-top: 1em"><b>RSA BUGS</b></p>

<p style="margin-left:6%;">The command line password
arguments don&rsquo;t currently work with <i>NET</i>
format.</p>

<p style="margin-left:6%; margin-top: 1em">There should be
an option that automatically handles .key files, without
having to manually edit them.</p>

<p style="margin-top: 1em"><b>RSAUTL</b></p>

<p style="margin-left:6%;"><b>openssl rsautl</b>
[<b>-asn1parse</b>] [<b>-certin</b>] [<b>-decrypt</b>]
[<b>-encrypt</b>] [<b>-hexdump</b>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inkey&nbsp;</b><i>file</i>]
[<b>-keyform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-oaep&nbsp;</b>|&nbsp;<b>-pkcs&nbsp;</b>|&nbsp;<b>-raw&nbsp;</b>|&nbsp;<b>-ssl</b>]
[<b>-out&nbsp;</b><i>file</i>] [<b>-pubin</b>]
[<b>-sign</b>] [<b>-verify</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>rsautl</b> command can be used to sign, verify, encrypt
and decrypt data using the RSA algorithm.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-asn1parse</b></p>

<p style="margin-left:17%;">Asn1parse the output data; this
is useful when combined with the <b>-verify</b> option.</p>

<p style="margin-top: 1em"><b>-certin</b></p>

<p style="margin-left:17%;">The input is a certificate
containing an RSA public key.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:17%;">Decrypt the input data using an
RSA private key.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:17%;">Encrypt the input data using an
RSA public key.</p>

<p style="margin-top: 1em"><b>-hexdump</b></p>

<p style="margin-left:17%;">Hex dump the output data.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read data from, or standard input if this
option is not specified.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:17%;">The input key file, by default
it should be an RSA private key.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">Private ket format. Default is
<i>PEM</i>.</p>

<p style="margin-top: 1em"><b>-oaep</b> | <b>-pkcs</b> |
<b>-raw</b> | <b>-ssl</b></p>

<p style="margin-left:17%;">The padding to use: PKCS#1
OAEP, PKCS#1 v1.5 (the default), or no padding,
respectively. For signatures, only <b>-pkcs</b> and
<b>-raw</b> can be used.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specifies the output
<i>file</i> to write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-pubin</b></p>

<p style="margin-left:17%; margin-top: 1em">The input file
is an RSA public key.</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:17%; margin-top: 1em">Sign the input
data and output the signed result. This requires an RSA
private key.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verify the input data and
output the recovered data.</p>

<p style="margin-top: 1em"><b>RSAUTL NOTES</b></p>

<p style="margin-left:6%;"><b>rsautl</b>, because it uses
the RSA algorithm directly, can only be used to sign or
verify small pieces of data.</p>

<p style="margin-top: 1em"><b>RSAUTL EXAMPLES</b></p>

<p style="margin-left:6%;">Sign some data using a private
key:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
rsautl -sign -in file -inkey key.pem -out sig</p>

<p style="margin-left:6%; margin-top: 1em">Recover the
signed data:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
rsautl -verify -in sig -inkey key.pem</p>

<p style="margin-left:6%; margin-top: 1em">Examine the raw
signed data: &nbsp;</p>

<p style="margin-left:6%; margin-top: 1em">$ openssl rsautl
-verify -in file -inkey key.pem -raw -hexdump</p>

<p style="margin-left:6%; margin-top: 1em">0000 - 00 01 ff
ff ff ff ff ff-ff ff ff ff ff ff ff ff ................ <br>
0010 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0020 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0030 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0040 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0050 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0060 - ff ff ff ff ff ff ff ff-ff ff ff ff ff ff ff ff
................ <br>
0070 - ff ff ff ff 00 68 65 6c-6c 6f 20 77 6f 72 6c 64
.....hello world</p>

<p style="margin-left:6%; margin-top: 1em">The PKCS#1 block
formatting is evident from this. If this was done using
encrypt and decrypt, the block would have been of type 2
(the second byte) and random padding data visible instead of
the 0xff bytes.</p>

<p style="margin-left:6%; margin-top: 1em">It is possible
to analyse the signature of certificates using this utility
in conjunction with <b>asn1parse</b>. Consider the
self-signed example in <i>certs/pca-cert.pem</i>: running
<b>asn1parse</b> as follows yields: &nbsp;</p>

<p style="margin-left:6%; margin-top: 1em">$ openssl
asn1parse -in pca-cert.pem</p>

<p style="margin-left:6%; margin-top: 1em">0:d=0 hl=4 l=
742 cons: SEQUENCE <br>
4:d=1 hl=4 l= 591 cons: SEQUENCE <br>
8:d=2 hl=2 l= 3 cons: cont [ 0 ] <br>
10:d=3 hl=2 l= 1 prim: INTEGER :02 <br>
13:d=2 hl=2 l= 1 prim: INTEGER :00 <br>
16:d=2 hl=2 l= 13 cons: SEQUENCE <br>
18:d=3 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>
29:d=3 hl=2 l= 0 prim: NULL <br>
31:d=2 hl=2 l= 92 cons: SEQUENCE <br>
33:d=3 hl=2 l= 11 cons: SET <br>
35:d=4 hl=2 l= 9 cons: SEQUENCE <br>
37:d=5 hl=2 l= 3 prim: OBJECT :countryName <br>
42:d=5 hl=2 l= 2 prim: PRINTABLESTRING :AU <br>
.... <br>
599:d=1 hl=2 l= 13 cons: SEQUENCE <br>
601:d=2 hl=2 l= 9 prim: OBJECT :md5WithRSAEncryption <br>
612:d=2 hl=2 l= 0 prim: NULL <br>
614:d=1 hl=3 l= 129 prim: BIT STRING</p>

<p style="margin-left:6%; margin-top: 1em">The final BIT
STRING contains the actual signature. It can be extracted
with:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
asn1parse -in pca-cert.pem -out sig -noout -strparse 614</p>

<p style="margin-left:6%; margin-top: 1em">The certificate
public key can be extracted with:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in test/testx509.pem -pubkey -noout &gt;pubkey.pem</p>

<p style="margin-left:6%; margin-top: 1em">The signature
can be analysed with: &nbsp;</p>

<p style="margin-left:6%; margin-top: 1em">$ openssl rsautl
-in sig -verify -asn1parse -inkey pubkey.pem -pubin</p>

<p style="margin-left:6%; margin-top: 1em">0:d=0 hl=2 l= 32
cons: SEQUENCE <br>
2:d=1 hl=2 l= 12 cons: SEQUENCE <br>
4:d=2 hl=2 l= 8 prim: OBJECT :md5 <br>
14:d=2 hl=2 l= 0 prim: NULL <br>
16:d=1 hl=2 l= 16 prim: OCTET STRING <br>
0000 - f3 46 9e aa 1a 4a 73 c9-37 ea 93 00 48 25 08 b5
.F...Js.7...H%..</p>

<p style="margin-left:6%; margin-top: 1em">This is the
parsed version of an ASN1 <i>DigestInfo</i> structure. It
can be seen that the digest used was MD5. The actual part of
the certificate that was signed can be extracted with:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
asn1parse -in pca-cert.pem -out tbs -noout -strparse 4</p>

<p style="margin-left:6%; margin-top: 1em">and its digest
computed with:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl md5
-c tbs <br>
MD5(tbs)=
f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5</p>

<p style="margin-left:6%; margin-top: 1em">which it can be
seen agrees with the recovered value above.</p>

<p style="margin-top: 1em"><b>S_CLIENT</b></p>

<p style="margin-left:6%;"><b>openssl s_client</b>
[<b>-4&nbsp;</b>|&nbsp;<b>-6</b>] [<b>-bugs</b>]
[<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-cert&nbsp;</b><i>file</i>] [<b>-check_ss_sig</b>]
[<b>-cipher&nbsp;</b><i>cipherlist</i>] [</p>

<p><b>-connect&nbsp;</b><i>host</i>:<i>port&nbsp;</i>|
<i>host</i>/<i>port</i> ] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-crlf</b>] [<b>-debug</b>]
[<b>-extended_crl</b>] [<b>-ign_eof</b>]
[<b>-ignore_critical</b>] [<b>-issuer_checks</b>]
[<b>-key&nbsp;</b><i>keyfile</i>] [<b>-msg</b>]
[<b>-nbio</b>] [<b>-nbio_test</b>] [<b>-no_ticket</b>]
[<b>-no_tls1</b>] [<b>-no_tls1_1</b>] [<b>-no_tls1_2</b>]
[<b>-pause</b>] [<b>-policy_check</b>] [<b>-prexit</b>]
[<b>-proxy&nbsp;</b><i>host</i>:<i>port</i>]
[<b>-psk&nbsp;</b><i>key</i>]
[<b>-psk_identity&nbsp;</b><i>identity</i>] [<b>-quiet</b>]
[<b>-reconnect</b>] [<b>-servername&nbsp;</b><i>name</i>]
[<b>-showcerts</b>] [<b>-starttls&nbsp;</b><i>protocol</i>]
[<b>-state</b>] [<b>-tls1</b>] [<b>-tls1_1</b>]
[<b>-tls1_2</b>] [<b>-tlsextdebug</b>]
[<b>-verify&nbsp;</b><i>depth</i>] [<b>-x509_strict</b>]
[<b>-xmpphost&nbsp;</b><i>host</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_client</b> command implements a generic SSL/TLS client
which connects to a remote host using SSL/TLS. It is a
<i>very</i> useful diagnostic tool for SSL servers.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-4</b></p>

<p style="margin-left:17%; margin-top: 1em">Specify that
<b>s_client</b> should attempt connections using IPv4
only.</p>

<p style="margin-top: 1em"><b>-6</b></p>

<p style="margin-left:17%; margin-top: 1em">Specify that
<b>s_client</b> should attempt connections using IPv6
only.</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">There are
several known bugs in SSL and TLS implementations. Adding
this option enables various workarounds.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> containing
trusted certificates to use during server authentication and
to use when attempting to build the client certificate
chain.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The <i>directory</i> to use for
server certificate verification. This directory must be in
&quot;hash format&quot;; see <b>-verify</b> for more
information. These are also used when building the client
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use, if one
is requested by the server. The default is not to use a
certificate.</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b>,
<b>-crl_check</b>, <b>-crl_check_all</b>,
<b>-extended_crl</b>, <b>-ignore_critical</b>,
<b>-issuer_checks</b>, <b>-policy_check</b>,
<b>-x509_strict</b></p>

<p style="margin-left:17%;">Set various certificate chain
validation options. See the <b>VERIFY</b> command for
details.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">This allows the cipher list
sent by the client to be modified. Although the server
determines which cipher suite is used, it should take the
first supported cipher in the list sent by the client. See
the <i>CIPHERS</i> section above for more information.</p>

<p style="margin-top: 1em"><b>-connect</b>
<i>host</i>:<i>port</i> | <i>host</i>/<i>port</i></p>

<p style="margin-left:17%;">This specifies the <i>host</i>
and optional <i>port</i> to connect to. If not specified, an
attempt is made to connect to the local host on port 4433.
Alternatively, the host and port pair may be separated using
a forward-slash character. This form is useful for numeric
IPv6 addresses.</p>

<p style="margin-top: 1em"><b>-crlf</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
translates a line feed from the terminal into CR+LF as
required by some servers.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Print extensive
debugging information including a hex dump of all
traffic.</p>

<p style="margin-top: 1em"><b>-ign_eof</b></p>

<p style="margin-left:17%;">Inhibit shutting down the
connection when end of file is reached in the input.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used.</p>

<p style="margin-top: 1em"><b>-msg</b></p>

<p style="margin-left:17%; margin-top: 1em">Show all
protocol messages with hex dump.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turns on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-nbio_test</b></p>

<p style="margin-left:17%;">Tests non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-no_tls1</b> |
<b>-no_tls1_1</b> | <b>-no_tls1_2</b></p>

<p style="margin-left:17%;">By default, the initial
handshake uses a method which should be compatible with
servers supporting any version of TLS. These options disable
the use of TLS1.0, 1.1, and 1.2, respectively.</p>

<p style="margin-left:17%; margin-top: 1em">Unfortunately
there are a lot of ancient and broken servers in use which
cannot handle this technique and will fail to connect.</p>

<p style="margin-top: 1em"><b>-no_ticket</b></p>

<p style="margin-left:17%;">Disable RFC 4507 session ticket
support.</p>

<p style="margin-top: 1em"><b>-pause</b></p>

<p style="margin-left:17%; margin-top: 1em">Pauses 1 second
between each read and write call.</p>

<p style="margin-top: 1em"><b>-prexit</b></p>

<p style="margin-left:17%;">Print session information when
the program exits. This will always attempt to print out
information even if the connection fails. Normally,
information will only be printed out once if the connection
succeeds. This option is useful because the cipher in use
may be renegotiated or the connection may fail because a
client certificate is required or is requested only after an
attempt is made to access a certain URL. <b>Note</b>: the
output produced by this option is not always accurate
because a connection might never have been established.</p>

<p style="margin-top: 1em"><b>-proxy</b>
<i>host</i>:<i>port</i></p>

<p style="margin-left:17%;">Use the HTTP proxy at
<i>host</i> and <i>port</i>. The connection to the proxy is
done in cleartext and the <b>-connect</b> argument is given
to the proxy. If not specified, localhost is used as final
destination. After that, switch the connection through the
proxy to the destination to TLS.</p>

<p style="margin-top: 1em"><b>-psk</b> <i>key</i></p>

<p style="margin-left:17%;">Use the PSK key <i>key</i> when
using a PSK cipher suite. The key is given as a hexadecimal
number without the leading 0x, for example -psk
1a2b3c4d.</p>

<p style="margin-top: 1em"><b>-psk_identity</b>
<i>identity</i></p>

<p style="margin-left:17%;">Use the PSK identity
<i>identity</i> when using a PSK cipher suite.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Inhibit
printing of session and certificate information. This
implicitly turns on <b>-ign_eof</b> as well.</p>

<p style="margin-top: 1em"><b>-reconnect</b></p>

<p style="margin-left:17%;">Reconnects to the same server 5
times using the same session ID; this can be used as a test
that session caching is working.</p>

<p style="margin-top: 1em"><b>-servername</b>
<i>name</i></p>

<p style="margin-left:17%;">Include the TLS Server Name
Indication (SNI) extension in the ClientHello message, using
the specified server <i>name</i>.</p>

<p style="margin-top: 1em"><b>-showcerts</b></p>

<p style="margin-left:17%;">Display the whole server
certificate chain: normally only the server certificate
itself is displayed.</p>

<p style="margin-top: 1em"><b>-starttls</b>
<i>protocol</i></p>

<p style="margin-left:17%;">Send the protocol-specific
message(s) to switch to TLS for communication.
<i>protocol</i> is a keyword for the intended protocol.
Currently, the supported keywords are &quot;ftp&quot;,
&quot;imap&quot;, &quot;smtp&quot;, &quot;pop3&quot;, and
&quot;xmpp&quot;.</p>

<p style="margin-top: 1em"><b>-state</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
SSL session states.</p>

<p style="margin-top: 1em"><b>-tls1</b> | <b>-tls1_1</b> |
<b>-tls1_2</b></p>

<p style="margin-left:17%;">Permit only TLS1.0, 1.1, or
1.2, respectively.</p>

<p style="margin-top: 1em"><b>-tlsextdebug</b></p>

<p style="margin-left:17%;">Print out a hex dump of any TLS
extensions received from the server.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">The verify <i>depth</i> to use.
This specifies the maximum length of the server certificate
chain and turns on server certificate verification.
Currently the verify operation continues after errors so all
the problems with a certificate chain can be seen. As a side
effect the connection will never fail due to a server
certificate verify failure.</p>

<p style="margin-top: 1em"><b>-xmpphost</b>
<i>hostname</i></p>

<p style="margin-left:17%;">This option, when used with
<b>-starttls</b> <i>xmpp</i>, specifies the host for the
&quot;to&quot; attribute of the stream element. If this
option is not specified then the host specified with
<b>-connect</b> will be used.</p>

<p style="margin-top: 1em"><b>S_CLIENT CONNECTED
COMMANDS</b></p>

<p style="margin-left:6%;">If a connection is established
with an SSL server, any data received from the server is
displayed and any key presses will be sent to the server.
When used interactively (which means neither <b>-quiet</b>
nor <b>-ign_eof</b> have been given), the session will be
renegotiated if the line begins with an <i>R</i>; if the
line begins with a <i>Q</i> or if end of file is reached,
the connection will be closed down.</p>

<p style="margin-top: 1em"><b>S_CLIENT NOTES</b></p>

<p style="margin-left:6%;"><b>s_client</b> can be used to
debug SSL servers. To connect to an SSL HTTP server the
command:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
s_client -connect servername:443</p>

<p style="margin-left:6%; margin-top: 1em">would typically
be used (HTTPS uses port 443). If the connection succeeds,
an HTTP command can be given such as &quot;GET&quot; to
retrieve a web page.</p>

<p style="margin-left:6%; margin-top: 1em">If the handshake
fails, there are several possible causes; if it is nothing
obvious like no client certificate, then the <b>-bugs</b>,
<b>-tls1</b>, <b>-tls1_1, -tls1_2</b>, <b>-no_tls1</b>,
<b>-no_tls1_1</b>, and <b>-no_tls1_2</b> options can be
tried in case it is a buggy server.</p>

<p style="margin-left:6%; margin-top: 1em">A frequent
problem when attempting to get client certificates working
is that a web client complains it has no certificates or
gives an empty list to choose from. This is normally because
the server is not sending the client&rsquo;s certificate
authority in its &quot;acceptable CA list&quot; when it
requests a certificate. By using <b>s_client</b> the CA list
can be viewed and checked. However some servers only request
client authentication after a specific URL is requested. To
obtain the list in this case it is necessary to use the
<b>-prexit</b> option and send an HTTP request for an
appropriate page.</p>

<p style="margin-left:6%; margin-top: 1em">If a certificate
is specified on the command line using the <b>-cert</b>
option, it will not be used unless the server specifically
requests a client certificate. Therefore merely including a
client certificate on the command line is no guarantee that
the certificate works.</p>

<p style="margin-left:6%; margin-top: 1em">If there are
problems verifying a server certificate, the
<b>-showcerts</b> option can be used to show the whole
chain.</p>

<p style="margin-left:6%; margin-top: 1em">Compression
methods are only supported for <b>-tls1</b>.</p>

<p style="margin-top: 1em"><b>S_CLIENT BUGS</b></p>

<p style="margin-left:6%;">Because this program has a lot
of options and also because some of the techniques used are
rather old, the C source of <b>s_client</b> is rather hard
to read and not a model of how things should be done. A
typical SSL client program would be much simpler.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-verify</b> option should really exit if the server
verification fails.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-prexit</b> option is a bit of a hack. We should really
report information whenever a session is renegotiated.</p>

<p style="margin-top: 1em"><b>S_SERVER</b></p>

<p style="margin-left:6%;"><b>openssl s_server</b>
[<b>-accept&nbsp;</b><i>port</i>] [<b>-bugs</b>]
[<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-cert&nbsp;</b><i>file</i>]
[<b>-cipher&nbsp;</b><i>cipherlist</i>]
[<b>-context&nbsp;</b><i>id</i>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-crlf</b>]
[<b>-dcert&nbsp;</b><i>file</i>] [<b>-debug</b>]
[<b>-dhparam&nbsp;</b><i>file</i>]
[<b>-dkey&nbsp;</b><i>file</i>] [<b>-hack</b>]
[<b>-HTTP</b>] [<b>-id_prefix&nbsp;</b><i>arg</i>]
[<b>-key&nbsp;</b><i>keyfile</i>] [<b>-msg</b>]
[<b>-nbio</b>] [<b>-nbio_test</b>] [<b>-no_dhe</b>]
[<b>-no_tls1</b>] [<b>-no_tls1_1</b>] [<b>-no_tls1_2</b>]
[<b>-no_tmp_rsa</b>] [<b>-nocert</b>]
[<b>-psk&nbsp;</b><i>key</i>]
[<b>-psk_hint&nbsp;</b><i>hint</i>] [<b>-quiet</b>]
[<b>-serverpref</b>] [<b>-state</b>] [<b>-tls1</b>]
[<b>-tls1_1</b>] [<b>-tls1_2</b>]
[<b>-Verify&nbsp;</b><i>depth</i>]
[<b>-verify&nbsp;</b><i>depth</i>] [<b>-WWW</b>]
[<b>-www</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_server</b> command implements a generic SSL/TLS server
which listens for connections on a given port using
SSL/TLS.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-accept</b> <i>port</i></p>

<p style="margin-left:17%;">The TCP <i>port</i> to listen
on for connections. If not specified, 4433 is used.</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">There are
several known bugs in SSL and TLS implementations. Adding
this option enables various workarounds.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A file containing trusted
certificates to use during client authentication and to use
when attempting to build the server certificate chain. The
list is also used in the list of acceptable client CAs
passed to the client when a certificate is requested.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The <i>directory</i> to use for
client certificate verification. This directory must be in
&quot;hash format&quot;; see <b>-verify</b> for more
information. These are also used when building the server
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use; most
server&rsquo;s cipher suites require the use of a
certificate and some require a certificate with a certain
public key type: for example the DSS cipher suites require a
certificate containing a DSS (DSA) key. If not specified,
the file <i>server.pem</i> will be used.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">This allows the cipher list
used by the server to be modified. When the client sends a
list of supported ciphers, the first client cipher also
included in the server list is used. Because the client
specifies the preference order, the order of the server
cipherlist is irrelevant. See the <i>CIPHERS</i> section for
more information.</p>

<p style="margin-top: 1em"><b>-context</b> <i>id</i></p>

<p style="margin-left:17%;">Sets the SSL context ID. It can
be given any string value. If this option is not present, a
default value will be used.</p>

<p style="margin-top: 1em"><b>-crl_check</b>,
<b>-crl_check_all</b></p>

<p style="margin-left:17%;">Check the peer certificate has
not been revoked by its CA. The CRLs are appended to the
certificate file. With the <b>-crl_check_all</b> option, all
CRLs of all CAs in the chain are checked.</p>

<p style="margin-top: 1em"><b>-crlf</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
translates a line feed from the terminal into CR+LF.</p>

<p style="margin-top: 1em"><b>-dcert</b> <i>file</i>,
<b>-dkey</b> <i>file</i></p>

<p style="margin-left:17%;">Specify an additional
certificate and private key; these behave in the same manner
as the <b>-cert</b> and <b>-key</b> options except there is
no default if they are not specified (no additional
certificate or key is used). As noted above some cipher
suites require a certificate containing a key of a certain
type. Some cipher suites need a certificate carrying an RSA
key and some a DSS (DSA) key. By using RSA and DSS
certificates and keys, a server can support clients which
only support RSA or DSS cipher suites by using an
appropriate certificate.</p>

<p style="margin-top: 1em"><b>-debug</b></p>

<p style="margin-left:17%; margin-top: 1em">Print extensive
debugging information including a hex dump of all
traffic.</p>

<p style="margin-top: 1em"><b>-dhparam</b> <i>file</i></p>

<p style="margin-left:17%;">The DH parameter file to use.
The ephemeral DH cipher suites generate keys using a set of
DH parameters. If not specified, an attempt is made to load
the parameters from the server certificate file. If this
fails, a static set of parameters hard coded into the
<b>s_server</b> program will be used.</p>

<p style="margin-top: 1em"><b>-hack</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
enables a further workaround for some early Netscape SSL
code (?).</p>

<p style="margin-top: 1em"><b>-HTTP</b></p>

<p style="margin-left:17%; margin-top: 1em">Emulates a
simple web server. Pages will be resolved relative to the
current directory; for example if the URL
<i>https://myhost/page.html</i> is requested, the file
<i>./page.html</i> will be loaded. The files loaded are
assumed to contain a complete and correct HTTP response
(lines that are part of the HTTP response line and headers
must end with CRLF).</p>

<p style="margin-top: 1em"><b>-id_prefix</b> <i>arg</i></p>

<p style="margin-left:17%;">Generate SSL/TLS session IDs
prefixed by <i>arg</i>. This is mostly useful for testing
any SSL/TLS code (e.g. proxies) that wish to deal with
multiple servers, when each of which might be generating a
unique range of session IDs (e.g. with a certain
prefix).</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used.</p>

<p style="margin-top: 1em"><b>-msg</b></p>

<p style="margin-left:17%; margin-top: 1em">Show all
protocol messages with hex dump.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turns on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-nbio_test</b></p>

<p style="margin-left:17%;">Tests non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-no_dhe</b></p>

<p style="margin-left:17%;">If this option is set, no DH
parameters will be loaded, effectively disabling the
ephemeral DH cipher suites.</p>

<p style="margin-top: 1em"><b>-no_tls1</b> |
<b>-no_tls1_1</b> | <b>-no_tls1_2</b></p>

<p style="margin-left:17%;">By default, the initial
handshake uses a method which should be compatible with
clients supporting any version of TLS. These options disable
the use of TLS1.0, 1.1, and 1.2, respectively.</p>

<p style="margin-top: 1em"><b>-no_tmp_rsa</b></p>

<p style="margin-left:17%;">Certain export cipher suites
sometimes use a temporary RSA key; this option disables
temporary RSA key generation.</p>

<p style="margin-top: 1em"><b>-nocert</b></p>

<p style="margin-left:17%;">If this option is set, no
certificate is used. This restricts the cipher suites
available to the anonymous ones (currently just anonymous
DH).</p>

<p style="margin-top: 1em"><b>-psk</b> <i>key</i></p>

<p style="margin-left:17%;">Use the PSK key <i>key</i> when
using a PSK cipher suite. The key is given as a hexadecimal
number without the leading 0x, for example -psk
1a2b3c4d.</p>

<p style="margin-top: 1em"><b>-psk_hint</b> <i>hint</i></p>

<p style="margin-left:17%;">Use the PSK identity hint
<i>hint</i> when using a PSK cipher suite.</p>

<p style="margin-top: 1em"><b>-quiet</b></p>

<p style="margin-left:17%; margin-top: 1em">Inhibit
printing of session and certificate information.</p>

<p style="margin-top: 1em"><b>-serverpref</b></p>

<p style="margin-left:17%;">Use server&rsquo;s cipher
preferences.</p>

<p style="margin-top: 1em"><b>-state</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
SSL session states.</p>

<p style="margin-top: 1em"><b>-tls1</b> | <b>-tls1_1</b> |
<b>-tls1_2</b></p>

<p style="margin-left:17%;">Permit only TLS1.0, 1.1, or
1.2, respectively.</p>

<p style="margin-top: 1em"><b>-WWW</b></p>

<p style="margin-left:17%; margin-top: 1em">Emulates a
simple web server. Pages will be resolved relative to the
current directory; for example if the URL
<i>https://myhost/page.html</i> is requested, the file
<i>./page.html</i> will be loaded.</p>

<p style="margin-top: 1em"><b>-www</b></p>

<p style="margin-left:17%; margin-top: 1em">Sends a status
message back to the client when it connects. This includes
lots of information about the ciphers used and various
session parameters. The output is in HTML format so this
option will normally be used with a web browser.</p>

<p style="margin-top: 1em"><b>-Verify</b> <i>depth</i>,
<b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">The verify <i>depth</i> to use.
This specifies the maximum length of the client certificate
chain and makes the server request a certificate from the
client. With the <b>-Verify</b> option, the client must
supply a certificate or an error occurs. With the
<b>-verify</b> option, a certificate is requested but the
client does not have to send one.</p>

<p style="margin-top: 1em"><b>S_SERVER CONNECTED
COMMANDS</b></p>

<p style="margin-left:6%;">If a connection request is
established with an SSL client and neither the <b>-www</b>
nor the <b>-WWW</b> option has been used, then normally any
data received from the client is displayed and any key
presses will be sent to the client.</p>

<p style="margin-left:6%; margin-top: 1em">Certain single
letter commands are also recognized which perform special
operations: these are listed below.</p>

<p style="margin-top: 1em"><i>P</i></p>

<p style="margin-left:14%; margin-top: 1em">Send some plain
text down the underlying TCP connection: this should cause
the client to disconnect due to a protocol violation.</p>

<p style="margin-top: 1em"><i>Q</i></p>

<p style="margin-left:14%; margin-top: 1em">End the current
SSL connection and exit.</p>

<p style="margin-top: 1em"><i>q</i></p>

<p style="margin-left:14%; margin-top: 1em">End the current
SSL connection, but still accept new connections.</p>

<p style="margin-top: 1em"><i>R</i></p>

<p style="margin-left:14%; margin-top: 1em">Renegotiate the
SSL session and request a client certificate.</p>

<p style="margin-top: 1em"><i>r</i></p>

<p style="margin-left:14%; margin-top: 1em">Renegotiate the
SSL session.</p>

<p style="margin-top: 1em"><i>S</i></p>

<p style="margin-left:14%; margin-top: 1em">Print out some
session cache status information.</p>

<p style="margin-top: 1em"><b>S_SERVER NOTES</b></p>

<p style="margin-left:6%;"><b>s_server</b> can be used to
debug SSL clients. To accept connections from a web browser
the command:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
s_server -accept 443 -www</p>

<p style="margin-left:6%; margin-top: 1em">can be used, for
example.</p>

<p style="margin-left:6%; margin-top: 1em">Most web
browsers (in particular Netscape and MSIE) only support RSA
cipher suites, so they cannot connect to servers which
don&rsquo;t use a certificate carrying an RSA key or a
version of <b>OpenSSL</b> with RSA disabled.</p>

<p style="margin-left:6%; margin-top: 1em">Although
specifying an empty list of CAs when requesting a client
certificate is strictly speaking a protocol violation, some
SSL clients interpret this to mean any CA is acceptable.
This is useful for debugging purposes.</p>

<p style="margin-left:6%; margin-top: 1em">The session
parameters can printed out using the <b>sess_id</b>
program.</p>

<p style="margin-top: 1em"><b>S_SERVER BUGS</b></p>

<p style="margin-left:6%;">Because this program has a lot
of options and also because some of the techniques used are
rather old, the C source of <b>s_server</b> is rather hard
to read and not a model of how things should be done. A
typical SSL server program would be much simpler.</p>

<p style="margin-left:6%; margin-top: 1em">The output of
common ciphers is wrong: it just gives the list of ciphers
that <b>OpenSSL</b> recognizes and the client supports.</p>

<p style="margin-left:6%; margin-top: 1em">There should be
a way for the <b>s_server</b> program to print out details
of any unknown cipher suites a client says it supports.</p>

<p style="margin-top: 1em"><b>S_TIME</b></p>

<p style="margin-left:6%;"><b>openssl s_time</b>
[<b>-bugs</b>] [<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-cert&nbsp;</b><i>file</i>]
[<b>-cipher&nbsp;</b><i>cipherlist</i>]
[<b>-connect&nbsp;</b><i>host</i>:<i>port</i>]
[<b>-key&nbsp;</b><i>keyfile</i>] [<b>-nbio</b>]
[<b>-new</b>] [<b>-no_shutdown</b>] [<b>-reuse</b>]
[<b>-time&nbsp;</b><i>seconds</i>]
[<b>-verify&nbsp;</b><i>depth</i>]
[<b>-www&nbsp;</b><i>page</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>s_client</b> command implements a generic SSL/TLS client
which connects to a remote host using SSL/TLS. It can
request a page from the server and includes the time to
transfer the payload data in its timing measurements. It
measures the number of connections within a given timeframe,
the amount of data transferred (if any), and calculates the
average time spent for one connection.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-bugs</b></p>

<p style="margin-left:17%; margin-top: 1em">There are
several known bugs in SSL and TLS implementations. Adding
this option enables various workarounds.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A file containing trusted
certificates to use during server authentication and to use
when attempting to build the client certificate chain.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">The directory to use for server
certificate verification. This directory must be in
&quot;hash format&quot;; see <b>verify</b> for more
information. These are also used when building the client
certificate chain.</p>

<p style="margin-top: 1em"><b>-cert</b> <i>file</i></p>

<p style="margin-left:17%;">The certificate to use, if one
is requested by the server. The default is not to use a
certificate. The file is in PEM format.</p>

<p style="margin-top: 1em"><b>-cipher</b>
<i>cipherlist</i></p>

<p style="margin-left:17%;">This allows the cipher list
sent by the client to be modified. Although the server
determines which cipher suite is used, it should take the
first supported cipher in the list sent by the client. See
the <b>ciphers</b> command for more information.</p>

<p style="margin-top: 1em"><b>-connect</b>
<i>host</i>:<i>port</i></p>

<p style="margin-left:17%;">This specifies the host and
optional port to connect to.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">The private key to use. If not
specified, the certificate file will be used. The file is in
PEM format.</p>

<p style="margin-top: 1em"><b>-nbio</b></p>

<p style="margin-left:17%; margin-top: 1em">Turns on
non-blocking I/O.</p>

<p style="margin-top: 1em"><b>-new</b></p>

<p style="margin-left:17%; margin-top: 1em">Performs the
timing test using a new session ID for each connection. If
neither <b>-new</b> nor <b>-reuse</b> are specified, they
are both on by default and executed in sequence.</p>

<p style="margin-top: 1em"><b>-no_shutdown</b></p>

<p style="margin-left:17%;">Shut down the connection
without sending a &ldquo;close notify&rdquo; shutdown alert
to the server.</p>

<p style="margin-top: 1em"><b>-reuse</b></p>

<p style="margin-left:17%; margin-top: 1em">Performs the
timing test using the same session ID; this can be used as a
test that session caching is working. If neither <b>-new</b>
nor <b>-reuse</b> are specified, they are both on by default
and executed in sequence.</p>

<p style="margin-top: 1em"><b>-time</b> <i>seconds</i></p>

<p style="margin-left:17%;">Specifies how long (in seconds)
<b>s_time</b> should establish connections and optionally
transfer payload data from a server. The default is 30
seconds. Server and client performance and the link speed
determine how many connections <b>s_time</b> can
establish.</p>

<p style="margin-top: 1em"><b>-verify</b> <i>depth</i></p>

<p style="margin-left:17%;">The verify depth to use. This
specifies the maximum length of the server certificate chain
and turns on server certificate verification. Currently the
verify operation continues after errors, so all the problems
with a certificate chain can be seen. As a side effect, the
connection will never fail due to a server certificate
verify failure.</p>

<p style="margin-top: 1em"><b>-www</b> <i>page</i></p>

<p style="margin-left:17%;">This specifies the page to GET
from the server. A value of &rsquo;/&rsquo; gets the
index.htm[l] page. If this parameter is not specified,
<b>s_time</b> will only perform the handshake to establish
SSL connections but not transfer any payload data.</p>

<p style="margin-top: 1em"><b>S_TIME NOTES</b></p>

<p style="margin-left:6%;"><b>s_client</b> can be used to
measure the performance of an SSL connection. To connect to
an SSL HTTP server and get the default page the command</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl
s_time -connect servername:443 -www / -CApath yourdir \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-CAfile yourfile.pem -cipher commoncipher</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">would typically
be used (HTTPS uses port 443). &ldquo;commoncipher&rdquo; is
a cipher to which both client and server can agree; see the
<b>ciphers</b> command for details.</p>

<p style="margin-left:6%; margin-top: 1em">If the handshake
fails, there are several possible causes: if it is nothing
obvious like no client certificate, the <b>-bugs</b> option
can be tried in case it is a buggy server.</p>

<p style="margin-left:6%; margin-top: 1em">A frequent
problem when attempting to get client certificates working
is that a web client complains it has no certificates or
gives an empty list to choose from. This is normally because
the server is not sending the clients certificate authority
in its &quot;acceptable CA list&quot; when it requests a
certificate. By using <b>s_client</b>, the CA list can be
viewed and checked. However some servers only request client
authentication after a specific URL is requested. To obtain
the list in this case, it is necessary to use the
<b>-prexit</b> option of <b>s_client</b> and send an HTTP
request for an appropriate page.</p>

<p style="margin-left:6%; margin-top: 1em">If a certificate
is specified on the command line using the <b>-cert</b>
option, it will not be used unless the server specifically
requests a client certificate. Therefore merely including a
client certificate on the command line is no guarantee that
the certificate works.</p>

<p style="margin-top: 1em"><b>S_TIME BUGS</b></p>

<p style="margin-left:6%;">Because this program does not
have all the options of the <b>s_client</b> program to turn
protocols on and off, you may not be able to measure the
performance of all protocols with all servers.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-verify</b> option should really exit if the server
verification fails.</p>

<p style="margin-top: 1em"><b>SESS_ID</b></p>

<p style="margin-left:6%;"><b>openssl sess_id</b>
[<b>-cert</b>] [<b>-context&nbsp;</b><i>ID</i>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-noout</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>sess_id</b> program processes the encoded version of the
SSL session structure and optionally prints out SSL session
details (for example the SSL session master key) in human
readable format. Since this is a diagnostic tool that needs
some knowledge of the SSL protocol to use properly, most
users will not need to use it.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-cert</b></p>

<p style="margin-left:17%; margin-top: 1em">If a
certificate is present in the session, it will be output
using this option; if the <b>-text</b> option is also
present, then it will be printed out in text form.</p>

<p style="margin-top: 1em"><b>-context</b> <i>ID</i></p>

<p style="margin-left:17%;">This option can set the session
ID so the output session information uses the supplied
<i>ID</i>. The <i>ID</i> can be any string of characters.
This option won&rsquo;t normally be used.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read session information from, or standard
input by default.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the input
format. The <i>DER</i> argument uses an ASN1 DER-encoded
format containing session details. The precise format can
vary from one version to the next. The <i>PEM</i> form is
the default format: it consists of the DER format
base64-encoded with additional header and footer lines.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">This option
prevents output of the encoded version of the session.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the output
<i>file</i> to write session information to, or standard
output if this option is not specified.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:17%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out the
various public or private key components in plain text in
addition to the encoded version.</p>

<p style="margin-top: 1em"><b>SESS_ID OUTPUT</b></p>

<p style="margin-left:6%;">Typical output:</p>

<p style="margin-left:6%; margin-top: 1em">SSL-Session:
<br>
Protocol : TLSv1 <br>
Cipher : 0016 <br>
Session-ID:
871E62626C554CE95488823752CBD5F3673A3EF3DCE9C67BD916C809914B40ED
<br>
Session-ID-ctx: 01000000 <br>
Master-Key:
A7CEFC571974BE02CAC305269DC59F76EA9F0B180CB6642697A68251F2D2BB57E51DBBB4C7885573192AE9AEE220FACD
<br>
Key-Arg : None <br>
Start Time: 948459261 <br>
Timeout : 300 (sec) <br>
Verify return code 0 (ok)</p>

<p style="margin-left:6%; margin-top: 1em">These are
described below in more detail.</p>

<p style="margin-top: 1em"><i>Protocol</i></p>

<p style="margin-left:33%; margin-top: 1em">This is the
protocol in use.</p>

<p><i>Cipher</i></p>

<p style="margin-left:33%; margin-top: 1em">The cipher used
is the actual raw SSL or TLS cipher code; see the SSL or TLS
specifications for more information.</p>

<p><i>Session-ID</i></p>

<p style="margin-left:33%; margin-top: 1em">The SSL session
ID in hex format.</p>

<p><i>Session-ID-ctx</i></p>

<p style="margin-left:33%; margin-top: 1em">The session ID
context in hex format.</p>

<p><i>Master-Key</i></p>

<p style="margin-left:33%; margin-top: 1em">This is the SSL
session master key.</p>

<p><i>Key-Arg</i></p>

<p style="margin-left:33%; margin-top: 1em">The key
argument; this is only used in SSL v2.</p>

<p><i>Start Time</i></p>

<p style="margin-left:33%; margin-top: 1em">This is the
session start time, represented as an integer in standard
UNIX format.</p>

<p><i>Timeout</i></p>

<p style="margin-left:33%; margin-top: 1em">The timeout in
seconds.</p>

<p><i>Verify return code</i></p>

<p style="margin-left:33%; margin-top: 1em">This is the
return code when an SSL client certificate is verified.</p>

<p style="margin-top: 1em"><b>SESS_ID NOTES</b></p>

<p style="margin-left:6%;">The PEM-encoded session format
uses the header and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN SSL
SESSION PARAMETERS----- <br>
-----END SSL SESSION PARAMETERS-----</p>

<p style="margin-left:6%; margin-top: 1em">Since the SSL
session output contains the master key, it is possible to
read the contents of an encrypted session using this
information. Therefore appropriate security precautions
should be taken if the information is being output by a
&quot;real&quot; application. This is, however, strongly
discouraged and should only be used for debugging
purposes.</p>

<p style="margin-top: 1em"><b>SESS_ID BUGS</b></p>

<p style="margin-left:6%;">The cipher and start time should
be printed out in human readable form.</p>

<p style="margin-top: 1em"><b>SMIME</b></p>

<p style="margin-left:6%;"><b>openssl smime</b> [</p>


<p><b>-aes128&nbsp;</b>|&nbsp;<b>-aes192&nbsp;</b>|&nbsp;<b>-aes256&nbsp;</b>|&nbsp;<b>-des&nbsp;</b>|
<b>-des3&nbsp;</b>|&nbsp;<b>-rc2-40&nbsp;</b>|&nbsp;<b>-rc2-64&nbsp;</b>|&nbsp;<b>-rc2-128</b>
] [<b>-binary</b>] [<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-certfile&nbsp;</b><i>file</i>] [<b>-check_ss_sig</b>]
[<b>-content&nbsp;</b><i>file</i>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-decrypt</b>] [<b>-encrypt</b>]
[<b>-extended_crl</b>] [<b>-from&nbsp;</b><i>addr</i>]
[<b>-ignore_critical</b>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-indef</b>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM&nbsp;</i>|&nbsp;<i>SMIME</i>]
[<b>-inkey&nbsp;</b><i>file</i>] [<b>-issuer_checks</b>]
[<b>-keyform&nbsp;</b><i>PEM</i>]
[<b>-md&nbsp;</b><i>digest</i>] [<b>-noattr</b>]
[<b>-nocerts</b>] [<b>-nochain</b>] [<b>-nodetach</b>]
[<b>-noindef</b>] [<b>-nointern</b>] [<b>-nosigs</b>]
[<b>-noverify</b>] [<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM&nbsp;</i>|&nbsp;<i>SMIME</i>]
[<b>-passin&nbsp;</b><i>arg</i>] [<b>-pk7out</b>]
[<b>-policy_check</b>] [<b>-recip&nbsp;</b><i>file</i>]
[<b>-resign</b>] [<b>-sign</b>]
[<b>-signer&nbsp;</b><i>file</i>] [<b>-stream</b>]
[<b>-subject&nbsp;</b><i>s</i>] [<b>-text</b>]
[<b>-to&nbsp;</b><i>addr</i>] [<b>-verify</b>]
[<b>-x509_strict</b>] [<i>cert.pem&nbsp;...</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>smime</b>
command handles <i>S/MIME</i> mail. It can encrypt, decrypt,
sign, and verify <i>S/MIME</i> messages.</p>

<p style="margin-left:6%; margin-top: 1em">There are six
operation options that set the type of operation to be
performed. The meaning of the other options varies according
to the operation type.</p>

<p style="margin-left:6%; margin-top: 1em">The six
operation options are as follows:</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:14%;">Decrypt mail using the supplied
certificate and private key. Expects an encrypted mail
message in <i>MIME</i> format for the input file. The
decrypted mail is written to the output file.</p>

<p style="margin-top: 1em"><b>-encrypt</b></p>

<p style="margin-left:14%;">Encrypt mail for the given
recipient certificates. Input file is the message to be
encrypted. The output file is the encrypted mail in
<i>MIME</i> format.</p>

<p style="margin-top: 1em"><b>-pk7out</b></p>

<p style="margin-left:14%;">Takes an input message and
writes out a PEM-encoded PKCS#7 structure.</p>

<p style="margin-top: 1em"><b>-resign</b></p>

<p style="margin-left:14%;">Resign a message: take an
existing message and one or more new signers.</p>

<p style="margin-top: 1em"><b>-sign</b></p>

<p style="margin-left:14%;">Sign mail using the supplied
certificate and private key. Input file is the message to be
signed. The signed message in <i>MIME</i> format is written
to the output file.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:14%;">Verify signed mail. Expects a
signed mail message on input and outputs the signed data.
Both clear text and opaque signing is supported.</p>

<p style="margin-left:6%; margin-top: 1em">The remaining
options are as follows:</p>

<p style="margin-top: 1em"><b>-aes128</b> | <b>-aes192</b>
| <b>-aes256</b> | <b>-des</b> | <b>-des3</b> |
<b>-rc2-40</b> | <b>-rc2-64</b> | <b>-rc2-128</b></p>

<p style="margin-left:14%;">The encryption algorithm to
use. 128-, 192-, or 256-bit AES, DES (56 bits), triple DES
(168 bits), or 40-, 64-, or 128-bit RC2, respectively; if
not specified, 40-bit RC2 is used. Only used with
<b>-encrypt</b>.</p>

<p style="margin-top: 1em"><b>-binary</b></p>

<p style="margin-left:14%;">Normally, the input message is
converted to &quot;canonical&quot; format which is
effectively using CR and LF as end of line - as required by
the <i>S/MIME</i> specification. When this option is present
no translation occurs. This is useful when handling binary
data which may not be in <i>MIME</i> format.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:14%;">A <i>file</i> containing
trusted CA certificates; only used with <b>-verify</b>.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:14%;">A <i>directory</i> containing
trusted CA certificates; only used with <b>-verify</b>. This
directory must be a standard certificate directory: that is,
a hash of each subject name (using <b>x509 -hash</b>) should
be linked to each certificate.</p>

<p style="margin-top: 1em"><i>cert.pem ...</i></p>

<p style="margin-left:14%;">One or more certificates of
message recipients: used when encrypting a message.</p>

<p style="margin-top: 1em"><b>-certfile</b> <i>file</i></p>

<p style="margin-left:14%;">Allows additional certificates
to be specified. When signing, these will be included with
the message. When verifying, these will be searched for the
signers&rsquo; certificates. The certificates should be in
PEM format.</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b>,
<b>-crl_check</b>, <b>-crl_check_all</b>,
<b>-extended_crl</b>, <b>-ignore_critical</b>,
<b>-issuer_checks</b>, <b>-policy_check</b>,
<b>-x509_strict</b></p>

<p style="margin-left:14%;">Set various certificate chain
validation options. See the <b>VERIFY</b> command for
details.</p>

<p style="margin-top: 1em"><b>-content</b> <i>file</i></p>

<p style="margin-left:14%;">This specifies a file
containing the detached content. This is only useful with
the <b>-verify</b> command. This is only usable if the
PKCS#7 structure is using the detached signature form where
the content is not included. This option will override any
content if the input format is <i>S/MIME</i> and it uses the
multipart/signed <i>MIME</i> content type.</p>

<p style="margin-top: 1em"><b>-from</b> <i>addr</i>,
<b>-subject</b> <i>s</i>, <b>-to</b> <i>addr</i></p>

<p style="margin-left:14%;">The relevant mail headers.
These are included outside the signed portion of a message
so they may be included manually. When signing, many
<i>S/MIME</i> mail clients check that the signer&rsquo;s
certificate email address matches the From: address.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:14%;">The input message to be
encrypted or signed or the <i>MIME</i> message to be
decrypted or verified.</p>

<p style="margin-top: 1em"><b>-indef</b></p>

<p style="margin-left:14%;">Enable streaming I/O for
encoding operations. This permits single pass processing of
data without the need to hold the entire contents in memory,
potentially supporting very large files. Streaming is
automatically set for S/MIME signing with detached data if
the output format is SMIME; it is currently off by default
for all other operations.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>PEM</i> | <i>SMIME</i></p>

<p style="margin-left:14%;">This specifies the input format
for the PKCS#7 structure. The default is <i>SMIME</i>, which
reads an <i>S/MIME</i> format message. <i>PEM</i> and
<i>DER</i> format change this to expect PEM and DER format
PKCS#7 structures instead. This currently only affects the
input format of the PKCS#7 structure; if no PKCS#7 structure
is being input (for example with <b>-encrypt</b> or
<b>-sign</b>), this option has no effect.</p>

<p style="margin-top: 1em"><b>-inkey</b> <i>file</i></p>

<p style="margin-left:14%;">The private key to use when
signing or decrypting. This must match the corresponding
certificate. If this option is not specified, the private
key must be included in the certificate file specified with
the <b>-recip</b> or <b>-signer</b> file. When signing, this
option can be used multiple times to specify successive
keys.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>PEM</i></p>

<p style="margin-left:14%;">Input private key format.</p>

<p style="margin-top: 1em"><b>-md</b> <i>digest</i></p>

<p style="margin-left:14%;">The digest algorithm to use
when signing or resigning. If not present then the default
digest algorithm for the signing key is used (usually
SHA1).</p>

<p style="margin-top: 1em"><b>-noattr</b></p>

<p style="margin-left:14%;">Normally, when a message is
signed a set of attributes are included which include the
signing time and supported symmetric algorithms. With this
option they are not included.</p>

<p style="margin-top: 1em"><b>-nocerts</b></p>

<p style="margin-left:14%;">When signing a message, the
signer&rsquo;s certificate is normally included; with this
option it is excluded. This will reduce the size of the
signed message but the verifier must have a copy of the
signer&rsquo;s certificate available locally (passed using
the <b>-certfile</b> option, for example).</p>

<p style="margin-top: 1em"><b>-nochain</b></p>

<p style="margin-left:14%;">Do not do chain verification of
signers&rsquo; certificates: that is, don&rsquo;t use the
certificates in the signed message as untrusted CAs.</p>

<p style="margin-top: 1em"><b>-nodetach</b></p>

<p style="margin-left:14%;">When signing a message use
opaque signing: this form is more resistant to translation
by mail relays but it cannot be read by mail agents that do
not support <i>S/MIME</i>. Without this option cleartext
signing with the <i>MIME</i> type multipart/signed is
used.</p>

<p style="margin-top: 1em"><b>-noindef</b></p>

<p style="margin-left:14%;">Disable streaming I/O where it
would produce an encoding of indefinite length. This option
currently has no effect. In future streaming will be enabled
by default on all relevant operations and this option will
disable it.</p>

<p style="margin-top: 1em"><b>-nointern</b></p>

<p style="margin-left:14%;">When verifying a message,
normally certificates (if any) included in the message are
searched for the signing certificate. With this option, only
the certificates specified in the <b>-certfile</b> option
are used. The supplied certificates can still be used as
untrusted CAs however.</p>

<p style="margin-top: 1em"><b>-nosigs</b></p>

<p style="margin-left:14%;">Don&rsquo;t try to verify the
signatures on the message.</p>

<p style="margin-top: 1em"><b>-noverify</b></p>

<p style="margin-left:14%;">Do not verify the
signer&rsquo;s certificate of a signed message.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">The message text that has been
decrypted or verified, or the output <i>MIME</i> format
message that has been signed or verified.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>PEM</i> | <i>SMIME</i></p>

<p style="margin-left:14%;">This specifies the output
format for the PKCS#7 structure. The default is
<i>SMIME</i>, which writes an <i>S/MIME</i> format message.
<i>PEM</i> and <i>DER</i> format change this to write PEM
and DER format PKCS#7 structures instead. This currently
only affects the output format of the PKCS#7 structure; if
no PKCS#7 structure is being output (for example with
<b>-verify</b> or <b>-decrypt</b>) this option has no
effect.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>-recip</b> <i>file</i></p>

<p style="margin-left:14%;">The recipients certificate when
decrypting a message. This certificate must match one of the
recipients of the message or an error occurs.</p>

<p style="margin-top: 1em"><b>-signer</b> <i>file</i></p>

<p style="margin-left:14%;">A signing certificate when
signing or resigning a message; this option can be used
multiple times if more than one signer is required. If a
message is being verified, the signer&rsquo;s certificates
will be written to this file if the verification was
successful.</p>

<p style="margin-top: 1em"><b>-stream</b></p>

<p style="margin-left:14%;">The same as <b>-indef</b>.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:14%;">This option adds plain text
(text/plain) <i>MIME</i> headers to the supplied message if
encrypting or signing. If decrypting or verifying, it strips
off text headers: if the decrypted or verified message is
not of <i>MIME</i> type text/plain then an error occurs.</p>

<p style="margin-top: 1em"><b>SMIME NOTES</b></p>

<p style="margin-left:6%;">The <i>MIME</i> message must be
sent without any blank lines between the headers and the
output. Some mail programs will automatically add a blank
line. Piping the mail directly to an MTA is one way to
achieve the correct format.</p>

<p style="margin-left:6%; margin-top: 1em">The supplied
message to be signed or encrypted must include the necessary
<i>MIME</i> headers or many <i>S/MIME</i> clients
won&rsquo;t display it properly (if at all). You can use the
<b>-text</b> option to automatically add plain text
headers.</p>

<p style="margin-left:6%; margin-top: 1em">A &quot;signed
and encrypted&quot; message is one where a signed message is
then encrypted. This can be produced by encrypting an
already signed message: see the <i>SMIME EXAMPLES</i>
section.</p>

<p style="margin-left:6%; margin-top: 1em">This version of
the program only allows one signer per message, but it will
verify multiple signers on received messages. Some
<i>S/MIME</i> clients choke if a message contains multiple
signers. It is possible to sign messages &quot;in
parallel&quot; by signing an already signed message.</p>

<p style="margin-left:6%; margin-top: 1em">The options
<b>-encrypt</b> and <b>-decrypt</b> reflect common usage in
<i>S/MIME</i> clients. Strictly speaking these process
PKCS#7 enveloped data: PKCS#7 encrypted data is used for
other purposes.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-resign</b> option uses an existing message digest when
adding a new signer. This means that attributes must be
present in at least one existing signer using the same
message digest or this operation will fail.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-stream</b> and <b>-indef</b> options enable experimental
streaming I/O support. As a result the encoding is BER using
indefinite length constructed encoding and no longer DER.
Streaming is supported for the <b>-encrypt</b> and
<b>-sign</b> operations if the content is not detached.</p>

<p style="margin-left:6%; margin-top: 1em">Streaming is
always used for the <b>-sign</b> operation with detached
data but since the content is no longer part of the PKCS#7
structure the encoding remains DER.</p>

<p style="margin-top: 1em"><b>SMIME EXIT CODES</b> <i><br>
0</i></p>

<p style="margin-left:14%; margin-top: 1em">The operation
was completely successful.</p>

<p style="margin-top: 1em"><i>1</i></p>

<p style="margin-left:14%; margin-top: 1em">An error
occurred parsing the command options.</p>

<p style="margin-top: 1em"><i>2</i></p>

<p style="margin-left:14%; margin-top: 1em">One of the
input files could not be read.</p>

<p style="margin-top: 1em"><i>3</i></p>

<p style="margin-left:14%; margin-top: 1em">An error
occurred creating the PKCS#7 file or when reading the
<i>MIME</i> message.</p>

<p style="margin-top: 1em"><i>4</i></p>

<p style="margin-left:14%; margin-top: 1em">An error
occurred decrypting or verifying the message.</p>

<p style="margin-top: 1em"><i>5</i></p>

<p style="margin-left:14%; margin-top: 1em">The message was
verified correctly, but an error occurred writing out the
signer&rsquo;s certificates.</p>

<p style="margin-top: 1em"><b>SMIME EXAMPLES</b></p>

<p style="margin-left:6%;">Create a cleartext signed
message:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-sign -in message.txt -text -out mail.msg \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-signer mycert.pem</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Create an opaque
signed message:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-sign -in message.txt -text -out mail.msg \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-nodetach -signer mycert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Create a signed
message, include some additional certificates and read the
private key from another file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-sign -in in.txt -text -out mail.msg \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-signer mycert.pem -inkey mykey.pem -certfile
mycerts.pem</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Create a signed
message with two signers:</p>

<p style="margin-left:14%; margin-top: 1em">openssl smime
-sign -in message.txt -text -out mail.msg \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-signer mycert.pem -signer othercert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Send a signed
message under UNIX directly to sendmail(8), including
headers:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-sign -in in.txt -text -signer mycert.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-from steve@openssl.org -to someone@somewhere \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-subject &quot;Signed message&quot; | sendmail
someone@somewhere</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Verify a message
and extract the signer&rsquo;s certificate if
successful:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-verify -in mail.msg -signer user.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out signedtext.txt</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Send encrypted
mail using triple DES:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-encrypt -in in.txt -from steve@openssl.org \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-to someone@somewhere -subject &quot;Encrypted
message&quot; \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-des3 -out mail.msg user.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Sign and encrypt
mail:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-sign -in ml.txt -signer my.pem -text | \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>openssl smime -encrypt -out mail.msg \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-from steve@openssl.org -to someone@somewhere \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-subject &quot;Signed and Encrypted message&quot; -des3
user.pem</p> </td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em"><b>Note</b>: The
encryption command does not include the <b>-text</b> option
because the message being encrypted already has <i>MIME</i>
headers.</p>

<p style="margin-left:6%; margin-top: 1em">Decrypt
mail:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-decrypt -in mail.msg -recip mycert.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-inkey key.pem&quot;</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">The output from
Netscape form signing is a PKCS#7 structure with the
detached signature format. You can use this program to
verify the signature by line wrapping the base64-encoded
structure and surrounding it with:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
PKCS7----- <br>
-----END PKCS7-----</p>

<p style="margin-left:6%; margin-top: 1em">and using the
command:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-verify -inform PEM -in signature.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-content content.txt</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Alternatively,
you can base64 decode the signature and use:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl smime
-verify -inform DER -in signature.der \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-content content.txt</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Create an
encrypted message using 128-bit AES:</p>

<p style="margin-left:14%; margin-top: 1em">openssl smime
-encrypt -in plain.txt -aes128 \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out mail.msg cert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Add a signer to
an existing message:</p>

<p style="margin-left:14%; margin-top: 1em">openssl smime
-resign -in mail.msg -signer newsign.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out mail2.msg</p></td></tr>
</table>

<p style="margin-top: 1em"><b>SMIME BUGS</b></p>

<p style="margin-left:6%;">The <i>MIME</i> parser
isn&rsquo;t very clever: it seems to handle most messages
that I&rsquo;ve thrown at it, but it may choke on
others.</p>

<p style="margin-left:6%; margin-top: 1em">The code
currently will only write out the signer&rsquo;s certificate
to a file: if the signer has a separate encryption
certificate this must be manually extracted. There should be
some heuristic that determines the correct encryption
certificate.</p>

<p style="margin-left:6%; margin-top: 1em">Ideally, a
database should be maintained of a certificate for each
email address.</p>

<p style="margin-left:6%; margin-top: 1em">The code
doesn&rsquo;t currently take note of the permitted symmetric
encryption algorithms as supplied in the
<i>SMIMECapabilities</i> signed attribute. This means the
user has to manually include the correct encryption
algorithm. It should store the list of permitted ciphers in
a database and only use those.</p>

<p style="margin-left:6%; margin-top: 1em">No revocation
checking is done on the signer&rsquo;s certificate.</p>

<p style="margin-left:6%; margin-top: 1em">The current code
can only handle <i>S/MIME</i> v2 messages; the more complex
<i>S/MIME</i> v3 structures may cause parsing errors.</p>

<p style="margin-top: 1em"><b>SMIME HISTORY</b></p>

<p style="margin-left:6%;">The use of multiple
<b>-signer</b> options and the <b>-resign</b> command were
first added in <b>OpenSSL</b> 1.0.0.</p>

<p style="margin-top: 1em"><b>SPEED</b></p>

<p style="margin-left:6%;"><b>openssl speed</b>
[<b>aes</b>] [<b>aes-128-cbc</b>] [<b>aes-192-cbc</b>]
[<b>aes-256-cbc</b>] [<b>aes-128-gcm</b>]
[<b>aes-256-gcm</b>] [<b>blowfish</b>] [<b>bf-cbc</b>]
[<b>cast</b>] [<b>cast-cbc</b>] [<b>chacha20-poly1305</b>]
[<b>des</b>] [<b>des-cbc</b>] [<b>des-ede3</b>] [<b>dsa</b>]
[<b>dsa512</b>] [<b>dsa1024</b>] [<b>dsa2048</b>]
[<b>hmac</b>] [<b>md4</b>] [<b>md5</b>] [<b>rc2</b>]
[<b>rc2-cbc</b>] [<b>rc4</b>] [<b>rmd160</b>] [<b>rsa</b>]
[<b>rsa512</b>] [<b>rsa1024</b>] [<b>rsa2048</b>]
[<b>rsa4096</b>] [<b>sha1</b>] [<b>-decrypt</b>]
[<b>-elapsed</b>] [<b>-evp&nbsp;</b><i>e</i>] [<b>-mr</b>]
[<b>-multi&nbsp;</b><i>number</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>speed</b>
command is used to test the performance of cryptographic
algorithms.</p>

<p style="margin-top: 1em">[<b>zero or more test
algorithms</b>]</p>

<p style="margin-left:14%;">If any options are given,
<b>speed</b> tests those algorithms, otherwise all of the
above are tested.</p>

<p style="margin-top: 1em"><b>-decrypt</b></p>

<p style="margin-left:14%;">Time decryption instead of
encryption (only EVP).</p>

<p style="margin-top: 1em"><b>-elapsed</b></p>

<p style="margin-left:14%;">Measure time in real time
instead of CPU user time.</p>

<p style="margin-top: 1em"><b>-evp</b> <i>e</i></p>

<p style="margin-left:14%;">Use EVP <i>e</i>.</p>

<p style="margin-top: 1em"><b>-mr</b></p>

<p style="margin-left:14%; margin-top: 1em">Produce machine
readable output.</p>

<p style="margin-top: 1em"><b>-multi</b> <i>number</i></p>

<p style="margin-left:14%;">Run <i>number</i> benchmarks in
parallel.</p>

<p style="margin-top: 1em"><b>TS</b></p>

<p style="margin-left:6%;"><b>openssl ts -query</b>
[<b>-md4&nbsp;</b>|&nbsp;<b>-md5&nbsp;</b>|&nbsp;<b>-ripemd160&nbsp;</b>|&nbsp;<b>-sha1</b>]
[<b>-cert</b>] [<b>-config&nbsp;</b><i>configfile</i>]
[<b>-data&nbsp;</b><i>file_to_hash</i>]
[<b>-digest&nbsp;</b><i>digest_bytes</i>]
[<b>-in&nbsp;</b><i>request.tsq</i>] [<b>-no_nonce</b>]
[<b>-out&nbsp;</b><i>request.tsq</i>]
[<b>-policy&nbsp;</b><i>object_id</i>] [<b>-text</b>]</p>

<p style="margin-left:6%; margin-top: 1em"><b>openssl ts
-reply</b> [<b>-chain&nbsp;</b><i>certs_file.pem</i>]
[<b>-config&nbsp;</b><i>configfile</i>]
[<b>-in&nbsp;</b><i>response.tsr</i>]
[<b>-inkey&nbsp;</b><i>private.pem</i>]
[<b>-out&nbsp;</b><i>response.tsr</i>]
[<b>-passin&nbsp;</b><i>arg</i>]
[<b>-policy&nbsp;</b><i>object_id</i>]
[<b>-queryfile&nbsp;</b><i>request.tsq</i>]
[<b>-section&nbsp;</b><i>tsa_section</i>]
[<b>-signer&nbsp;</b><i>tsa_cert.pem</i>] [<b>-text</b>]
[<b>-token_in</b>] [<b>-token_out</b>]</p>

<p style="margin-left:6%; margin-top: 1em"><b>openssl ts
-verify</b> [<b>-CAfile&nbsp;</b><i>trusted_certs.pem</i>]
[<b>-CApath&nbsp;</b><i>trusted_cert_path</i>]
[<b>-data&nbsp;</b><i>file_to_hash</i>]
[<b>-digest&nbsp;</b><i>digest_bytes</i>]
[<b>-in&nbsp;</b><i>response.tsr</i>]
[<b>-queryfile&nbsp;</b><i>request.tsq</i>]
[<b>-token_in</b>]
[<b>-untrusted&nbsp;</b><i>cert_file.pem</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>ts</b>
command is a basic Time Stamping Authority (TSA) client and
server application as specified in RFC 3161 (Time-Stamp
Protocol, TSP). A TSA can be part of a PKI deployment and
its role is to provide long term proof of the existence of a
certain datum before a particular time. Here is a brief
description of the protocol:</p>

<p style="margin-top: 1em">1.</p>

<p style="margin-left:13%;">The TSA client computes a
one-way hash value for a data file and sends the hash to the
TSA.</p>

<p style="margin-top: 1em">2.</p>

<p style="margin-left:13%;">The TSA attaches the current
date and time to the received hash value, signs them and
sends the time stamp token back to the client. By creating
this token the TSA certifies the existence of the original
data file at the time of response generation.</p>

<p style="margin-top: 1em">3.</p>

<p style="margin-left:13%;">The TSA client receives the
time stamp token and verifies the signature on it. It also
checks if the token contains the same hash value that it had
sent to the TSA.</p>

<p style="margin-left:6%; margin-top: 1em">There is one
DER-encoded protocol data unit defined for transporting a
time stamp request to the TSA and one for sending the time
stamp response back to the client. The <b>ts</b> command has
three main functions: creating a time stamp request based on
a data file; creating a time stamp response based on a
request; and verifying if a response corresponds to a
particular request or a data file.</p>

<p style="margin-left:6%; margin-top: 1em">There is no
support for sending the requests/responses automatically
over HTTP or TCP yet as suggested in RFC 3161. Users must
send the requests either by FTP or email.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-query</b> switch can be used for creating and printing a
time stamp request with the following options:</p>

<p style="margin-top: 1em"><b>-cert</b></p>

<p style="margin-left:17%; margin-top: 1em">The TSA is
expected to include its signing certificate in the
response.</p>

<p style="margin-top: 1em"><b>-config</b>
<i>configfile</i></p>

<p style="margin-left:17%;">The configuration file to use.
This option overrides the OPENSSL_CONF environment variable.
Only the OID section of the config file is used with the
<b>-query</b> command.</p>

<p style="margin-top: 1em"><b>-data</b>
<i>file_to_hash</i></p>

<p style="margin-left:17%;">The data file for which the
time stamp request needs to be created. stdin is the default
if neither the <b>-data</b> nor the <b>-digest</b> option is
specified.</p>

<p style="margin-top: 1em"><b>-digest</b>
<i>digest_bytes</i></p>

<p style="margin-left:17%;">It is possible to specify the
message imprint explicitly without the data file. The
imprint must be specified in a hexadecimal format, two
characters per byte, the bytes optionally separated by
colons (e.g. 1A:F6:01:... or 1AF601...). The number of bytes
must match the message digest algorithm in use.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">This option specifies a
previously created time stamp request in DER format that
will be printed into the output file. Useful when you need
to examine the content of a request in human-readable
format.</p>


<p style="margin-top: 1em"><b>-md4|md5|ripemd160|sha|sha1</b></p>

<p style="margin-left:17%;">The message digest to apply to
the data file. It supports all the message digest algorithms
that are supported by the <b>dgst</b> command. The default
is SHA-1.</p>

<p style="margin-top: 1em"><b>-no_nonce</b></p>

<p style="margin-left:17%;">No nonce is specified in the
request if this option is given. Otherwise a 64-bit long
pseudo-random none is included in the request. It is
recommended to use nonce to protect against
replay-attacks.</p>

<p style="margin-top: 1em"><b>-out</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">Name of the output file to
which the request will be written. The default is
stdout.</p>

<p style="margin-top: 1em"><b>-policy</b>
<i>object_id</i></p>

<p style="margin-left:17%;">The policy that the client
expects the TSA to use for creating the time stamp token.
Either the dotted OID notation or OID names defined in the
config file can be used. If no policy is requested the TSA
will use its own default policy.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">If this option
is specified the output is in human-readable text format
instead of DER.</p>

<p style="margin-left:6%; margin-top: 1em">A time stamp
response (TimeStampResp) consists of a response status and
the time stamp token itself (ContentInfo), if the token
generation was successful. The <b>-reply</b> command is for
creating a time stamp response or time stamp token based on
a request and printing the response/token in human-readable
format. If <b>-token_out</b> is not specified the output is
always a time stamp response (TimeStampResp), otherwise it
is a time stamp token (ContentInfo).</p>

<p style="margin-top: 1em"><b>-chain</b>
<i>certs_file.pem</i></p>

<p style="margin-left:17%;">The collection of certificates,
in PEM format, that will be included in the response in
addition to the signer certificate if the <b>-cert</b>
option was used for the request. This file is supposed to
contain the certificate chain for the signer certificate
from its issuer upwards. The <b>-reply</b> command does not
build a certificate chain automatically.</p>

<p style="margin-top: 1em"><b>-config</b>
<i>configfile</i></p>

<p style="margin-left:17%;">The configuration file to use.
This option overrides the OPENSSL_CONF environment variable.
See <i>TS CONFIGURATION FILE OPTIONS</i> for configurable
variables.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">Specifies a previously created
time stamp response or time stamp token, if <b>-token_in</b>
is also specified, in DER format that will be written to the
output file. This option does not require a request; it is
useful, for example, when you need to examine the content of
a response or token or you want to extract the time stamp
token from a response. If the input is a token and the
output is a time stamp response a default
&ldquo;granted&rdquo; status info is added to the token.</p>

<p style="margin-top: 1em"><b>-inkey</b>
<i>private.pem</i></p>

<p style="margin-left:17%;">The signer private key of the
TSA in PEM format. Overrides the <b>signer_key</b> config
file option.</p>

<p style="margin-top: 1em"><b>-out</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">The response is written to this
file. The format and content of the file depends on other
options (see <b>-text</b> and <b>-token_out</b>). The
default is stdout.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-policy</b>
<i>object_id</i></p>

<p style="margin-left:17%;">The default policy to use for
the response unless the client explicitly requires a
particular TSA policy. The OID can be specified either in
dotted notation or with its name. Overrides the
<b>default_policy</b> config file option.</p>

<p style="margin-top: 1em"><b>-queryfile</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">The name of the file containing
a DER-encoded time stamp request.</p>

<p style="margin-top: 1em"><b>-section</b>
<i>tsa_section</i></p>

<p style="margin-left:17%;">The name of the config file
section containing the settings for the response generation.
If not specified the default TSA section is used; see <i>TS
CONFIGURATION FILE OPTIONS</i> for details.</p>

<p style="margin-top: 1em"><b>-signer</b>
<i>tsa_cert.pem</i></p>

<p style="margin-left:17%;">The signer certificate of the
TSA in PEM format. The TSA signing certificate must have
exactly one extended key usage assigned to it: timeStamping.
The extended key usage must also be critical, otherwise the
certificate is going to be refused. Overrides the
<b>signer_cert</b> variable of the config file.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:17%; margin-top: 1em">If this option
is specified the output is human-readable text format
instead of DER.</p>

<p style="margin-top: 1em"><b>-token_in</b></p>

<p style="margin-left:17%;">This flag can be used together
with the <b>-in</b> option and indicates that the input is a
DER-encoded time stamp token (ContentInfo) instead of a time
stamp response (TimeStampResp).</p>

<p style="margin-top: 1em"><b>-token_out</b></p>

<p style="margin-left:17%;">The output is a time stamp
token (ContentInfo) instead of time stamp response
(TimeStampResp).</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-verify</b> command is for verifying if a time stamp
response or time stamp token is valid and matches a
particular time stamp request or data file. The
<b>-verify</b> command does not use the configuration
file.</p>

<p style="margin-top: 1em"><b>-CAfile</b>
<i>trusted_certs.pem</i></p>

<p style="margin-left:17%;">The name of the file containing
a set of trusted self-signed CA certificates in PEM format.
See the similar option of <b>verify</b> for additional
details. Either this option or <b>-CApath</b> must be
specified.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>trusted_cert_path</i></p>

<p style="margin-left:17%;">The name of the directory
containing the trused CA certificates of the client. See the
similar option of <b>verify</b> for additional details.
Either this option or <b>-CAfile</b> must be specified.</p>

<p style="margin-top: 1em"><b>-data</b>
<i>file_to_hash</i></p>

<p style="margin-left:17%;">The response or token must be
verified against <i>file_to_hash</i>. The file is hashed
with the message digest algorithm specified in the token.
The <b>-digest</b> and <b>-queryfile</b> options must not be
specified with this one.</p>

<p style="margin-top: 1em"><b>-digest</b>
<i>digest_bytes</i></p>

<p style="margin-left:17%;">The response or token must be
verified against the message digest specified with this
option. The number of bytes must match the message digest
algorithm specified in the token. The <b>-data</b> and
<b>-queryfile</b> options must not be specified with this
one.</p>

<p style="margin-top: 1em"><b>-in</b>
<i>response.tsr</i></p>

<p style="margin-left:17%;">The time stamp response that
needs to be verified, in DER format. This option in
mandatory.</p>

<p style="margin-top: 1em"><b>-queryfile</b>
<i>request.tsq</i></p>

<p style="margin-left:17%;">The original time stamp
request, in DER format. The <b>-data</b> and <b>-digest</b>
options must not be specified with this one.</p>

<p style="margin-top: 1em"><b>-token_in</b></p>

<p style="margin-left:17%;">This flag can be used together
with the <b>-in</b> option and indicates that the input is a
DER-encoded time stamp token (ContentInfo) instead of a time
stamp response (TimeStampResp).</p>

<p style="margin-top: 1em"><b>-untrusted</b>
<i>cert_file.pem</i></p>

<p style="margin-left:17%;">Set of additional untrusted
certificates in PEM format which may be needed when building
the certificate chain for the TSA&rsquo;s signing
certificate. This file must contain the TSA signing
certificate and all intermediate CA certificates unless the
response includes them.</p>

<p style="margin-top: 1em"><b>TS CONFIGURATION FILE
OPTIONS</b></p>

<p style="margin-left:6%;">The <b>-query</b> and
<b>-reply</b> options make use of a configuration file
defined by the OPENSSL_CONF environment variable. The
<b>-query</b> option uses only the symbolic OID names
section and it can work without it. However, the
<b>-reply</b> option needs the config file for its
operation.</p>

<p style="margin-left:6%; margin-top: 1em">When there is a
command line switch equivalent of a variable the switch
always overrides the settings in the config file.</p>

<p style="margin-top: 1em"><b>tsa</b> <i>section</i>,
<b>default_tsa</b></p>

<p style="margin-left:17%;">This is the main section and it
specifies the name of another section that contains all the
options for the <b>-reply</b> option. This default section
can be overridden with the <b>-section</b> command line
switch.</p>

<p style="margin-top: 1em"><b>oid_file</b></p>

<p style="margin-left:17%;">See <b>ca</b> for a
description.</p>

<p style="margin-top: 1em"><b>oid_section</b></p>

<p style="margin-left:17%;">See <b>ca</b> for a
description.</p>

<p style="margin-top: 1em"><b>serial</b></p>

<p style="margin-left:17%; margin-top: 1em">The name of the
file containing the hexadecimal serial number of the last
time stamp response created. This number is incremented by 1
for each response. If the file does not exist at the time of
response generation a new file is created with serial number
1. This parameter is mandatory.</p>

<p style="margin-top: 1em"><b>signer_cert</b></p>

<p style="margin-left:17%;">TSA signing certificate, in PEM
format. The same as the <b>-signer</b> command line
option.</p>

<p style="margin-top: 1em"><b>certs</b></p>

<p style="margin-left:17%; margin-top: 1em">A file
containing a set of PEM-encoded certificates that need to be
included in the response. The same as the <b>-chain</b>
command line option.</p>

<p style="margin-top: 1em"><b>signer_key</b></p>

<p style="margin-left:17%;">The private key of the TSA, in
PEM format. The same as the <b>-inkey</b> command line
option.</p>

<p style="margin-top: 1em"><b>default_policy</b></p>

<p style="margin-left:17%;">The default policy to use when
the request does not mandate any policy. The same as the
<b>-policy</b> command line option.</p>

<p style="margin-top: 1em"><b>other_policies</b></p>

<p style="margin-left:17%;">Comma separated list of
policies that are also acceptable by the TSA and used only
if the request explicitly specifies one of them.</p>

<p style="margin-top: 1em"><b>digests</b></p>

<p style="margin-left:17%;">The list of message digest
algorithms that the TSA accepts. At least one algorithm must
be specified. This parameter is mandatory.</p>

<p style="margin-top: 1em"><b>accuracy</b></p>

<p style="margin-left:17%;">The accuracy of the time source
of the TSA in seconds, milliseconds and microseconds. For
example, secs:1, millisecs:500, microsecs:100. If any of the
components is missing, zero is assumed for that field.</p>


<p style="margin-top: 1em"><b>clock_precision_digits</b></p>

<p style="margin-left:17%;">Specifies the maximum number of
digits, which represent the fraction of seconds, that need
to be included in the time field. The trailing zeroes must
be removed from the time, so there might actually be fewer
digits, or no fraction of seconds at all. The maximum value
is 6; the default is 0.</p>

<p style="margin-top: 1em"><b>ordering</b></p>

<p style="margin-left:17%;">If this option is yes, the
responses generated by this TSA can always be ordered, even
if the time difference between two responses is less than
the sum of their accuracies. The default is no.</p>

<p style="margin-top: 1em"><b>tsa_name</b></p>

<p style="margin-left:17%;">Set this option to yes if the
subject name of the TSA must be included in the TSA name
field of the response. The default is no.</p>

<p style="margin-top: 1em"><b>ess_cert_id_chain</b></p>

<p style="margin-left:17%;">The SignedData objects created
by the TSA always contain the certificate identifier of the
signing certificate in a signed attribute (see RFC 2634,
Enhanced Security Services). If this option is set to yes
and either the <b>certs</b> variable or the <b>-chain</b>
option is specified then the certificate identifiers of the
chain will also be included in the SigningCertificate signed
attribute. If this variable is set to no, only the signing
certificate identifier is included. The default is no.</p>

<p style="margin-top: 1em"><b>TS ENVIRONMENT
VARIABLES</b></p>

<p style="margin-left:6%;">OPENSSL_CONF contains the path
of the configuration file and can be overridden by the
<b>-config</b> command line option.</p>

<p style="margin-top: 1em"><b>TS EXAMPLES</b></p>

<p style="margin-left:6%;">All the examples below presume
that OPENSSL_CONF is set to a proper configuration file,
e.g. the example configuration file
<i>openssl/apps/openssl.cnf</i> will do.</p>

<p style="margin-left:6%; margin-top: 1em">To create a time
stamp request for design1.txt with SHA-1 without nonce and
policy and no certificate is required in the response:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-query -data design1.txt -no_nonce \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-out design1.tsq</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To create a
similar time stamp request but specifying the message
imprint explicitly:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-query \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-no_nonce -out design1.tsq</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To print the
content of the previous request in human readable
format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-query -in design1.tsq -text</p>

<p style="margin-left:6%; margin-top: 1em">To create a time
stamp request which includes the MD5 digest of design2.txt,
requests the signer certificate and nonce, specifies a
policy ID (assuming the tsa_policy1 name is defined in the
OID section of the config file):</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-query -data design2.txt -md5 \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-policy tsa_policy1 -cert -out design2.tsq</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Before
generating a response, a signing certificate must be created
for the TSA that contains the <b>timeStamping</b> critical
extended key usage extension without any other key usage
extensions. You can add the &ldquo;extendedKeyUsage =
critical,timeStamping&rdquo; line to the user certificate
section of the config file to generate a proper certificate.
See the <b>req</b>, <b>ca</b>, and <b>x509</b> commands for
instructions. The examples below assume that cacert.pem
contains the certificate of the CA, tsacert.pem is the
signing certificate issued by cacert.pem and tsakey.pem is
the private key of the TSA.</p>

<p style="margin-left:6%; margin-top: 1em">To create a time
stamp response for a request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -queryfile design1.tsq -inkey tsakey.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-signer tsacert.pem -out design1.tsr</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">If you want to
use the settings in the config file you could just
write:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -queryfile design1.tsq -out design1.tsr</p>

<p style="margin-left:6%; margin-top: 1em">To print a time
stamp reply to stdout in human readable format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -in design1.tsr -text</p>

<p style="margin-left:6%; margin-top: 1em">To create a time
stamp token instead of time stamp response:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -queryfile design1.tsq \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-out design1_token.der -token_out</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To print a time
stamp token to stdout in human readable format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -in design1_token.der -token_in \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-text -token_out</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To extract the
time stamp token from a response:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -in design1.tsr -out design1_token.der \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-token_out</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To add
&ldquo;granted&rdquo; status info to a time stamp token
thereby creating a valid response:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-reply -in design1_token.der \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-token_in -out design1.tsr</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To verify a time
stamp reply against a request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-verify -queryfile design1.tsq -in design1.tsr \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-CAfile cacert.pem -untrusted tsacert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To verify a time
stamp reply that includes the certificate chain:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-verify -queryfile design2.tsq -in design2.tsr \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-CAfile cacert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To verify a time
stamp token against the original data file:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-verify -data design2.txt -in design2.tsr \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-CAfile cacert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">To verify a time
stamp token against a message imprint:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl ts
-verify \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \</p></td></tr>
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-in design2.tsr -CAfile cacert.pem</p></td></tr>
</table>

<p style="margin-top: 1em"><b>TS BUGS</b></p>

<p style="margin-left:6%;">No support for time stamps over
SMTP, though it is quite easy to implement an automatic
email-based TSA with procmail and perl(1). Pure TCP/IP is
not supported.</p>

<p style="margin-left:6%; margin-top: 1em">The file
containing the last serial number of the TSA is not locked
when being read or written. This is a problem if more than
one instance of <b>OpenSSL</b> is trying to create a time
stamp response at the same time.</p>

<p style="margin-left:6%; margin-top: 1em">Look for the
FIXME word in the source files.</p>

<p style="margin-left:6%; margin-top: 1em">The source code
should really be reviewed by somebody else, too.</p>

<p style="margin-left:6%; margin-top: 1em">More testing is
needed.</p>

<p style="margin-top: 1em"><b>TS AUTHORS</b></p>

<p style="margin-left:6%;">Zoltan Glozik
&lt;<i>zglozik@opentsa.org</i>&gt;, OpenTSA project
(<b>http://www.opentsa.org</b>).</p>

<p style="margin-top: 1em"><b>SPKAC</b></p>

<p style="margin-left:6%;"><b>openssl spkac</b>
[<b>-challenge&nbsp;</b><i>string</i>]
[<b>-in&nbsp;</b><i>file</i>]
[<b>-key&nbsp;</b><i>keyfile</i>] [<b>-noout</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-passin&nbsp;</b><i>arg</i>] [<b>-pubkey</b>]
[<b>-spkac&nbsp;</b><i>spkacname</i>]
[<b>-spksect&nbsp;</b><i>section</i>] [<b>-verify</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>spkac</b>
command processes Netscape signed public key and challenge
(SPKAC) files. It can print out their contents, verify the
signature, and produce its own SPKACs from a supplied
private key.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-challenge</b>
<i>string</i></p>

<p style="margin-left:17%;">Specifies the challenge string
if an SPKAC is being created.</p>

<p style="margin-top: 1em"><b>-in</b> <i>file</i></p>

<p style="margin-left:17%;">This specifies the input
<i>file</i> to read from, or standard input if this option
is not specified. Ignored if the <b>-key</b> option is
used.</p>

<p style="margin-top: 1em"><b>-key</b> <i>keyfile</i></p>

<p style="margin-left:17%;">Create an SPKAC file using the
private key in <i>keyfile</i>. The <b>-in</b>,
<b>-noout</b>, <b>-spksect</b>, and <b>-verify</b> options
are ignored if present.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:17%; margin-top: 1em">Don&rsquo;t
output the text version of the SPKAC (not used if an SPKAC
is being created).</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:17%;">Specifies the output
<i>file</i> to write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:17%;">The key password source.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:17%;">Output the public key of an
SPKAC (not used if an SPKAC is being created).</p>

<p style="margin-top: 1em"><b>-spkac</b>
<i>spkacname</i></p>

<p style="margin-left:17%;">Allows an alternative name for
the variable containing the SPKAC. The default is
&quot;SPKAC&quot;. This option affects both generated and
input SPKAC files.</p>

<p style="margin-top: 1em"><b>-spksect</b>
<i>section</i></p>

<p style="margin-left:17%;">Allows an alternative name for
the <i>section</i> containing the SPKAC. The default is the
default section.</p>

<p style="margin-top: 1em"><b>-verify</b></p>

<p style="margin-left:17%;">Verifies the digital signature
on the supplied SPKAC.</p>

<p style="margin-top: 1em"><b>SPKAC EXAMPLES</b></p>

<p style="margin-left:6%;">Print out the contents of an
SPKAC:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl spkac
-in spkac.cnf</p>

<p style="margin-left:6%; margin-top: 1em">Verify the
signature of an SPKAC:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl spkac
-in spkac.cnf -noout -verify</p>

<p style="margin-left:6%; margin-top: 1em">Create an SPKAC
using the challenge string &quot;hello&quot;:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl spkac
-key key.pem -challenge hello -out spkac.cnf</p>

<p style="margin-left:6%; margin-top: 1em">Example of an
SPKAC, (long lines split up for clarity):</p>


<p style="margin-left:14%; margin-top: 1em">SPKAC=MIG5MGUwXDANBgkqhkiG9w0BAQEFAANLADBIAkEA1cCoq2Wa3Ixs47uI7F\
<br>

PVwHVIPDx5yso105Y6zpozam135a8R0CpoRvkkigIyXfcCjiVi5oWk+6FfPaD03u\
<br>

PFoQIDAQABFgVoZWxsbzANBgkqhkiG9w0BAQQFAANBAFpQtY/FojdwkJh1bEIYuc\
<br>

2EeM2KHTWPEepWYeawvHD0gQ3DngSC75YCWnnDdq+NQ3F+X4deMx9AaEglZtULwV\
<br>
4=</p>

<p style="margin-top: 1em"><b>SPKAC NOTES</b></p>

<p style="margin-left:6%;">A created SPKAC with suitable DN
components appended can be fed into the <b>ca</b>
utility.</p>

<p style="margin-left:6%; margin-top: 1em">SPKACs are
typically generated by Netscape when a form is submitted
containing the <i>KEYGEN</i> tag as part of the certificate
enrollment process.</p>

<p style="margin-left:6%; margin-top: 1em">The challenge
string permits a primitive form of proof of possession of
private key. By checking the SPKAC signature and a random
challenge string, some guarantee is given that the user
knows the private key corresponding to the public key being
certified. This is important in some applications. Without
this it is possible for a previous SPKAC to be used in a
&quot;replay attack&quot;.</p>

<p style="margin-top: 1em"><b>VERIFY</b></p>

<p style="margin-left:6%;"><b>openssl verify</b>
[<b>-CAfile&nbsp;</b><i>file</i>]
[<b>-CApath&nbsp;</b><i>directory</i>]
[<b>-check_ss_sig</b>] [<b>-crl_check</b>]
[<b>-crl_check_all</b>] [<b>-explicit_policy</b>]
[<b>-extended_crl</b>] [<b>-help</b>]
[<b>-ignore_critical</b>] [<b>-inhibit_any</b>]
[<b>-inhibit_map</b>] [<b>-issuer_checks</b>]
[<b>-policy_check</b>] [<b>-purpose&nbsp;</b><i>purpose</i>]
[<b>-untrusted&nbsp;</b><i>file</i>] [<b>-verbose</b>]
[<b>-x509_strict</b>] [<b>-</b>] [<i>certificates</i>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>verify</b> command verifies certificate chains.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-check_ss_sig</b></p>

<p style="margin-left:17%;">Verify the signature on the
self-signed root CA. This is disabled by default because it
doesn&rsquo;t add any security.</p>

<p style="margin-top: 1em"><b>-CAfile</b> <i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> of trusted
certificates. The <i>file</i> should contain multiple
certificates in PEM format, concatenated together.</p>

<p style="margin-top: 1em"><b>-CApath</b>
<i>directory</i></p>

<p style="margin-left:17%;">A <i>directory</i> of trusted
certificates. The certificates should have names of the form
<i>hash.0</i>, or have symbolic links to them of this form
(&quot;hash&quot; is the hashed certificate subject name:
see the <b>-hash</b> option of the <b>x509</b> utility). The
<b>c_rehash</b> script distributed with OpenSSL will
automatically create symbolic links to a directory of
certificates.</p>

<p style="margin-top: 1em"><b>-crl_check</b></p>

<p style="margin-left:17%;">Checks end entity certificate
validity by attempting to look up a valid CRL. If a valid
CRL cannot be found an error occurs.</p>

<p style="margin-top: 1em"><b>-crl_check_all</b></p>

<p style="margin-left:17%;">Checks the validity of all
certificates in the chain by attempting to look up valid
CRLs.</p>

<p style="margin-top: 1em"><b>-explicit_policy</b></p>

<p style="margin-left:17%;">Set policy variable
require-explicit-policy (see RFC 3280 et al).</p>

<p style="margin-top: 1em"><b>-extended_crl</b></p>

<p style="margin-left:17%;">Enable extended CRL features
such as indirect CRLs and alternate CRL signing keys.</p>

<p style="margin-top: 1em"><b>-help</b></p>

<p style="margin-left:17%; margin-top: 1em">Prints out a
usage message.</p>

<p style="margin-top: 1em"><b>-ignore_critical</b></p>

<p style="margin-left:17%;">Normally if an unhandled
critical extension is present which is not supported by
<b>OpenSSL</b>, the certificate is rejected (as required by
RFC 3280 et al). If this option is set, critical extensions
are ignored.</p>

<p style="margin-top: 1em"><b>-inhibit_any</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-any-policy (see RFC 3280 et al).</p>

<p style="margin-top: 1em"><b>-inhibit_map</b></p>

<p style="margin-left:17%;">Set policy variable
inhibit-policy-mapping (see RFC 3280 et al).</p>

<p style="margin-top: 1em"><b>-issuer_checks</b></p>

<p style="margin-left:17%;">Print out diagnostics relating
to searches for the issuer certificate of the current
certificate. This shows why each candidate issuer
certificate was rejected. However the presence of rejection
messages does not itself imply that anything is wrong:
during the normal verify process several rejections may take
place.</p>

<p style="margin-top: 1em"><b>-policy_check</b></p>

<p style="margin-left:17%;">Enables certificate policy
processing.</p>

<p style="margin-top: 1em"><b>-purpose</b>
<i>purpose</i></p>

<p style="margin-left:17%;">The intended use for the
certificate. Without this option no chain verification will
be done. Currently accepted uses are <i>sslclient</i>,
<i>sslserver</i>, <i>nssslserver</i>, <i>smimesign</i>,
<i>smimeencrypt</i>, <i>crlsign</i>, <i>any</i>, and
<i>ocsphelper</i>. See the <i>VERIFY OPERATION</i> section
for more information.</p>

<p style="margin-top: 1em"><b>-untrusted</b>
<i>file</i></p>

<p style="margin-left:17%;">A <i>file</i> of untrusted
certificates. The <i>file</i> should contain multiple
certificates.</p>

<p style="margin-top: 1em"><b>-verbose</b></p>

<p style="margin-left:17%;">Print extra information about
the operations being performed.</p>

<p style="margin-top: 1em"><b>-x509_strict</b></p>

<p style="margin-left:17%;">Disable workarounds for broken
certificates which have to be disabled for strict X.509
compliance.</p>

<p style="margin-top: 1em"><b>-</b></p>

<p style="margin-left:17%; margin-top: 1em">Marks the last
option. All arguments following this are assumed to be
certificate files. This is useful if the first certificate
filename begins with a &rsquo;-&rsquo;.</p>

<p style="margin-top: 1em"><i>certificates</i></p>

<p style="margin-left:17%;">One or more <i>certificates</i>
to verify. If no certificate files are included, an attempt
is made to read a certificate from standard input. They
should all be in PEM format.</p>

<p style="margin-top: 1em"><b>VERIFY OPERATION</b></p>

<p style="margin-left:6%;">The <b>verify</b> program uses
the same functions as the internal SSL and S/MIME
verification, therefore this description applies to these
verify operations too.</p>

<p style="margin-left:6%; margin-top: 1em">There is one
crucial difference between the verify operations performed
by the <b>verify</b> program: wherever possible an attempt
is made to continue after an error, whereas normally the
verify operation would halt on the first error. This allows
all the problems with a certificate chain to be
determined.</p>

<p style="margin-left:6%; margin-top: 1em">The verify
operation consists of a number of separate steps:</p>

<p style="margin-left:6%; margin-top: 1em">Firstly a
certificate chain is built up starting from the supplied
certificate and ending in the root CA. It is an error if the
whole chain cannot be built up. The chain is built up by
looking up the issuer&rsquo;s certificate of the current
certificate. If a certificate is found which is its own
issuer, it is assumed to be the root CA.</p>

<p style="margin-left:6%; margin-top: 1em">The process of
&quot;looking up the issuer&rsquo;s certificate&quot; itself
involves a number of steps. In versions of <b>OpenSSL</b>
before 0.9.5a the first certificate whose subject name
matched the issuer of the current certificate was assumed to
be the issuer&rsquo;s certificate. In <b>OpenSSL</b> 0.9.6
and later all certificates whose subject name matches the
issuer name of the current certificate are subject to
further tests. The relevant authority key identifier
components of the current certificate (if present) must
match the subject key identifier (if present) and issuer and
serial number of the candidate issuer; in addition the
<i>keyUsage</i> extension of the candidate issuer (if
present) must permit certificate signing.</p>

<p style="margin-left:6%; margin-top: 1em">The lookup first
looks in the list of untrusted certificates and if no match
is found the remaining lookups are from the trusted
certificates. The root CA is always looked up in the trusted
certificate list: if the certificate to verify is a root
certificate, then an exact match must be found in the
trusted list.</p>

<p style="margin-left:6%; margin-top: 1em">The second
operation is to check every untrusted certificate&rsquo;s
extensions for consistency with the supplied purpose. If the
<b>-purpose</b> option is not included, then no checks are
done. The supplied or &quot;leaf&quot; certificate must have
extensions compatible with the supplied purpose and all
other certificates must also be valid CA certificates. The
precise extensions required are described in more detail in
the <i>X.509 CERTIFICATE EXTENSIONS</i> section below.</p>

<p style="margin-left:6%; margin-top: 1em">The third
operation is to check the trust settings on the root CA. The
root CA should be trusted for the supplied purpose. For
compatibility with previous versions of <b>SSLeay</b> and
<b>OpenSSL</b>, a certificate with no trust settings is
considered to be valid for all purposes.</p>

<p style="margin-left:6%; margin-top: 1em">The final
operation is to check the validity of the certificate chain.
The validity period is checked against the current system
time and the <i>notBefore</i> and <i>notAfter</i> dates in
the certificate. The certificate signatures are also checked
at this point.</p>

<p style="margin-left:6%; margin-top: 1em">If all
operations complete successfully, the certificate is
considered valid. If any operation fails then the
certificate is not valid.</p>

<p style="margin-top: 1em"><b>VERIFY DIAGNOSTICS</b></p>

<p style="margin-left:6%;">When a verify operation fails,
the output messages can be somewhat cryptic. The general
form of the error message is:</p>

<p style="margin-left:6%; margin-top: 1em">server.pem:
/C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA
(1024-bit) <br>
error 24 at 1 depth lookup:invalid CA certificate</p>

<p style="margin-left:6%; margin-top: 1em">The first line
contains the name of the certificate being verified,
followed by the subject name of the certificate. The second
line contains the error number and the depth. The depth is
the number of the certificate being verified when a problem
was detected starting with zero for the certificate being
verified itself, then 1 for the CA that signed the
certificate and so on. Finally a text version of the error
number is presented.</p>

<p style="margin-left:6%; margin-top: 1em">An exhaustive
list of the error codes and messages is shown below; this
also includes the name of the error code as defined in the
header file &lt;<i>openssl/x509_vfy.h</i>&gt;. Some of the
error codes are defined but never returned: these are
described as &quot;unused&quot;.</p>

<p style="margin-top: 1em"><i>0 X509_V_OK: ok</i></p>

<p style="margin-left:14%;">The operation was
successful.</p>

<p style="margin-top: 1em"><i>2
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT: unable to get issuer
certificate</i></p>

<p style="margin-left:14%;">The issuer certificate could
not be found: this occurs if the issuer certificate of an
untrusted certificate cannot be found.</p>

<p style="margin-top: 1em"><i>3
X509_V_ERR_UNABLE_TO_GET_CRL: unable to get certificate
CRL</i></p>

<p style="margin-left:14%;">The CRL of a certificate could
not be found.</p>

<p style="margin-top: 1em"><i>4
X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE: unable to
decrypt certificate&rsquo;s signature</i></p>

<p style="margin-left:14%;">The certificate signature could
not be decrypted. This means that the actual signature value
could not be determined rather than it not matching the
expected value. This is only meaningful for RSA keys.</p>

<p style="margin-top: 1em"><i>5
X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE: unable to
decrypt CRL&rsquo;s signature</i></p>

<p style="margin-left:14%;">The CRL signature could not be
decrypted: this means that the actual signature value could
not be determined rather than it not matching the expected
value. Unused.</p>

<p style="margin-top: 1em"><i>6
X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY: unable to
decode issuer public key</i></p>

<p style="margin-left:14%;">The public key in the
certificate <i>SubjectPublicKeyInfo</i> could not be
read.</p>

<p style="margin-top: 1em"><i>7
X509_V_ERR_CERT_SIGNATURE_FAILURE: certificate signature
failure</i></p>

<p style="margin-left:14%;">The signature of the
certificate is invalid.</p>

<p style="margin-top: 1em"><i>8
X509_V_ERR_CRL_SIGNATURE_FAILURE: CRL signature
failure</i></p>

<p style="margin-left:14%;">The signature of the
certificate is invalid.</p>

<p style="margin-top: 1em"><i>9
X509_V_ERR_CERT_NOT_YET_VALID: certificate is not yet
valid</i></p>

<p style="margin-left:14%;">The certificate is not yet
valid: the <i>notBefore</i> date is after the current
time.</p>

<p style="margin-top: 1em"><i>10
X509_V_ERR_CERT_HAS_EXPIRED: certificate has expired</i></p>

<p style="margin-left:14%;">The certificate has expired;
that is, the <i>notAfter</i> date is before the current
time.</p>

<p style="margin-top: 1em"><i>11
X509_V_ERR_CRL_NOT_YET_VALID: CRL is not yet valid</i></p>

<p style="margin-left:14%;">The CRL is not yet valid.</p>

<p style="margin-top: 1em"><i>12
X509_V_ERR_CRL_HAS_EXPIRED: CRL has expired</i></p>

<p style="margin-left:14%;">The CRL has expired.</p>

<p style="margin-top: 1em"><i>13
X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD: format error in
certificate&rsquo;s notBefore field</i></p>

<p style="margin-left:14%;">The certificate
<i>notBefore</i> field contains an invalid time.</p>

<p style="margin-top: 1em"><i>14
X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD: format error in
certificate&rsquo;s notAfter field</i></p>

<p style="margin-left:14%;">The certificate <i>notAfter</i>
field contains an invalid time.</p>

<p style="margin-top: 1em"><i>15
X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD: format error in
CRL&rsquo;s lastUpdate field</i></p>

<p style="margin-left:14%;">The CRL <i>lastUpdate</i> field
contains an invalid time.</p>

<p style="margin-top: 1em"><i>16
X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD: format error in
CRL&rsquo;s nextUpdate field</i></p>

<p style="margin-left:14%;">The CRL <i>nextUpdate</i> field
contains an invalid time.</p>

<p style="margin-top: 1em"><i>17 X509_V_ERR_OUT_OF_MEM: out
of memory</i></p>

<p style="margin-left:14%;">An error occurred trying to
allocate memory. This should never happen.</p>

<p style="margin-top: 1em"><i>18
X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT: self signed
certificate</i></p>

<p style="margin-left:14%;">The passed certificate is
self-signed and the same certificate cannot be found in the
list of trusted certificates.</p>

<p style="margin-top: 1em"><i>19
X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN: self signed
certificate in certificate chain</i></p>

<p style="margin-left:14%;">The certificate chain could be
built up using the untrusted certificates but the root could
not be found locally.</p>

<p style="margin-top: 1em"><i>20
X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY: unable to get
local issuer certificate</i></p>

<p style="margin-left:14%;">The issuer certificate of a
locally looked up certificate could not be found. This
normally means the list of trusted certificates is not
complete.</p>

<p style="margin-top: 1em"><i>21
X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE: unable to verify
the first certificate</i></p>

<p style="margin-left:14%;">No signatures could be verified
because the chain contains only one certificate and it is
not self-signed.</p>

<p style="margin-top: 1em"><i>22
X509_V_ERR_CERT_CHAIN_TOO_LONG: certificate chain too
long</i></p>

<p style="margin-left:14%;">The certificate chain length is
greater than the supplied maximum depth. Unused.</p>

<p style="margin-top: 1em"><i>23 X509_V_ERR_CERT_REVOKED:
certificate revoked</i></p>

<p style="margin-left:14%;">The certificate has been
revoked.</p>

<p style="margin-top: 1em"><i>24 X509_V_ERR_INVALID_CA:
invalid CA certificate</i></p>

<p style="margin-left:14%;">A CA certificate is invalid.
Either it is not a CA or its extensions are not consistent
with the supplied purpose.</p>

<p style="margin-top: 1em"><i>25
X509_V_ERR_PATH_LENGTH_EXCEEDED: path length constraint
exceeded</i></p>

<p style="margin-left:14%;">The <i>basicConstraints</i>
pathlength parameter has been exceeded.</p>

<p style="margin-top: 1em"><i>26
X509_V_ERR_INVALID_PURPOSE: unsupported certificate
purpose</i></p>

<p style="margin-left:14%;">The supplied certificate cannot
be used for the specified purpose.</p>

<p style="margin-top: 1em"><i>27 X509_V_ERR_CERT_UNTRUSTED:
certificate not trusted</i></p>

<p style="margin-left:14%;">The root CA is not marked as
trusted for the specified purpose.</p>

<p style="margin-top: 1em"><i>28 X509_V_ERR_CERT_REJECTED:
certificate rejected</i></p>

<p style="margin-left:14%;">The root CA is marked to reject
the specified purpose.</p>

<p style="margin-top: 1em"><i>29
X509_V_ERR_SUBJECT_ISSUER_MISMATCH: subject issuer
mismatch</i></p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its subject name did not
match the issuer name of the current certificate. Only
displayed when the <b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em"><i>30
X509_V_ERR_AKID_SKID_MISMATCH: authority and subject key
identifier mismatch</i></p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its subject key identifier
was present and did not match the authority key identifier
current certificate. Only displayed when the
<b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em"><i>31
X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH: authority and issuer
serial number mismatch</i></p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its issuer name and serial
number were present and did not match the authority key
identifier of the current certificate. Only displayed when
the <b>-issuer_checks</b> option is set.</p>

<p style="margin-top: 1em"><i>32
X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key usage does not include
certificate signing</i></p>

<p style="margin-left:14%;">The current candidate issuer
certificate was rejected because its <i>keyUsage</i>
extension does not permit certificate signing.</p>

<p style="margin-top: 1em"><i>50
X509_V_ERR_APPLICATION_VERIFICATION: application
verification failure</i></p>

<p style="margin-left:14%;">An application specific error.
Unused.</p>

<p style="margin-top: 1em"><b>VERIFY BUGS</b></p>

<p style="margin-left:6%;">Although the issuer checks are a
considerable improvement over the old technique, they still
suffer from limitations in the underlying X509_LOOKUP API.
One consequence of this is that trusted certificates with
matching subject name must either appear in a file (as
specified by the <b>-CAfile</b> option) or a directory (as
specified by <b>-CApath</b>). If they occur in both, only
the certificates in the file will be recognised.</p>

<p style="margin-left:6%; margin-top: 1em">Previous
versions of <b>OpenSSL</b> assumed certificates with
matching subject name were identical and mishandled
them.</p>

<p style="margin-top: 1em"><b>VERSION</b></p>

<p style="margin-left:6%;"><b>openssl version</b>
[<b>-abdfopv</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>version</b> command is used to print out version
information about <b>OpenSSL</b>.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>-a</b></p>

<p style="margin-left:17%; margin-top: 1em">All
information: this is the same as setting all the other
flags.</p>

<p style="margin-top: 1em"><b>-b</b></p>

<p style="margin-left:17%; margin-top: 1em">The date the
current version of <b>OpenSSL</b> was built.</p>

<p style="margin-top: 1em"><b>-d</b></p>

<p style="margin-left:17%; margin-top: 1em">OPENSSLDIR
setting.</p>

<p style="margin-top: 1em"><b>-f</b></p>

<p style="margin-left:17%; margin-top: 1em">Compilation
flags.</p>

<p style="margin-top: 1em"><b>-o</b></p>

<p style="margin-left:17%; margin-top: 1em">Option
information: various options set when the library was
built.</p>

<p style="margin-top: 1em"><b>-p</b></p>

<p style="margin-left:17%; margin-top: 1em">Platform
setting.</p>

<p style="margin-top: 1em"><b>-v</b></p>

<p style="margin-left:17%; margin-top: 1em">The current
<b>OpenSSL</b> version.</p>

<p style="margin-top: 1em"><b>VERSION NOTES</b></p>

<p style="margin-left:6%;">The output of <b>openssl version
-a</b> would typically be used when sending in a bug
report.</p>

<p style="margin-top: 1em"><b>VERSION HISTORY</b></p>

<p style="margin-left:6%;">The <b>-d</b> option was added
in <b>OpenSSL</b> 0.9.7.</p>

<p style="margin-top: 1em"><b>X509</b></p>

<p style="margin-left:6%;"><b>openssl x509</b> [<b>-C</b>]
[<b>-addreject&nbsp;</b><i>arg</i>]
[<b>-addtrust&nbsp;</b><i>arg</i>] [<b>-alias</b>]
[<b>-CA&nbsp;</b><i>file</i>] [<b>-CAcreateserial</b>]
[<b>-CAform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-CAkey&nbsp;</b><i>file</i>]
[<b>-CAkeyform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-CAserial&nbsp;</b><i>file</i>]
[<b>-certopt&nbsp;</b><i>option</i>]
[<b>-checkend&nbsp;</b><i>arg</i>] [<b>-clrext</b>]
[<b>-clrreject</b>] [<b>-clrtrust</b>] [<b>-dates</b>]
[<b>-days&nbsp;</b><i>arg</i>] [<b>-email</b>]
[<b>-enddate</b>] [<b>-extensions&nbsp;</b><i>section</i>]
[<b>-extfile&nbsp;</b><i>file</i>] [<b>-fingerprint</b>]
[<b>-hash</b>] [<b>-in&nbsp;</b><i>file</i>]
[<b>-inform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>NET&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-issuer</b>] [<b>-issuer_hash</b>]
[<b>-issuer_hash_old</b>]
[<b>-keyform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-md5&nbsp;</b>|&nbsp;<b>-sha1</b>] [<b>-modulus</b>]
[<b>-nameopt&nbsp;</b><i>option</i>] [<b>-noout</b>]
[<b>-ocsp_uri</b>] [<b>-ocspid</b>]
[<b>-out&nbsp;</b><i>file</i>]
[<b>-outform&nbsp;</b><i>DER&nbsp;</i>|&nbsp;<i>NET&nbsp;</i>|&nbsp;<i>PEM</i>]
[<b>-passin&nbsp;</b><i>arg</i>] [<b>-pubkey</b>]
[<b>-purpose</b>] [<b>-req</b>] [<b>-serial</b>]
[<b>-set_serial&nbsp;</b><i>n</i>]
[<b>-setalias&nbsp;</b><i>arg</i>]
[<b>-signkey&nbsp;</b><i>file</i>] [<b>-startdate</b>]
[<b>-subject</b>] [<b>-subject_hash</b>]
[<b>-subject_hash_old</b>] [<b>-text</b>] [<b>-trustout</b>]
[<b>-x509toreq</b>]</p>

<p style="margin-left:6%; margin-top: 1em">The <b>x509</b>
command is a multi-purpose certificate utility. It can be
used to display certificate information, convert
certificates to various forms, sign certificate requests
like a &quot;mini CA&quot;, or edit certificate trust
settings.</p>

<p style="margin-left:6%; margin-top: 1em">Since there are
a large number of options, they are split up into various
sections.</p>

<p style="margin-top: 1em"><b>X509 INPUT, OUTPUT, AND
GENERAL PURPOSE OPTIONS <br>
-in</b> <i>file</i></p>

<p style="margin-left:14%;">This specifies the input
<i>file</i> to read a certificate from, or standard input if
this option is not specified.</p>

<p style="margin-top: 1em"><b>-inform</b> <i>DER</i> |
<i>NET</i> | <i>PEM</i></p>

<p style="margin-left:14%;">This specifies the input
format. Normally, the command will expect an X.509
certificate, but this can change if other options such as
<b>-req</b> are present. The <i>DER</i> format is the DER
encoding of the certificate and <i>PEM</i> is the base64
encoding of the DER encoding with header and footer lines
added. The <i>NET</i> option is an obscure Netscape server
format that is now obsolete.</p>

<p style="margin-top: 1em"><b>-md5</b> | <b>-sha1</b></p>

<p style="margin-left:14%;">The digest to use. This affects
any signing or display option that uses a message digest,
such as the <b>-fingerprint</b>, <b>-signkey</b>, and
<b>-CA</b> options. If not specified, MD5 is used. If the
key being used to sign with is a DSA key, this option has no
effect: SHA1 is always used with DSA keys.</p>

<p style="margin-top: 1em"><b>-out</b> <i>file</i></p>

<p style="margin-left:14%;">This specifies the output
<i>file</i> to write to, or standard output by default.</p>

<p style="margin-top: 1em"><b>-outform</b> <i>DER</i> |
<i>NET</i> | <i>PEM</i></p>

<p style="margin-left:14%;">This specifies the output
format; the options have the same meaning as the
<b>-inform</b> option.</p>

<p style="margin-top: 1em"><b>-passin</b> <i>arg</i></p>

<p style="margin-left:14%;">The key password source.</p>

<p style="margin-top: 1em"><b>X509 DISPLAY OPTIONS</b></p>

<p style="margin-left:6%;"><b>Note</b>: The <b>-alias</b>
and <b>-purpose</b> options are also display options but are
described in the <i>X509 TRUST SETTINGS</i> section.</p>

<p style="margin-top: 1em"><b>-C</b></p>

<p style="margin-left:14%; margin-top: 1em">This outputs
the certificate in the form of a C source file.</p>

<p style="margin-top: 1em"><b>-certopt</b>
<i>option</i></p>

<p style="margin-left:14%;">Customise the output format
used with <b>-text</b>. The <i>option</i> argument can be a
single option or multiple options separated by commas. The
<b>-certopt</b> switch may also be used more than once to
set multiple options. See the <i>X509 TEXT OPTIONS</i>
section for more information.</p>

<p style="margin-top: 1em"><b>-dates</b></p>

<p style="margin-left:14%;">Prints out the start and expiry
dates of a certificate.</p>

<p style="margin-top: 1em"><b>-email</b></p>

<p style="margin-left:14%;">Outputs the email address(es),
if any.</p>

<p style="margin-top: 1em"><b>-enddate</b></p>

<p style="margin-left:14%;">Prints out the expiry date of
the certificate; that is, the <i>notAfter</i> date.</p>

<p style="margin-top: 1em"><b>-fingerprint</b></p>

<p style="margin-left:14%;">Prints out the digest of the
DER-encoded version of the whole certificate (see <i>DIGEST
OPTIONS</i>).</p>

<p style="margin-top: 1em"><b>-hash</b></p>

<p style="margin-left:14%;">A synonym for
<b>-subject_hash</b>, for backwards compatibility.</p>

<p style="margin-top: 1em"><b>-issuer</b></p>

<p style="margin-left:14%;">Outputs the issuer name.</p>

<p style="margin-top: 1em"><b>-issuer_hash</b></p>

<p style="margin-left:14%;">Outputs the &quot;hash&quot; of
the certificate issuer name.</p>

<p style="margin-top: 1em"><b>-issuer_hash_old</b></p>

<p style="margin-left:14%;">Outputs the &quot;hash&quot; of
the certificate issuer name using the older algorithm as
used by <b>OpenSSL</b> versions before 1.0.0.</p>

<p style="margin-top: 1em"><b>-modulus</b></p>

<p style="margin-left:14%;">This option prints out the
value of the modulus of the public key contained in the
certificate.</p>

<p style="margin-top: 1em"><b>-nameopt</b>
<i>option</i></p>

<p style="margin-left:14%;">Option which determines how the
subject or issuer names are displayed. The <i>option</i>
argument can be a single option or multiple options
separated by commas. Alternatively, the <b>-nameopt</b>
switch may be used more than once to set multiple options.
See the <i>X509 NAME OPTIONS</i> section for more
information.</p>

<p style="margin-top: 1em"><b>-noout</b></p>

<p style="margin-left:14%;">This option prevents output of
the encoded version of the request.</p>

<p style="margin-top: 1em"><b>-ocsp_uri</b></p>

<p style="margin-left:14%;">Outputs the OCSP responder
addresses, if any.</p>

<p style="margin-top: 1em"><b>-ocspid</b></p>

<p style="margin-left:14%;">Print OCSP hash values for the
subject name and public key.</p>

<p style="margin-top: 1em"><b>-pubkey</b></p>

<p style="margin-left:14%;">Output the public key.</p>

<p style="margin-top: 1em"><b>-serial</b></p>

<p style="margin-left:14%;">Outputs the certificate serial
number.</p>

<p style="margin-top: 1em"><b>-startdate</b></p>

<p style="margin-left:14%;">Prints out the start date of
the certificate; that is, the <i>notBefore</i> date.</p>

<p style="margin-top: 1em"><b>-subject</b></p>

<p style="margin-left:14%;">Outputs the subject name.</p>

<p style="margin-top: 1em"><b>-subject_hash</b></p>

<p style="margin-left:14%;">Outputs the &quot;hash&quot; of
the certificate subject name. This is used in <b>OpenSSL</b>
to form an index to allow certificates in a directory to be
looked up by subject name.</p>

<p style="margin-top: 1em"><b>-subject_hash_old</b></p>

<p style="margin-left:14%;">Outputs the &quot;hash&quot; of
the certificate subject name using the older algorithm as
used by <b>OpenSSL</b> versions before 1.0.0.</p>

<p style="margin-top: 1em"><b>-text</b></p>

<p style="margin-left:14%;">Prints out the certificate in
text form. Full details are output including the public key,
signature algorithms, issuer and subject names, serial
number, any extensions present, and any trust settings.</p>

<p style="margin-top: 1em"><b>X509 TRUST SETTINGS</b></p>

<p style="margin-left:6%;">Please note these options are
currently experimental and may well change.</p>

<p style="margin-left:6%; margin-top: 1em">A <i>trusted
certificate</i> is an ordinary certificate which has several
additional pieces of information attached to it such as the
permitted and prohibited uses of the certificate and an
&quot;alias&quot;.</p>

<p style="margin-left:6%; margin-top: 1em">Normally, when a
certificate is being verified at least one certificate must
be &quot;trusted&quot;. By default, a trusted certificate
must be stored locally and must be a root CA: any
certificate chain ending in this CA is then usable for any
purpose.</p>

<p style="margin-left:6%; margin-top: 1em">Trust settings
currently are only used with a root CA. They allow a finer
control over the purposes the root CA can be used for. For
example, a CA may be trusted for an SSL client but not for
SSL server use.</p>

<p style="margin-left:6%; margin-top: 1em">See the
description of the <b>verify</b> utility for more
information on the meaning of trust settings.</p>

<p style="margin-left:6%; margin-top: 1em">Future versions
of <b>OpenSSL</b> will recognize trust settings on any
certificate: not just root CAs.</p>

<p style="margin-top: 1em"><b>-addreject</b> <i>arg</i></p>

<p style="margin-left:14%;">Adds a prohibited use. It
accepts the same values as the <b>-addtrust</b> option.</p>

<p style="margin-top: 1em"><b>-addtrust</b> <i>arg</i></p>

<p style="margin-left:14%;">Adds a trusted certificate use.
Any object name can be used here, but currently only
<i>clientAuth</i> (SSL client use), <i>serverAuth</i> (SSL
server use), and <i>emailProtection</i> (S/MIME email) are
used. Other <b>OpenSSL</b> applications may define
additional uses.</p>

<p style="margin-top: 1em"><b>-alias</b></p>

<p style="margin-left:14%;">Outputs the certificate alias,
if any.</p>

<p style="margin-top: 1em"><b>-clrreject</b></p>

<p style="margin-left:14%;">Clears all the prohibited or
rejected uses of the certificate.</p>

<p style="margin-top: 1em"><b>-clrtrust</b></p>

<p style="margin-left:14%;">Clears all the permitted or
trusted uses of the certificate.</p>

<p style="margin-top: 1em"><b>-purpose</b></p>

<p style="margin-left:14%;">This option performs tests on
the certificate extensions and outputs the results. For a
more complete description, see the <i>X.509 CERTIFICATE
EXTENSIONS</i> section.</p>

<p style="margin-top: 1em"><b>-setalias</b> <i>arg</i></p>

<p style="margin-left:14%;">Sets the alias of the
certificate. This will allow the certificate to be referred
to using a nickname, for example &quot;Steve&rsquo;s
Certificate&quot;.</p>

<p style="margin-top: 1em"><b>-trustout</b></p>

<p style="margin-left:14%;">This causes <b>x509</b> to
output a <i>trusted certificate</i>. An ordinary or trusted
certificate can be input, but by default an ordinary
certificate is output and any trust settings are discarded.
With the <b>-trustout</b> option a trusted certificate is
output. A trusted certificate is automatically output if any
trust settings are modified.</p>

<p style="margin-top: 1em"><b>X509 SIGNING OPTIONS</b></p>

<p style="margin-left:6%;">The <b>x509</b> utility can be
used to sign certificates and requests: it can thus behave
like a &quot;mini CA&quot;.</p>

<p style="margin-top: 1em"><b>-CA</b> <i>file</i></p>

<p style="margin-left:14%;">Specifies the CA certificate to
be used for signing. When this option is present,
<b>x509</b> behaves like a &quot;mini CA&quot;. The input
file is signed by the CA using this option; that is, its
issuer name is set to the subject name of the CA and it is
digitally signed using the CA&rsquo;s private key.</p>

<p style="margin-left:14%; margin-top: 1em">This option is
normally combined with the <b>-req</b> option. Without the
<b>-req</b> option, the input is a certificate which must be
self-signed.</p>

<p style="margin-top: 1em"><b>-CAcreateserial</b></p>

<p style="margin-left:14%;">With this option the CA serial
number file is created if it does not exist: it will contain
the serial number &rsquo;02&rsquo; and the certificate being
signed will have &rsquo;1&rsquo; as its serial number.
Normally, if the <b>-CA</b> option is specified and the
serial number file does not exist, it is an error.</p>

<p style="margin-top: 1em"><b>-CAform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:14%;">The format of the CA
certificate file. The default is <i>PEM</i>.</p>

<p style="margin-top: 1em"><b>-CAkey</b> <i>file</i></p>

<p style="margin-left:14%;">Sets the CA private key to sign
a certificate with. If this option is not specified, it is
assumed that the CA private key is present in the CA
certificate file.</p>

<p style="margin-top: 1em"><b>-CAkeyform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:14%;">The format of the CA private
key. The default is <i>PEM</i>.</p>

<p style="margin-top: 1em"><b>-CAserial</b> <i>file</i></p>

<p style="margin-left:14%;">Sets the CA serial number file
to use.</p>

<p style="margin-left:14%; margin-top: 1em">When the
<b>-CA</b> option is used to sign a certificate, it uses a
serial number specified in a file. This file consists of one
line containing an even number of hex digits with the serial
number to use. After each use the serial number is
incremented and written out to the file again.</p>

<p style="margin-left:14%; margin-top: 1em">The default
filename consists of the CA certificate file base name with
<i>.srl</i> appended. For example, if the CA certificate
file is called <i>mycacert.pem</i>, it expects to find a
serial number file called <i>mycacert.srl</i>.</p>

<p style="margin-top: 1em"><b>-checkend</b> <i>arg</i></p>

<p style="margin-left:14%;">Check whether the certificate
expires in the next <i>arg</i> seconds. If so, exit with
return value 1; otherwise exit with return value 0.</p>

<p style="margin-top: 1em"><b>-clrext</b></p>

<p style="margin-left:14%;">Delete any extensions from a
certificate. This option is used when a certificate is being
created from another certificate (for example with the
<b>-signkey</b> or the <b>-CA</b> options). Normally, all
extensions are retained.</p>

<p style="margin-top: 1em"><b>-days</b> <i>arg</i></p>

<p style="margin-left:14%;">Specifies the number of days to
make a certificate valid for. The default is 30 days.</p>

<p style="margin-top: 1em"><b>-extensions</b>
<i>section</i></p>

<p style="margin-left:14%;">The section to add certificate
extensions from. If this option is not specified, the
extensions should either be contained in the unnamed
(default) section or the default section should contain a
variable called &quot;extensions&quot; which contains the
section to use.</p>

<p style="margin-top: 1em"><b>-extfile</b> <i>file</i></p>

<p style="margin-left:14%;">File containing certificate
extensions to use. If not specified, no extensions are added
to the certificate.</p>

<p style="margin-top: 1em"><b>-keyform</b> <i>DER</i> |
<i>PEM</i></p>

<p style="margin-left:14%;">Specifies the format (DER or
PEM) of the private key file used in the <b>-signkey</b>
option.</p>

<p style="margin-top: 1em"><b>-req</b></p>

<p style="margin-left:14%; margin-top: 1em">By default, a
certificate is expected on input. With this option a
certificate request is expected instead.</p>

<p style="margin-top: 1em"><b>-set_serial</b> <i>n</i></p>

<p style="margin-left:14%;">Specifies the serial number to
use. This option can be used with either the <b>-signkey</b>
or <b>-CA</b> options. If used in conjunction with the
<b>-CA</b> option, the serial number file (as specified by
the <b>-CAserial</b> or <b>-CAcreateserial</b> options) is
not used.</p>

<p style="margin-left:14%; margin-top: 1em">The serial
number can be decimal or hex (if preceded by
&rsquo;0x&rsquo;). Negative serial numbers can also be
specified but their use is not recommended.</p>

<p style="margin-top: 1em"><b>-signkey</b> <i>file</i></p>

<p style="margin-left:14%;">This option causes the input
file to be self-signed using the supplied private key.</p>

<p style="margin-left:14%; margin-top: 1em">If the input
file is a certificate, it sets the issuer name to the
subject name (i.e. makes it self-signed), changes the public
key to the supplied value, and changes the start and end
dates. The start date is set to the current time and the end
date is set to a value determined by the <b>-days</b>
option. Any certificate extensions are retained unless the
<b>-clrext</b> option is supplied.</p>

<p style="margin-left:14%; margin-top: 1em">If the input is
a certificate request, a self-signed certificate is created
using the supplied private key using the subject name in the
request.</p>

<p style="margin-top: 1em"><b>-x509toreq</b></p>

<p style="margin-left:14%;">Converts a certificate into a
certificate request. The <b>-signkey</b> option is used to
pass the required private key.</p>

<p style="margin-top: 1em"><b>X509 NAME OPTIONS</b></p>

<p style="margin-left:6%;">The <b>-nameopt</b> command line
switch determines how the subject and issuer names are
displayed. If no <b>-nameopt</b> switch is present, the
default &quot;oneline&quot; format is used which is
compatible with previous versions of <b>OpenSSL</b>. Each
option is described in detail below; all options can be
preceded by a &rsquo;-&rsquo; to turn the option off. Only
<i>compat</i>, <i>RFC2253</i>, <i>oneline</i>, and
<i>multiline</i> will normally be used.</p>

<p style="margin-top: 1em"><i>align</i></p>

<p style="margin-left:14%;">Align field values for a more
readable output. Only usable with <i>sep_multiline</i>.</p>

<p style="margin-top: 1em"><i>compat</i></p>

<p style="margin-left:14%;">Use the old format. This is
equivalent to specifying no name options at all.</p>

<p style="margin-top: 1em"><i>dn_rev</i></p>

<p style="margin-left:14%;">Reverse the fields of the DN.
This is required by RFC 2253. As a side effect, this also
reverses the order of multiple AVAs but this is
permissible.</p>

<p style="margin-top: 1em"><i>dump_all</i></p>

<p style="margin-left:14%;">Dump all fields. This option,
when used with <i>dump_der</i>, allows the DER encoding of
the structure to be unambiguously determined.</p>

<p style="margin-top: 1em"><i>dump_der</i></p>

<p style="margin-left:14%;">When this option is set, any
fields that need to be hexdumped will be dumped using the
DER encoding of the field. Otherwise just the content octets
will be displayed. Both options use the RFC 2253 #XXXX...
format.</p>

<p style="margin-top: 1em"><i>dump_nostr</i></p>

<p style="margin-left:14%;">Dump non-character string types
(for example OCTET STRING); if this option is not set,
non-character string types will be displayed as though each
content octet represents a single character.</p>

<p style="margin-top: 1em"><i>dump_unknown</i></p>

<p style="margin-left:14%;">Dump any field whose OID is not
recognised by <b>OpenSSL</b>.</p>

<p style="margin-top: 1em"><i>esc_2253</i></p>

<p style="margin-left:14%;">Escape the &quot;special&quot;
characters required by RFC 2253 in a field that is &ldquo;
,+&quot;&lt;&gt;;&rdquo;. Additionally, &rsquo;#&rsquo; is
escaped at the beginning of a string and a space character
at the beginning or end of a string.</p>

<p style="margin-top: 1em"><i>esc_ctrl</i></p>

<p style="margin-left:14%;">Escape control characters. That
is, those with ASCII values less than 0x20 (space) and the
delete (0x7f) character. They are escaped using the RFC 2253
\XX notation (where XX are two hex digits representing the
character value).</p>

<p style="margin-top: 1em"><i>esc_msb</i></p>

<p style="margin-left:14%;">Escape characters with the MSB
set; that is, with ASCII values larger than 127.</p>

<p style="margin-top: 1em"><i>multiline</i></p>

<p style="margin-left:14%;">A multiline format. It is
equivalent to <i>esc_ctrl</i>, <i>esc_msb</i>,
<i>sep_multiline</i>, <i>space_eq</i>, <i>lname</i>, and
<i>align</i>.</p>

<p style="margin-top: 1em"><i>no_type</i></p>

<p style="margin-left:14%;">This option does not attempt to
interpret multibyte characters in any way. That is, their
content octets are merely dumped as though one octet
represents each character. This is useful for diagnostic
purposes but will result in rather odd looking output.</p>

<p style="margin-top: 1em"><i>nofname</i>, <i>sname</i>,
<i>lname</i>, <i>oid</i></p>

<p style="margin-left:14%;">These options alter how the
field name is displayed. <i>nofname</i> does not display the
field at all. <i>sname</i> uses the &quot;short name&quot;
form (CN for <i>commonName</i>, for example). <i>lname</i>
uses the long form. <i>oid</i> represents the OID in
numerical form and is useful for diagnostic purpose.</p>

<p style="margin-top: 1em"><i>oneline</i></p>

<p style="margin-left:14%;">A oneline format which is more
readable than <i>RFC2253</i>. It is equivalent to specifying
the <i>esc_2253</i>, <i>esc_ctrl</i>, <i>esc_msb</i>,
<i>utf8</i>, <i>dump_nostr</i>, <i>dump_der</i>,
<i>use_quote</i>, <i>sep_comma_plus_spc</i>,
<i>space_eq</i>, and <i>sname</i> options.</p>

<p style="margin-top: 1em"><i>RFC2253</i></p>

<p style="margin-left:14%;">Displays names compatible with
RFC 2253; equivalent to <i>esc_2253</i>, <i>esc_ctrl</i>,
<i>esc_msb</i>, <i>utf8</i>, <i>dump_nostr</i>,
<i>dump_unknown</i>, <i>dump_der</i>, <i>sep_comma_plus</i>,
<i>dn_rev</i>, and <i>sname</i>.</p>

<p style="margin-top: 1em"><i>sep_comma_plus</i>,
<i>sep_comma_plus_space</i>, <i>sep_semi_plus_space</i>,
<i>sep_multiline</i></p>

<p style="margin-left:14%;">These options determine the
field separators. The first character is between RDNs and
the second between multiple AVAs (multiple AVAs are very
rare and their use is discouraged). The options ending in
&quot;space&quot; additionally place a space after the
separator to make it more readable. The <i>sep_multiline</i>
uses a linefeed character for the RDN separator and a spaced
&rsquo;+&rsquo; for the AVA separator. It also indents the
fields by four characters.</p>

<p style="margin-top: 1em"><i>show_type</i></p>

<p style="margin-left:14%;">Show the type of the ASN1
character string. The type precedes the field contents. For
example &quot;BMPSTRING: Hello World&quot;.</p>

<p style="margin-top: 1em"><i>space_eq</i></p>

<p style="margin-left:14%;">Places spaces round the
&rsquo;=&rsquo; character which follows the field name.</p>

<p style="margin-top: 1em"><i>use_quote</i></p>

<p style="margin-left:14%;">Escapes some characters by
surrounding the whole string with &rsquo;&quot;&rsquo;
characters. Without the option, all escaping is done with
the &rsquo;\&rsquo; character.</p>

<p style="margin-top: 1em"><i>utf8</i></p>

<p style="margin-left:14%; margin-top: 1em">Convert all
strings to UTF8 format first. This is required by RFC 2253.
If you are lucky enough to have a UTF8 compatible terminal,
the use of this option (and <i>not</i> setting
<i>esc_msb</i>) may result in the correct display of
multibyte (international) characters. If this option is not
present, multibyte characters larger than 0xff will be
represented using the format \UXXXX for 16 bits and
\WXXXXXXXX for 32 bits. Also, if this option is off, any
UTF8Strings will be converted to their character form
first.</p>

<p style="margin-top: 1em"><b>X509 TEXT OPTIONS</b></p>

<p style="margin-left:6%;">As well as customising the name
output format, it is also possible to customise the actual
fields printed using the <b>-certopt</b> options when the
<b>-text</b> option is present. The default behaviour is to
print all fields.</p>

<p style="margin-top: 1em"><i>ca_default</i></p>

<p style="margin-left:14%;">The value used by the <b>ca</b>
utility; equivalent to <i>no_issuer</i>, <i>no_pubkey</i>,
<i>no_header</i>, <i>no_version</i>, <i>no_sigdump</i>, and
<i>no_signame</i>.</p>

<p style="margin-top: 1em"><i>compatible</i></p>

<p style="margin-left:14%;">Use the old format. This is
equivalent to specifying no output options at all.</p>

<p style="margin-top: 1em"><i>ext_default</i></p>

<p style="margin-left:14%;">Retain default extension
behaviour: attempt to print out unsupported certificate
extensions.</p>

<p style="margin-top: 1em"><i>ext_dump</i></p>

<p style="margin-left:14%;">Hex dump unsupported
extensions.</p>

<p style="margin-top: 1em"><i>ext_error</i></p>

<p style="margin-left:14%;">Print an error message for
unsupported certificate extensions.</p>

<p style="margin-top: 1em"><i>ext_parse</i></p>

<p style="margin-left:14%;">ASN1 parse unsupported
extensions.</p>

<p style="margin-top: 1em"><i>no_aux</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out
certificate trust information.</p>

<p style="margin-top: 1em"><i>no_extensions</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out any
X509V3 extensions.</p>

<p style="margin-top: 1em"><i>no_header</i></p>

<p style="margin-left:14%;">Don&rsquo;t print header
information: that is, the lines saying
&quot;Certificate&quot; and &quot;Data&quot;.</p>

<p style="margin-top: 1em"><i>no_issuer</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
issuer name.</p>

<p style="margin-top: 1em"><i>no_pubkey</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
public key.</p>

<p style="margin-top: 1em"><i>no_serial</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
serial number.</p>

<p style="margin-top: 1em"><i>no_sigdump</i></p>

<p style="margin-left:14%;">Don&rsquo;t give a hexadecimal
dump of the certificate signature.</p>

<p style="margin-top: 1em"><i>no_signame</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
signature algorithm used.</p>

<p style="margin-top: 1em"><i>no_subject</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
subject name.</p>

<p style="margin-top: 1em"><i>no_validity</i></p>

<p style="margin-left:14%;">Don&rsquo;t print the validity;
that is, the <i>notBefore</i> and <i>notAfter</i>
fields.</p>

<p style="margin-top: 1em"><i>no_version</i></p>

<p style="margin-left:14%;">Don&rsquo;t print out the
version number.</p>

<p style="margin-top: 1em"><b>X509 EXAMPLES</b></p>

<p style="margin-left:6%;">Display the contents of a
certificate:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -text</p>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate serial number:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -serial</p>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate subject name:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -subject</p>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate subject name in RFC 2253 form:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -subject -nameopt RFC2253</p>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate subject name in oneline form on a terminal
supporting UTF8:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -subject \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-nameopt oneline,-esc_msb</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate MD5 fingerprint:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -noout -fingerprint</p>

<p style="margin-left:6%; margin-top: 1em">Display the
certificate SHA1 fingerprint:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-sha1 -in cert.pem -noout -fingerprint</p>

<p style="margin-left:6%; margin-top: 1em">Convert a
certificate from PEM to DER format:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -inform PEM -out cert.der -outform DER</p>

<p style="margin-left:6%; margin-top: 1em">Convert a
certificate to a certificate request:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-x509toreq -in cert.pem -out req.pem \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="11%">


<p>-signkey key.pem</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Convert a
certificate request into a self-signed certificate using
extensions for a CA:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-req -in careq.pem -extfile openssl.cnf -extensions \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>v3_ca -signkey key.pem -out cacert.pem</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Sign a
certificate request using the CA certificate above and add
user certificate extensions:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-req -in req.pem -extfile openssl.cnf -extensions \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>v3_usr -CA cacert.pem -CAkey key.pem -CAcreateserial</p></td></tr>
</table>

<p style="margin-left:6%; margin-top: 1em">Set a
certificate to be trusted for SSL client use and set its
alias to &quot;Steve&rsquo;s Class 1 CA&quot;:</p>

<p style="margin-left:14%; margin-top: 1em">$ openssl x509
-in cert.pem -addtrust clientAuth \</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="24%"></td>
<td width="76%">


<p>-setalias &quot;Steve&rsquo;s Class 1 CA&quot; -out
trust.pem</p> </td></tr>
</table>

<p style="margin-top: 1em"><b>X509 NOTES</b></p>

<p style="margin-left:6%;">The PEM format uses the header
and footer lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
CERTIFICATE----- <br>
-----END CERTIFICATE-----</p>

<p style="margin-left:6%; margin-top: 1em">It will also
handle files containing:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN X509
CERTIFICATE----- <br>
-----END X509 CERTIFICATE-----</p>

<p style="margin-left:6%; margin-top: 1em">Trusted
certificates have the lines:</p>

<p style="margin-left:14%; margin-top: 1em">-----BEGIN
TRUSTED CERTIFICATE----- <br>
-----END TRUSTED CERTIFICATE-----</p>

<p style="margin-left:6%; margin-top: 1em">The conversion
to UTF8 format used with the name options assumes that
T61Strings use the ISO 8859-1 character set. This is wrong,
but Netscape and MSIE do this, as do many certificates. So
although this is incorrect it is more likely to display the
majority of certificates correctly.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-fingerprint</b> option takes the digest of the
DER-encoded certificate. This is commonly called a
&quot;fingerprint&quot;. Because of the nature of message
digests, the fingerprint of a certificate is unique to that
certificate and two certificates with the same fingerprint
can be considered to be the same.</p>

<p style="margin-left:6%; margin-top: 1em">The Netscape
fingerprint uses MD5, whereas MSIE uses SHA1.</p>

<p style="margin-left:6%; margin-top: 1em">The
<b>-email</b> option searches the subject name and the
subject alternative name extension. Only unique email
addresses will be printed out: it will not print the same
address more than once.</p>

<p style="margin-top: 1em"><b>X.509 CERTIFICATE
EXTENSIONS</b></p>

<p style="margin-left:6%;">The <b>-purpose</b> option
checks the certificate extensions and determines what the
certificate can be used for. The actual checks done are
rather complex and include various hacks and workarounds to
handle broken certificates and software.</p>

<p style="margin-left:6%; margin-top: 1em">The same code is
used when verifying untrusted certificates in chains, so
this section is useful if a chain is rejected by the verify
code.</p>

<p style="margin-left:6%; margin-top: 1em">The
<i>basicConstraints</i> extension CA flag is used to
determine whether the certificate can be used as a CA. If
the CA flag is true, it is a CA; if the CA flag is false, it
is not a CA. <i>All</i> CAs should have the CA flag set to
true.</p>

<p style="margin-left:6%; margin-top: 1em">If the
<i>basicConstraints</i> extension is absent, then the
certificate is considered to be a &quot;possible CA&quot;;
other extensions are checked according to the intended use
of the certificate. A warning is given in this case because
the certificate should really not be regarded as a CA:
however, it is allowed to be a CA to work around some broken
software.</p>

<p style="margin-left:6%; margin-top: 1em">If the
certificate is a V1 certificate (and thus has no extensions)
and it is self-signed, it is also assumed to be a CA but a
warning is again given: this is to work around the problem
of Verisign roots which are V1 self-signed certificates.</p>

<p style="margin-left:6%; margin-top: 1em">If the
<i>keyUsage</i> extension is present, then additional
restraints are made on the uses of the certificate. A CA
certificate <i>must</i> have the <i>keyCertSign</i> bit set
if the <i>keyUsage</i> extension is present.</p>

<p style="margin-left:6%; margin-top: 1em">The extended key
usage extension places additional restrictions on the
certificate uses. If this extension is present (whether
critical or not), the key can only be used for the purposes
specified.</p>

<p style="margin-left:6%; margin-top: 1em">A complete
description of each test is given below. The comments about
<i>basicConstraints</i> and <i>keyUsage</i> and V1
certificates above apply to <i>all</i> CA certificates.</p>

<p style="margin-top: 1em"><i>SSL Client</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;web client
authentication&quot; OID. <i>keyUsage</i> must be absent or
it must have the <i>digitalSignature</i> bit set. Netscape
certificate type must be absent or it must have the SSL
client bit set.</p>

<p style="margin-top: 1em"><i>SSL Client CA</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;web client
authentication&quot; OID. Netscape certificate type must be
absent or it must have the SSL CA bit set: this is used as a
work around if the <i>basicConstraints</i> extension is
absent.</p>

<p style="margin-top: 1em"><i>SSL Server</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;web server
authentication&quot; and/or one of the SGC OIDs.
<i>keyUsage</i> must be absent or it must have the
<i>digitalSignature</i> set, the <i>keyEncipherment</i> set,
or both bits set. Netscape certificate type must be absent
or have the SSL server bit set.</p>

<p style="margin-top: 1em"><i>SSL Server CA</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;web server
authentication&quot; and/or one of the SGC OIDs. Netscape
certificate type must be absent or the SSL CA bit must be
set: this is used as a work around if the
<i>basicConstraints</i> extension is absent.</p>

<p style="margin-top: 1em"><i>Netscape SSL Server</i></p>

<p style="margin-left:14%;">For Netscape SSL clients to
connect to an SSL server; it must have the
<i>keyEncipherment</i> bit set if the <i>keyUsage</i>
extension is present. This isn&rsquo;t always valid because
some cipher suites use the key for digital signing.
Otherwise it is the same as a normal SSL server.</p>

<p style="margin-top: 1em"><i>Common S/MIME Client
Tests</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;email
protection&quot; OID. Netscape certificate type must be
absent or should have the <i>S/MIME</i> bit set. If the
<i>S/MIME</i> bit is not set in Netscape certificate type,
then the SSL client bit is tolerated as an alternative but a
warning is shown: this is because some Verisign certificates
don&rsquo;t set the <i>S/MIME</i> bit.</p>

<p style="margin-top: 1em"><i>S/MIME Signing</i></p>

<p style="margin-left:14%;">In addition to the common
<i>S/MIME</i> client tests, the <i>digitalSignature</i> bit
must be set if the <i>keyUsage</i> extension is present.</p>

<p style="margin-top: 1em"><i>S/MIME Encryption</i></p>

<p style="margin-left:14%;">In addition to the common
<i>S/MIME</i> tests, the <i>keyEncipherment</i> bit must be
set if the <i>keyUsage</i> extension is present.</p>

<p style="margin-top: 1em"><i>S/MIME CA</i></p>

<p style="margin-left:14%;">The extended key usage
extension must be absent or include the &quot;email
protection&quot; OID. Netscape certificate type must be
absent or must have the <i>S/MIME CA</i> bit set: this is
used as a work around if the <i>basicConstraints</i>
extension is absent.</p>

<p style="margin-top: 1em"><i>CRL Signing</i></p>

<p style="margin-left:14%;">The <i>keyUsage</i> extension
must be absent or it must have the <i>CRL</i> signing bit
set.</p>

<p style="margin-top: 1em"><i>CRL Signing CA</i></p>

<p style="margin-left:14%;">The normal CA tests apply.
Except in this case the <i>basicConstraints</i> extension
must be present.</p>

<p style="margin-top: 1em"><b>X509 BUGS</b></p>

<p style="margin-left:6%;">Extensions in certificates are
not transferred to certificate requests and vice versa.</p>

<p style="margin-left:6%; margin-top: 1em">It is possible
to produce invalid certificates or requests by specifying
the wrong private key or using inconsistent options in some
cases: these should be checked.</p>

<p style="margin-left:6%; margin-top: 1em">There should be
options to explicitly set such things as start and end
dates, rather than an offset from the current time.</p>

<p style="margin-left:6%; margin-top: 1em">The code to
implement the verify behaviour described in the <i>X509
TRUST SETTINGS</i> is currently being developed. It thus
describes the intended behaviour rather than the current
behaviour. It is hoped that it will represent reality in
<b>OpenSSL</b> 0.9.5 and later.</p>

<p style="margin-top: 1em"><b>X509 HISTORY</b></p>

<p style="margin-left:6%;">Before <b>OpenSSL</b> 0.9.8, the
default digest for RSA keys was MD5.</p>

<p style="margin-left:6%; margin-top: 1em">The hash
algorithm used in the <b>-subject_hash</b> and
<b>-issuer_hash</b> options before <b>OpenSSL</b> 1.0.0 was
based on the deprecated MD5 algorithm and the encoding of
the distinguished name. In <b>OpenSSL</b> 1.0.0 and later it
is based on a canonical version of the DN using SHA1. This
means that any directories using the old form must have
their links rebuilt using <i>c_rehash</i> or similar.</p>

<p style="margin-top: 1em"><b>COMMON NOTATION</b></p>

<p style="margin-left:6%;">Several commands share a common
syntax, as detailed below.</p>

<p style="margin-left:6%; margin-top: 1em">Password
arguments, typically specified using <b>-passin</b> and
<b>-passout</b> for input and output passwords, allow
passwords to be obtained from a variety of sources. Both of
these options take a single argument, described below. If no
password argument is given and a password is required, then
the user is prompted to enter one: this will typically be
read from the current terminal with echoing turned off.</p>

<p style="margin-top: 1em"><b>pass</b>:<i>password</i></p>

<p style="margin-left:33%; margin-top: 1em">The actual
password is <i>password</i>. Since the password is visible
to utilities, this form should only be used where security
is not important.</p>

<p style="margin-top: 1em"><b>env</b>:<i>var</i></p>

<p style="margin-left:33%; margin-top: 1em">Obtain the
password from the environment variable <i>var</i>. Since the
environment of other processes is visible, this option
should be used with caution.</p>

<p style="margin-top: 1em"><b>file</b>:<i>path</i></p>

<p style="margin-left:33%; margin-top: 1em">The first line
of <i>path</i> is the password. If the same <i>path</i>
argument is supplied to <b>-passin</b> and <b>-passout</b>,
then the first line will be used for the input password and
the next line for the output password. <i>path</i> need not
refer to a regular file: it could, for example, refer to a
device or named pipe.</p>

<p style="margin-top: 1em"><b>fd</b>:<i>number</i></p>

<p style="margin-left:33%; margin-top: 1em">Read the
password from the file descriptor <i>number</i>. This can be
used to send the data via a pipe, for example.</p>

<p style="margin-top: 1em"><b>stdin</b></p>

<p style="margin-left:33%; margin-top: 1em">Read the
password from standard input.</p>

<p style="margin-left:6%; margin-top: 1em">File formats,
typically specified using <b>-inform</b> and
<b>-outform</b>, indicate the type of file being read from
or the file format to write. The argument is case
insensitive.</p>

<p style="margin-top: 1em"><b>der</b></p>

<p style="margin-left:24%; margin-top: 1em">Distinguished
Encoding Rules (DER) is a binary format.</p>

<p><b>pem</b></p>

<p style="margin-left:24%; margin-top: 1em">Privacy
Enhanced Mail (PEM) is base64-encoded.</p>

<p><b>txt</b></p>

<p style="margin-left:24%; margin-top: 1em">Plain ASCII
text.</p>

<p style="margin-top: 1em"><b>ENVIRONMENT</b></p>

<p style="margin-left:6%;">The following environment
variables affect the execution of <b>openssl</b>:</p>

<p style="margin-top: 1em">OPENSSL_CONF</p>

<p style="margin-left:35%; margin-top: 1em">The location of
the master configuration file.</p>

<p style="margin-top: 1em"><b>FILES</b> <br>
/etc/ssl/</p>

<p style="margin-left:35%; margin-top: 1em">Default config
directory for <b>openssl</b>.</p>

<p>/etc/ssl/lib/</p>

<p style="margin-left:35%; margin-top: 1em">Unused.</p>

<p>/etc/ssl/private/</p>

<p style="margin-left:35%; margin-top: 1em">Default private
key directory.</p>

<p>/etc/ssl/openssl.cnf</p>

<p style="margin-left:35%; margin-top: 1em">Default
configuration file for <b>openssl</b>.</p>

<p>/etc/ssl/x509v3.cnf</p>

<p style="margin-left:35%; margin-top: 1em">Default
configuration file for <b>x509</b> certificates.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">nc(1), ssl(8), starttls(8)</p>

<p style="margin-top: 1em"><b>STANDARDS</b> <i><br>
The SSL Protocol</i></p>

<p style="margin-left:6%;">,</p>

<p>Netscape Communications Corp. , <br>
February 1995 .</p>

<p style="margin-top: 1em"><i>The SSL 3.0 Protocol</i></p>

<p style="margin-left:6%;">,</p>

<p>Netscape Communications Corp. , <br>
November 1996 .</p>

<p style="margin-top: 1em">T. Dierks</p>

<p style="margin-left:6%;">and</p>

<p>C. Allen , <i><br>
The TLS Protocol Version 1.0</i> , <br>
RFC 2246 , <br>
January 1999 .</p>

<p style="margin-top: 1em">M. Wahl</p>

<p style="margin-left:6%;">,</p>

<p>S. Killie , and <br>
T. Howes , <i><br>
Lightweight Directory Access Protocol (v3): UTF-8 String
Representation of Distinguished Names</i> , <br>
RFC 2253 , <br>
December 1997 .</p>

<p style="margin-top: 1em">B. Kaliski</p>

<p style="margin-left:6%;">,</p>

<p><i>PKCS #7: Cryptographic Message Syntax Version 1.5</i>
, <br>
RFC 2315 , <br>
March 1998 .</p>

<p style="margin-top: 1em">R. Housley</p>

<p style="margin-left:6%;">,</p>

<p>W. Ford , <br>
W. Polk , and <br>
D. Solo , <i><br>
Internet X.509 Public Key Infrastructure Certificate and CRL
Profile</i> , <br>
RFC 2459 , <br>
January 1999 .</p>

<p style="margin-top: 1em">M. Myers</p>

<p style="margin-left:6%;">,</p>

<p>R. Ankney , <br>
A. Malpani , <br>
S. Galperin , and <br>
C. Adams , <i><br>
X.509 Internet Public Key Infrastructure Online Certificate
Status Protocol &ndash; OCSP</i> , <br>
RFC 2560 , <br>
June 1999 .</p>

<p style="margin-top: 1em">R. Housley</p>

<p style="margin-left:6%;">,</p>

<p><i>Cryptographic Message Syntax</i> , <br>
RFC 2630 , <br>
June 1999 .</p>

<p style="margin-top: 1em">P. Chown</p>

<p style="margin-left:6%;">,</p>

<p><i>Advanced Encryption Standard (AES) Ciphersuites for
Transport Layer Security (TLS)</i> , <br>
RFC 3268 , <br>
June 2002 .</p>

<p style="margin-top: 1em"><b>HISTORY</b></p>

<p style="margin-left:6%;">The openssl(1) document appeared
in <b>OpenSSL</b> 0.9.2. The <b>list-</b>XXX<b>-commands</b>
pseudo-commands were added in <b>OpenSSL</b> 0.9.3; the
<b>no-</b>XXX pseudo-commands were added in <b>OpenSSL</b>
0.9.5a; the <b>list-</b>XXX<b>-algorithms</b>
pseudo-commands were added in <b>OpenSSL</b> 1.0.0.</p>

<p style="margin-left:6%; margin-top: 1em">BSD
July&nbsp;21, 2016 BSD</p>
<hr>
</body>
</html>
