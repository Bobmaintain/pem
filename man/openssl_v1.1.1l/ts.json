{"_values": ["Creator     : groff version 1.22.4", "CreationDate: Tue Feb  1 14:19:28 2022", "html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\n\"http://www.w3.org/TR/html4/loose.dtd\""], "html": [{"head": [{"meta": [{"_attributes": {"name": "generator", "content": "groff -Thtml, see www.gnu.org"}}, {"_attributes": {"http-equiv": "Content-Type", "content": "text/html; charset=US-ASCII"}}, {"_attributes": {"name": "Content-Style", "content": "text/css"}}], "style": [{"_attributes": {"type": "text/css"}, "_value": "p       { margin-top: 0; margin-bottom: 0; vertical-align: top }\n       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }\n       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }\n       h1      { text-align: center }"}], "title": [{"_value": "TS"}]}], "body": [{"h1": [{"_attributes": {"align": "center"}, "_value": "TS"}], "a": [{"_attributes": {"href": "#NAME"}, "_value": "NAME"}, {"_attributes": {"href": "#SYNOPSIS"}, "_value": "SYNOPSIS"}, {"_attributes": {"href": "#DESCRIPTION"}, "_value": "DESCRIPTION"}, {"_attributes": {"href": "#OPTIONS"}, "_value": "OPTIONS"}, {"_attributes": {"href": "#CONFIGURATION FILE OPTIONS"}, "_value": "CONFIGURATION FILE OPTIONS"}, {"_attributes": {"href": "#EXAMPLES"}, "_value": "EXAMPLES"}, {"_attributes": {"href": "#BUGS"}, "_value": "BUGS"}, {"_attributes": {"href": "#SEE ALSO"}, "_value": "SEE ALSO"}, {"_attributes": {"href": "#COPYRIGHT"}, "_value": "COPYRIGHT"}], "br": [{}, {}, {}, {}, {}, {}, {}, {}, {}], "hr": [{}, {}], "h2": [{"_value": "NAME", "a": [{"_attributes": {"name": "NAME"}}]}, {"_value": "SYNOPSIS", "a": [{"_attributes": {"name": "SYNOPSIS"}}]}, {"_value": "DESCRIPTION", "a": [{"_attributes": {"name": "DESCRIPTION"}}]}, {"_value": "OPTIONS", "a": [{"_attributes": {"name": "OPTIONS"}}]}, {"_value": "CONFIGURATION FILE OPTIONS", "a": [{"_attributes": {"name": "CONFIGURATION FILE OPTIONS"}}]}, {"_value": "EXAMPLES", "a": [{"_attributes": {"name": "EXAMPLES"}}]}, {"_value": "BUGS", "a": [{"_attributes": {"name": "BUGS"}}]}, {"_value": "SEE ALSO", "a": [{"_attributes": {"name": "SEE ALSO"}}]}, {"_value": "COPYRIGHT", "a": [{"_attributes": {"name": "COPYRIGHT"}}]}], "p": [{"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl-ts, ts\n- Time Stamping Authority tool (client/server)"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "openssl ts\n-query"}, {"_value": "-rand file..."}, {"_value": "-writerand file"}, {"_value": "-config"}, {"_value": "-data"}, {"_value": "-digest"}, {"_value": "-"}, {"i": [{"_value": "digest"}]}, {"_value": "-tspolicy"}, {"_value": "-no_nonce"}, {"_value": "-cert"}, {"_value": "-in"}, {"_value": "-out"}, {"_value": "-text"}], "_values": ["[", "] [", "]\n[", "configfile] [", "file_to_hash]\n[", "digest_bytes] [", "]\n[", "object_id] [", "]\n[", "] [", "request.tsq] [", "request.tsq] [", "]"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "openssl ts\n-reply"}, {"_value": "-config"}, {"_value": "-section"}, {"_value": "-queryfile"}, {"_value": "-passin"}, {"_value": "-signer"}, {"_value": "-inkey"}, {"_value": "-"}, {"i": [{"_value": "digest"}]}, {"_value": "-chain"}, {"_value": "-tspolicy"}, {"_value": "-in"}, {"_value": "-token_in"}, {"_value": "-out"}, {"_value": "-token_out"}, {"_value": "-text"}, {"_value": "-engine"}], "_values": ["[", "configfile] [", "tsa_section] [", "request.tsq] [", "password_src] [", "tsa_cert.pem] [", "file_or_id] [", "] [", "certs_file.pem] [", "object_id] [", "response.tsr] [", "] [", "response.tsr]\n[", "] [", "] [", "id]"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "openssl ts\n-verify"}, {"_value": "-data"}, {"_value": "-digest"}, {"_value": "-queryfile"}, {"_value": "-in"}, {"_value": "-token_in"}, {"_value": "-CApath"}, {"_value": "-CAfile"}, {"_value": "-untrusted"}], "_values": ["[", "file_to_hash] [", "digest_bytes] [", "request.tsq] [", "response.tsr] [", "] [", "trusted_cert_path] [", "trusted_certs.pem]\n[", "cert_file.pem] [", "]"], "i": [{"_value": "verify\noptions"}]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "i": [{"_value": "verify\noptions:"}], "_value": "[-attime timestamp] [-check_ss_sig]\n[-crl_check] [-crl_check_all] [-explicit_policy]\n[-extended_crl] [-ignore_critical] [-inhibit_any]\n[-inhibit_map] [-issuer_checks] [-no_alt_chains]\n[-no_check_time] [-partial_chain] [-policy arg]\n[-policy_check] [-policy_print] [-purpose purpose]\n[-suiteB_128] [-suiteB_128_only] [-suiteB_192]\n[-trusted_first] [-use_deltas] [-auth_level num]\n[-verify_depth num] [-verify_email email] [-verify_hostname\nhostname] [-verify_ip ip] [-verify_name name]\n[-x509_strict]"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "ts"}], "_values": ["The", "command is a basic Time Stamping Authority (", ") client and server application as\nspecified in", "(Time-Stamp Protocol,", "). A", "can be part of a", "deployment and its role is to provide\nlong term proof of the existence of a certain datum before a\nparticular time. Here is a brief description of the\nprotocol:"], "small": [{"_value": "TSA"}, {"_value": "RFC 3161"}, {"_value": "TSP"}, {"_value": "TSA"}, {"_value": "PKI"}]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "small": [{"_value": "DER"}, {"_value": "TSA"}], "_values": ["There is one", "encoded protocol data unit defined for\ntransporting a timestamp request to the", "and one for sending the timestamp response back to the\nclient. The", "command has three main functions:\ncreating a timestamp request based on a data file, creating\na timestamp response based on a request, verifying if a\nresponse corresponds to a particular request or a data\nfile."], "b": [{"_value": "ts"}]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "small": [{"_value": "HTTP"}, {"_value": "TCP"}, {"_value": "RFC 3161."}], "_values": ["There is no\nsupport for sending the requests/responses automatically\nover", "or", "yet as\nsuggested in", "The users must send\nthe requests either by ftp or e-mail."]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nRequest generation"}, {"_value": "-query"}, {"br": [{}], "_value": "-rand file..."}], "br": [{}], "_values": ["The", "switch can be used for creating and\nprinting a timestamp request with the following options:"]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": ";"}, {"_value": ","}, {"_value": ":"}], "_values": ["A file or files containing\nrandom data used to seed the random number generator.\nMultiple files can be specified separated by an OS-dependent\ncharacter. The separator is", "for MS-Windows,", "for OpenVMS, and", "for all others."]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-writerand file"}], "_values": ["[", "]"]}, {"_attributes": {"style": "margin-left:17%;"}, "i": [{"_value": "file"}], "_values": ["Writes random data to the\nspecified", "upon exit. This can be used with a\nsubsequent", "flag."], "b": [{"_value": "-rand"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-config"}], "_value": "configfile"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "COMMAND SUMMARY\""}], "_values": ["The configuration file to use.\nOptional; for a description of the default value, see \"", "in", "(1)."], "b": [{"_value": "openssl"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-data"}], "_value": "file_to_hash"}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-data"}, {"_value": "-digest"}], "_values": ["The data file for which the\ntimestamp request needs to be created. stdin is the default\nif neither the", "nor the", "parameter\nis specified. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-digest"}], "_value": "digest_bytes"}, {"_attributes": {"style": "margin-left:17%;"}, "_value": "It is possible to specify the\nmessage imprint explicitly without the data file. The\nimprint must be specified in a hexadecimal format, two\ncharacters per byte, the bytes optionally separated by\ncolons (e.g. 1A:F6:01:... or 1AF601...). The number of bytes\nmust match the message digest algorithm in use.\n(Optional)"}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-"}, {"i": [{"_value": "digest"}]}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "dgst"}], "_values": ["The message digest to apply to\nthe data file. Any digest supported by the OpenSSL", "command can be used. The default is", "(Optional)"], "small": [{"_value": "SHA-1."}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-tspolicy"}], "_value": "object_id"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "OID"}, {"_value": "OID"}, {"_value": "TSA"}], "_values": ["The policy that the client\nexpects the", "to use for creating the\ntimestamp token. Either the dotted", "notation or", "names defined in the config\nfile can be used. If no policy is requested the", "will use its own default policy.\n(Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-no_nonce"}]}, {"_attributes": {"style": "margin-left:17%;"}, "_value": "No nonce is specified in the\nrequest if this option is given. Otherwise a 64 bit long\npseudo-random none is included in the request. It is\nrecommended to use nonce to protect against replay-attacks.\n(Optional)"}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-cert"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["The", "is\nexpected to include its signing certificate in the response.\n(Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-in"}], "_value": "request.tsq"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER"}], "_values": ["This option specifies a\npreviously created timestamp request in", "format that will be printed into the output file. Useful\nwhen you need to examine the content of a request in\nhuman-readable format. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-out"}], "_value": "request.tsq"}, {"_attributes": {"style": "margin-left:17%;"}, "_value": "Name of the output file to\nwhich the request will be written. Default is stdout.\n(Optional)"}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-text"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER."}], "_values": ["If this option is specified the\noutput is human-readable text format instead of", "(Optional)"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nResponse generation"}, {"_value": "-reply"}, {"_value": "-token_out"}, {"br": [{}], "_value": "-config"}], "br": [{}], "_values": ["A timestamp response (TimeStampResp) consists of a response\nstatus and the timestamp token itself (ContentInfo), if the\ntoken generation was successful. The", "command\nis for creating a timestamp response or timestamp token\nbased on a request and printing the response/token in\nhuman-readable format. If", "is not specified\nthe output is always a timestamp response (TimeStampResp),\notherwise it is a timestamp token (ContentInfo).", "configfile"]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "COMMAND SUMMARY\""}], "_values": ["The configuration file to use.\nOptional; for a description of the default value, see \"", "in", "(1).\nSee", "for\nconfigurable variables."], "b": [{"_value": "openssl"}, {"small": [{"_value": "CONFIGURATION FILE OPTIONS"}]}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-section"}], "_value": "tsa_section"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["The name of the config file\nsection containing the settings for the response generation.\nIf not specified the default", "section is\nused, see", "for details. (Optional)"], "b": [{"small": [{"_value": "CONFIGURATION FILE OPTIONS"}]}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-queryfile"}], "_value": "request.tsq"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER"}], "_values": ["The name of the file containing\na", "encoded timestamp request.\n(Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-passin"}], "_value": "password_src"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA."}], "_values": ["Specifies the password source\nfor the private key of the", "See\n\"Pass Phrase Options\" in", "(1).\n(Optional)"], "b": [{"_value": "openssl"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-signer"}], "_value": "tsa_cert.pem"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "PEM"}, {"_value": "TSA"}], "_values": ["The signer certificate of the", "in", "format. The", "signing certificate must have exactly one\nextended key usage assigned to it: timeStamping. The\nextended key usage must also be critical, otherwise the\ncertificate is going to be refused. Overrides the", "variable of the config file.\n(Optional)"], "b": [{"_value": "signer_cert"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-inkey"}], "_value": "file_or_id"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "PEM"}], "_values": ["The signer private key of the", "in", "format. Overrides\nthe", "config file option. (Optional) If no\nengine is used, the argument is taken as a file; if an\nengine is specified, the argument is given to the engine as\na key identifier."], "b": [{"_value": "signer_key"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-"}, {"i": [{"_value": "digest"}]}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "signer_digest"}], "_values": ["Signing digest to use.\nOverrides the", "config file option.\n(Mandatory unless specified in the config file)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-chain"}], "_value": "certs_file.pem"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "PEM"}], "_values": ["The collection of certificates\nin", "format that will all be included in\nthe response in addition to the signer certificate if the", "option was used for the request. This file is\nsupposed to contain the certificate chain for the signer\ncertificate from its issuer upwards. The", "command does not build a certificate chain automatically.\n(Optional)"], "b": [{"_value": "-cert"}, {"_value": "-reply"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-tspolicy"}], "_value": "object_id"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "OID"}], "_values": ["The default policy to use for\nthe response unless the client explicitly requires a\nparticular", "policy. The", "can be specified either in dotted notation or with its name.\nOverrides the", "config file option.\n(Optional)"], "b": [{"_value": "default_policy"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-in"}], "_value": "response.tsr"}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-token_in"}], "_values": ["Specifies a previously created\ntimestamp response or timestamp token (if", "is also specified) in", "format that will be\nwritten to the output file. This option does not require a\nrequest, it is useful e.g. when you need to examine the\ncontent of a response or token or you want to extract the\ntimestamp token from a response. If the input is a token and\nthe output is a timestamp response a default\n\u2019granted\u2019 status info is added to the token.\n(Optional)"], "small": [{"_value": "DER"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-token_in"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-in"}], "_values": ["This flag can be used together\nwith the", "option and indicates that the input is a", "encoded timestamp token (ContentInfo)\ninstead of a timestamp response (TimeStampResp).\n(Optional)"], "small": [{"_value": "DER"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-out"}], "_value": "response.tsr"}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-text"}, {"_value": "-token_out"}], "_values": ["The response is written to this\nfile. The format and content of the file depends on other\noptions (see", ",", "). The default\nis stdout. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-token_out"}]}, {"_attributes": {"style": "margin-left:17%;"}, "_value": "The output is a timestamp token\n(ContentInfo) instead of timestamp response (TimeStampResp).\n(Optional)"}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-text"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER."}], "_values": ["If this option is specified the\noutput is human-readable text format instead of", "(Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-engine"}], "_value": "id"}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "id"}, {"_value": "ts"}], "_values": ["Specifying an engine (by its\nunique", "string) will cause", "to attempt to\nobtain a functional reference to the specified engine, thus\ninitialising it if needed. The engine will then be set as\nthe default for all available algorithms. Default is\nbuiltin. (Optional)"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nResponse verification"}, {"_value": "-verify"}, {"_value": "-verify"}, {"br": [{}], "_value": "-data"}], "br": [{}], "_values": ["The", "command is for verifying if a timestamp\nresponse or timestamp token is valid and matches a\nparticular timestamp request or data file. The", "command does not use the configuration file.", "file_to_hash"]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-digest"}, {"_value": "-queryfile"}], "_values": ["The response or token must be\nverified against file_to_hash. The file is hashed with the\nmessage digest algorithm specified in the token. The", "and", "options must not be\nspecified with this one. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-digest"}], "_value": "digest_bytes"}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-data"}, {"_value": "-queryfile"}], "_values": ["The response or token must be\nverified against the message digest specified with this\noption. The number of bytes must match the message digest\nalgorithm specified in the token. The", "and", "options must not be specified with this\none. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-queryfile"}], "_value": "request.tsq"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER"}], "_values": ["The original timestamp request\nin", "format. The", "and", "options must not be specified with this one.\n(Optional)"], "b": [{"_value": "-data"}, {"_value": "-digest"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-in"}], "_value": "response.tsr"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "DER"}], "_values": ["The timestamp response that\nneeds to be verified in", "format.\n(Mandatory)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-token_in"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-in"}], "_values": ["This flag can be used together\nwith the", "option and indicates that the input is a", "encoded timestamp token (ContentInfo)\ninstead of a timestamp response (TimeStampResp).\n(Optional)"], "small": [{"_value": "DER"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-CApath"}], "_value": "trusted_cert_path"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "CA"}], "_values": ["The name of the directory\ncontaining the trusted", "certificates of the\nclient. See the similar option of", "(1) for\nadditional details. Either this option or", "must be specified. (Optional)"], "b": [{"_value": "verify"}, {"_value": "-CAfile"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-CAfile"}], "_value": "trusted_certs.pem"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "CA"}, {"_value": "PEM"}], "_values": ["The name of the file containing\na set of trusted self-signed", "certificates\nin", "format. See the similar option of", "(1) for additional details. Either this option\nor", "must be specified. (Optional)"], "b": [{"_value": "verify"}, {"_value": "-CApath"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "-untrusted"}], "_value": "cert_file.pem"}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "PEM"}, {"_value": "TSA"}, {"_value": "TSA"}, {"_value": "CA"}], "_values": ["Set of additional untrusted\ncertificates in", "format which may be\nneeded when building the certificate chain for the", "\u2019s signing certificate. This file\nmust contain the", "signing certificate and\nall intermediate", "certificates unless the\nresponse includes them. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "i": [{"_value": "verify options"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-attime\ntimestamp"}, {"_value": "-check_ss_sig"}, {"_value": "-crl_check"}, {"_value": "-crl_check_all"}, {"_value": "-explicit_policy"}, {"_value": "-extended_crl"}, {"_value": "-ignore_critical"}, {"_value": "-inhibit_any"}, {"_value": "-inhibit_map"}, {"_value": "-issuer_checks"}, {"_value": "-no_alt_chains"}, {"_value": "-no_check_time"}, {"_value": "-partial_chain"}, {"_value": "-policy"}, {"_value": "-policy_check"}, {"_value": "-policy_print"}, {"_value": "-purpose"}, {"_value": "-suiteB_128"}, {"_value": "-suiteB_128_only"}, {"_value": "-suiteB_192"}, {"_value": "-trusted_first"}, {"_value": "-use_deltas"}, {"_value": "-auth_level"}, {"_value": "-verify_depth"}, {"_value": "-verify_email"}, {"_value": "-verify_hostname"}, {"_value": "-verify_ip"}, {"_value": "-verify_name"}, {"_value": "-x509_strict"}, {"_value": "verify"}], "_values": ["The options", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ", and", "can be used to control timestamp\nverification. See", "(1)."]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "-query"}, {"_value": "-reply"}, {"_value": "config"}, {"_value": "-query"}, {"_value": "-reply"}], "_values": ["The", "and", "commands make use of a\nconfiguration file. See", "(5) for a general\ndescription of the syntax of the config file. The", "command uses only the symbolic", "names section and it can work without it.\nHowever, the", "command needs the config file for\nits operation."], "small": [{"_value": "OID"}]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"br": [{}], "_value": "tsa"}, {"_value": "default_tsa"}], "_values": ["When there is a\ncommand line switch equivalent of a variable the switch\nalways overrides the settings in the config file.", "section,"]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-reply"}, {"_value": "-section"}], "_values": ["This is the main section and it\nspecifies the name of another section that contains all the\noptions for the", "command. This default section\ncan be overridden with the", "command line\nswitch. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "oid_file"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "ca"}], "_values": ["See", "(1) for\ndescription. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "oid_section"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "ca"}], "_values": ["See", "(1) for\ndescription. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"small": [{"_value": "RANDFILE"}]}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "ca"}], "_values": ["See", "(1) for\ndescription. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "serial"}]}, {"_attributes": {"style": "margin-left:17%;"}, "_value": "The name of the file containing\nthe hexadecimal serial number of the last timestamp response\ncreated. This number is incremented by 1 for each response.\nIf the file does not exist at the time of response\ngeneration a new file is created with serial number 1.\n(Mandatory)"}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "crypto_device"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "HSM"}], "_values": ["Specifies the OpenSSL engine\nthat will be set as the default for all available\nalgorithms. The default value is builtin, you can specify\nany other engines supported by OpenSSL (e.g. use chil for\nthe NCipher", "). (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "signer_cert"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "PEM"}], "_values": ["signing\ncertificate in", "format. The same as the", "command line option. (Optional)"], "b": [{"_value": "-signer"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "certs"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "PEM"}], "_values": ["A file containing a set of", "encoded certificates that need to be\nincluded in the response. The same as the", "command line option. (Optional)"], "b": [{"_value": "-chain"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "signer_key"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "PEM"}], "_values": ["The private key of the", "in", "format. The same as\nthe", "command line option. (Optional)"], "b": [{"_value": "-inkey"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "signer_digest"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-"}, {"i": [{"_value": "digest"}]}], "_values": ["Signing digest to use. The same\nas the", "command line option.\n(Mandatory unless specified on the command line)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "default_policy"}]}, {"_attributes": {"style": "margin-left:17%;"}, "b": [{"_value": "-tspolicy"}], "_values": ["The default policy to use when\nthe request does not mandate any policy. The same as the", "command line option. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "other_policies"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["Comma separated list of\npolicies that are also acceptable by the", "and used only if the request explicitly specifies one of\nthem. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "digests"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["The list of message digest\nalgorithms that the", "accepts. At least one\nalgorithm must be specified. (Mandatory)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "accuracy"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["The accuracy of the time source\nof the", "in seconds, milliseconds and\nmicroseconds. E.g. secs:1, millisecs:500, microsecs:100. If\nany of the components is missing zero is assumed for that\nfield. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "clock_precision_digits"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "UNIX"}], "_values": ["Specifies the maximum number of\ndigits, which represent the fraction of seconds, that need\nto be included in the time field. The trailing zeros must be\nremoved from the time, so there might actually be fewer\ndigits, or no fraction of seconds at all. Supported only on", "platforms. The maximum value is 6,\ndefault is 0. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "ordering"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["If this option is yes the\nresponses generated by this", "can always be\nordered, even if the time difference between two responses\nis less than the sum of their accuracies. Default is no.\n(Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "tsa_name"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "TSA"}], "_values": ["Set this option to yes if the\nsubject name of the", "must be included in\nthe", "name field of the response. Default\nis no. (Optional)"]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "ess_cert_id_chain"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}, {"_value": "RFC 2634,"}], "_values": ["The SignedData objects created\nby the", "always contain the certificate\nidentifier of the signing certificate in a signed attribute\n(see", "Enhanced Security Services).\nIf this option is set to yes and either the", "variable or the", "option is specified then the\ncertificate identifiers of the chain will also be included\nin the SigningCertificate signed attribute. If this variable\nis set to no, only the signing certificate identifier is\nincluded. Default is no. (Optional)"], "b": [{"_value": "certs"}, {"_value": "-chain"}]}, {"_attributes": {"style": "margin-left:11%;"}, "b": [{"_value": "ess_cert_id_alg"}]}, {"_attributes": {"style": "margin-left:17%;"}, "small": [{"_value": "TSA"}], "_values": ["This option specifies the hash\nfunction to be used to calculate the", "\u2019s public key certificate identifier. Default is sha1.\n(Optional)"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"small": [{"_value": "OPENSSL_CONF"}]}], "_values": ["All the\nexamples below presume that", "is set to a proper\nconfiguration file, e.g. the example configuration file\nopenssl/apps/openssl.cnf will do."]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nRequest"}], "br": [{}], "small": [{"_value": "SHA-1"}], "_values": ["To create a timestamp request for design1.txt with", "without nonce and policy and no\ncertificate is required in the response:"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-query -data design1.txt -no_nonce \\", "-out design1.tsq"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To create a\nsimilar timestamp request with specifying the message\nimprint explicitly:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-query -digest b7e5d3f93198b38379852f2c04e78d73abdd0f4b \\", "-no_nonce -out design1.tsq"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To print the\ncontent of the previous request in human readable\nformat:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-query -in design1.tsq -text"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "small": [{"_value": "MD-5"}, {"_value": "OID"}], "_values": ["To create a\ntimestamp request which includes the", "digest of design2.txt, requests the signer certificate and\nnonce, specifies a policy id (assuming the tsa_policy1 name\nis defined in the", "section of the config\nfile):"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-query -data design2.txt -md5 \\", "-tspolicy tsa_policy1 -cert -out design2.tsq"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nResponse"}, {"_value": "timeStamping"}], "br": [{}], "small": [{"_value": "TSA"}], "_values": ["Before generating a response a signing certificate must be\ncreated for the", "that contains the", "critical extended key usage extension\nwithout any other key usage extensions. You can add this\nline to the user certificate section of the config file to\ngenerate a proper certificate;"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "extendedKeyUsage\n= critical,timeStamping"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "req"}, {"_value": "ca"}, {"_value": "x509"}], "_values": ["See", "(1),", "(1), and", "(1) for\ninstructions. The examples below assume that cacert.pem\ncontains the certificate of the", "tsacert.pem is the signing certificate issued by cacert.pem\nand tsakey.pem is the private key of the"], "small": [{"_value": "CA,"}, {"_value": "TSA."}]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To create a\ntimestamp response for a request:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-reply -queryfile design1.tsq -inkey tsakey.pem \\", "-signer tsacert.pem -out design1.tsr"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "If you want to\nuse the settings in the config file you could just\nwrite:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -queryfile design1.tsq -out design1.tsr"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To print a\ntimestamp reply to stdout in human readable format:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -in design1.tsr -text"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To create a\ntimestamp token instead of timestamp response:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -queryfile design1.tsq -out design1_token.der\n-token_out"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To print a\ntimestamp token to stdout in human readable format:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -in design1_token.der -token_in -text -token_out"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To extract the\ntimestamp token from a response:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -in design1.tsr -out design1_token.der -token_out"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To add\n\u2019granted\u2019 status info to a timestamp token\nthereby creating a valid response:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "openssl ts\n-reply -in design1_token.der -token_in -out design1.tsr"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "Time Stamp\nVerification"}], "br": [{}], "_value": "To verify a timestamp reply against a request:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-verify -queryfile design1.tsq -in design1.tsr \\", "-CAfile cacert.pem -untrusted tsacert.pem"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "To verify a\ntimestamp reply that includes the certificate chain:"}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}], "_values": ["openssl ts\n-verify -queryfile design2.tsq -in design2.tsr \\", "-CAfile cacert.pem"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}, {}], "_values": ["To verify a\ntimestamp token against the original data file:", "openssl ts -verify -data design2.txt -in design2.tsr \\", "-CAfile cacert.pem"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "br": [{}, {}], "_values": ["To verify a\ntimestamp token against a message imprint:", "openssl ts -verify -digest\nb7e5d3f93198b38379852f2c04e78d73abdd0f4b \\", "-in design2.tsr -CAfile cacert.pem"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "You could also\nlook at the \u2019test\u2019 directory for more\nexamples."}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "b": [{"_value": "tsget"}, {"_value": "openssl"}, {"_value": "req"}, {"_value": "x509"}, {"_value": "ca"}, {"_value": "genrsa"}, {"_value": "config"}], "_values": ["(1),", "(1),", "(1),", "(1),", "(1),", "(1),", "(5)"]}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "_value": "Copyright\n2006-2021 The OpenSSL Project Authors. All Rights\nReserved."}, {"_attributes": {"style": "margin-left:11%; margin-top: 1em"}, "small": [{"_value": "LICENSE"}], "_values": ["Licensed under\nthe OpenSSL license (the \"License\"). You may not\nuse this file except in compliance with the License. You can\nobtain a copy in the file", "in the\nsource distribution or at\n<https://www.openssl.org/source/license.html>."]}], "table": [{"_attributes": {"width": "100%", "border": "0", "rules": "none", "frame": "void", "cellspacing": "0", "cellpadding": "0"}, "tr": [{"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "3%"}, "p": [{"_value": "1."}]}, {"_attributes": {"width": "3%"}}, {"_attributes": {"width": "83%"}, "p": [{"small": [{"_value": "TSA"}, {"_value": "TSA."}], "_values": ["The", "client computes a one-way hash\nvalue for a data file and sends the hash to the"]}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "3%"}, "p": [{"_value": "2."}]}, {"_attributes": {"width": "3%"}}, {"_attributes": {"width": "83%"}, "p": [{"small": [{"_value": "TSA"}, {"_value": "TSA"}], "_values": ["The", "attaches the current date and\ntime to the received hash value, signs them and sends the\ntimestamp token back to the client. By creating this token\nthe", "certifies the existence of the\noriginal data file at the time of response generation."]}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "3%"}, "p": [{"_value": "3."}]}, {"_attributes": {"width": "3%"}}, {"_attributes": {"width": "83%"}, "p": [{"small": [{"_value": "TSA"}, {"_value": "TSA."}], "_values": ["The", "client receives the timestamp\ntoken and verifies the signature on it. It also checks if\nthe token contains the same hash value that it had sent to\nthe"]}]}]}]}, {"_attributes": {"width": "100%", "border": "0", "rules": "none", "frame": "void", "cellspacing": "0", "cellpadding": "0"}, "tr": [{"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "1%"}, "p": [{"_attributes": {"style": "margin-top: 1em"}, "_value": "\u2022"}]}, {"_attributes": {"width": "2%"}}, {"_attributes": {"width": "86%"}, "p": [{"_attributes": {"style": "margin-top: 1em"}, "small": [{"_value": "SMTP,"}, {"_value": "TSA"}, {"_value": "HTTP"}, {"_value": "HTTP"}, {"_value": "TCP/IP"}], "_values": ["No support for timestamps over", "though it is quite easy to implement an\nautomatic e-mail based", "with", "(1) and", "(1).", "server support is provided in the form of a separate apache\nmodule.", "client support is provided by", "(1). Pure", "protocol is not\nsupported."], "b": [{"_value": "procmail"}, {"_value": "perl"}, {"_value": "tsget"}]}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "1%"}, "p": [{"_value": "\u2022"}]}, {"_attributes": {"width": "2%"}}, {"_attributes": {"width": "86%"}, "p": [{"small": [{"_value": "TSA"}], "_values": ["The file containing the last serial number of the", "is not locked when being read or written.\nThis is a problem if more than one instance of", "(1) is trying to create a timestamp response\nat the same time. This is not an issue when using the apache\nserver module, it does proper locking."], "b": [{"_value": "openssl"}]}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "1%"}, "p": [{"_value": "\u2022"}]}, {"_attributes": {"width": "2%"}}, {"_attributes": {"width": "86%"}, "p": [{"small": [{"_value": "FIXME"}], "_values": ["Look for the", "word in the source\nfiles."]}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "1%"}, "p": [{"_value": "\u2022"}]}, {"_attributes": {"width": "2%"}}, {"_attributes": {"width": "86%"}, "p": [{"_value": "The source code should really be reviewed by somebody\nelse, too."}]}]}, {"_attributes": {"valign": "top", "align": "left"}, "td": [{"_attributes": {"width": "11%"}}, {"_attributes": {"width": "1%"}, "p": [{"_value": "\u2022"}]}, {"_attributes": {"width": "2%"}}, {"_attributes": {"width": "86%"}, "p": [{"_value": "More testing is needed, I have done only some basic\ntests (see test/testtsa)."}]}]}]}]}]}]}